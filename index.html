<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NETFORM R&D - ÏßÅÏõê Ï†ïÎ≥¥ ÏãúÏä§ÌÖú</title>
<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root {
    --bg-body: #f4f5f7;
    --bg-surface: #ffffff;
    --bg-elevated: #f0f1f4;
    --bg-hover: #ecedf0;
    --bg-input: #ffffff;
    --border: #dddfe3;
    --border-active: #4a5568;
    --accent: #4a5568;
    --accent-dim: rgba(74,85,104,0.07);
    --green: #2d8a56;
    --green-dim: rgba(45,138,86,0.08);
    --amber: #a16b1a;
    --amber-dim: rgba(161,107,26,0.08);
    --red: #c53030;
    --red-dim: rgba(205,49,49,0.06);
    --text: #1a202c;
    --text-sub: #718096;
    --text-dim: #a0aec0;
    --radius: 5px;
    --radius-lg: 8px;
    --sidebar-bg: #2d3748;
    --sidebar-text: #e2e8f0;
    --sidebar-dim: #718096;
    --sidebar-hover: rgba(255,255,255,.08);
    --sidebar-active: rgba(255,255,255,.14);
}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Pretendard Variable',Pretendard,-apple-system,'Segoe UI','Malgun Gothic',sans-serif;background:var(--bg-body);color:var(--text);line-height:1.55;font-size:17px;-webkit-font-smoothing:antialiased;}
a{color:var(--accent);text-decoration:none;}
::-webkit-scrollbar{width:5px;height:5px;}
::-webkit-scrollbar-track{background:var(--bg-body);}
::-webkit-scrollbar-thumb{background:#c1c8d4;border-radius:3px;}

/* === SIDEBAR === */
.layout{display:flex;min-height:100vh;}
.sidebar{width:220px;background:var(--sidebar-bg);border-right:none;padding:14px 10px;flex-shrink:0;display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;overflow-y:auto;z-index:100;}
.sb-logo{padding:4px 8px;margin-bottom:16px;display:flex;align-items:center;gap:9px;}
.sb-logo-icon{width:30px;height:30px;border-radius:6px;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:800;color:#fff;flex-shrink:0;}
.sb-logo-text{font-size:13px;font-weight:700;color:var(--sidebar-text);}
.sb-logo-sub{font-size:9px;color:var(--sidebar-dim);font-weight:400;}
.sb-section{margin-bottom:14px;}
.sb-section-title{font-size:9px;font-weight:600;color:var(--sidebar-dim);text-transform:uppercase;letter-spacing:.8px;padding:0 8px;margin-bottom:4px;}
.sb-item{display:flex;align-items:center;gap:7px;padding:6px 8px;border-radius:var(--radius);cursor:pointer;font-size:12px;color:var(--sidebar-dim);transition:.12s;font-weight:500;border:none;background:none;width:100%;text-align:left;font-family:inherit;}
.sb-item:hover{background:var(--sidebar-hover);color:var(--sidebar-text);}
.sb-item.on{background:var(--sidebar-active);color:#fff;font-weight:600;}
.sb-item .icon{width:16px;text-align:center;font-size:13px;flex-shrink:0;}
.sb-export{margin-top:auto;padding:8px 10px;}
.sb-export .btn{width:100%;justify-content:center;background:rgba(255,255,255,.06);border-color:rgba(255,255,255,.12);color:var(--sidebar-text);}
.sb-export .btn:hover{background:rgba(255,255,255,.12);border-color:rgba(255,255,255,.18);color:#fff;}
.sb-footer{padding:8px;font-size:9px;color:var(--sidebar-dim);}

/* === HEADER (thin top bar) === */
.hd{background:var(--bg-surface);border-bottom:1px solid var(--border);padding:0 28px;height:44px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:50;}
.hd-logo{font-size:12px;color:var(--text-sub);display:flex;align-items:center;gap:6px;}
.hd-logo b{color:var(--text);font-size:12px;font-weight:600;}

/* === NAV (hidden - replaced by sidebar) === */
.nav{display:none;}
.nav-btn{display:none;}

/* === MAIN === */
.main-area{margin-left:220px;min-height:100vh;background:var(--bg-body);}
.wrap{max-width:100%;margin:0 auto;padding:16px 20px;}
.panel{display:none;}.panel.on{display:block;}

/* === BUTTONS === */
.btn{display:inline-flex;align-items:center;gap:4px;padding:5px 10px;border-radius:var(--radius);font-size:11px;font-weight:500;border:1px solid var(--border);background:var(--bg-surface);color:var(--text);cursor:pointer;transition:.15s;white-space:nowrap;box-shadow:0 1px 2px rgba(0,0,0,.04);}
.btn:hover{background:var(--bg-hover);border-color:#bbb;}
.btn-p{background:var(--accent);border-color:var(--accent);color:#fff;}.btn-p:hover{background:#4a5568;}
.btn-d{border-color:var(--red);color:var(--red);background:transparent;}.btn-d:hover{background:var(--red-dim);}

/* === STATS (inline) === */
.stats{display:flex;gap:16px;margin-bottom:12px;padding-bottom:10px;border-bottom:1px solid var(--border);}
.st{display:flex;align-items:center;gap:6px;padding:0;background:none;border:none;border-radius:0;min-width:0;flex:none;max-width:none;}
.st-n{font-size:18px;font-weight:800;color:var(--text);letter-spacing:-.3px;}
.st-l{font-size:10px;color:var(--text-sub);font-weight:500;}
.st-icon{display:none;}

/* === ACCORDION ÏßÅÏõêÎ™©Î°ù === */
.acc-wrap{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.04);}
.acc-div{border-bottom:1px solid var(--border);}
.acc-div:last-child{border-bottom:none;}
.acc-div-hd{display:flex;align-items:center;justify-content:space-between;padding:8px 14px;cursor:pointer;background:var(--bg-elevated);transition:.15s;user-select:none;}
.acc-div-hd:hover{background:#e4e6ea;}
.acc-div-hd .acc-title{font-size:13px;font-weight:700;color:var(--text);display:flex;align-items:center;gap:6px;}
.acc-div-hd .acc-badge{font-size:10px;font-weight:600;padding:1px 7px;border-radius:10px;background:var(--accent-dim);color:var(--accent);}
.acc-div-hd .acc-arrow{width:16px;height:16px;color:var(--text-dim);transition:transform .2s;flex-shrink:0;}
.acc-div-hd.open .acc-arrow{transform:rotate(180deg);}
.acc-tm{border-top:1px solid var(--border);}
.acc-tm-hd{display:flex;align-items:center;justify-content:space-between;padding:6px 14px 6px 26px;cursor:pointer;transition:.12s;user-select:none;}
.acc-tm-hd:hover{background:var(--bg-hover);}
.acc-tm-hd .acc-tm-title{font-size:12px;font-weight:600;color:var(--text);display:flex;align-items:center;gap:5px;}
.acc-tm-hd .acc-tm-badge{font-size:9px;padding:1px 5px;border-radius:8px;background:rgba(0,0,0,.05);color:var(--text-sub);}
.acc-tm-hd .acc-arrow{width:15px;height:15px;color:var(--text-dim);transition:transform .2s;flex-shrink:0;}
.acc-tm-hd.open .acc-arrow{transform:rotate(180deg);}
.acc-tm-body{display:none;}.acc-tm-body.open{display:block;}
.acc-div-body{display:none;}.acc-div-body.open{display:block;}
.acc-mem{display:flex;align-items:center;gap:8px;padding:5px 14px 5px 40px;border-top:1px solid rgba(0,0,0,.03);transition:.1s;cursor:pointer;}
.acc-mem:hover{background:var(--bg-hover);}
.acc-mem .av{width:26px;height:26px;font-size:10px;}
.acc-mem-info{flex:1;display:flex;align-items:center;gap:6px;min-width:0;}
.acc-mem-nm{font-size:13px;font-weight:600;color:var(--text);white-space:nowrap;}
.acc-mem-pos{font-size:10px;padding:1px 6px;border-radius:3px;white-space:nowrap;}
.acc-mem-task{font-size:11px;color:var(--text-sub);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:220px;}

/* admin ÏßÅÏõêÎ™©Î°ù ÌÖåÏù¥Î∏î */
.adm-emp-list{margin-top:10px;max-height:400px;overflow-y:auto;border:1px solid var(--border);border-radius:var(--radius);}
.adm-emp-item{display:flex;align-items:center;gap:10px;padding:8px 14px;border-bottom:1px solid var(--border);transition:.1s;cursor:pointer;font-size:13px;}
.adm-emp-item:hover{background:var(--accent-dim);}
.adm-emp-item:last-child{border-bottom:none;}
.adm-emp-nm{font-weight:600;min-width:60px;}
.adm-emp-tm{color:var(--text-sub);min-width:100px;}
.adm-emp-pos{color:var(--text-sub);}
.adm-emp-search{width:100%;padding:8px 12px;border:1px solid var(--border);border-radius:var(--radius);font-size:13px;outline:none;margin-bottom:8px;}
.adm-emp-search:focus{border-color:var(--accent);}

/* === SEARCH BAR (ÌÜµÌï©) === */
.sbar{display:flex;align-items:center;gap:6px;margin-bottom:10px;flex-wrap:wrap;}
.sbox{flex:1;min-width:220px;position:relative;}
.sbox svg{position:absolute;left:10px;top:50%;transform:translateY(-50%);color:var(--text-dim);width:15px;height:15px;}
.sbox input{width:100%;padding:6px 10px 6px 32px;background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);color:var(--text);font-size:12px;outline:none;transition:.15s;font-family:inherit;}
.sbox input::placeholder{color:var(--text-dim);}
.sbox input:focus{border-color:var(--accent);box-shadow:0 0 0 2px rgba(74,85,104,.07);}

/* filter dropdowns */
.fdd{position:relative;}
.fdd-btn{display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);color:var(--text-sub);font-size:12px;font-weight:500;cursor:pointer;min-width:100px;justify-content:space-between;transition:.12s;font-family:inherit;}
.fdd-btn:hover{border-color:#999;color:var(--text);}
.fdd-btn.open{border-color:var(--accent);background:var(--accent-dim);color:var(--accent);}
.fdd-btn.filtered{border-color:var(--accent);background:var(--accent-dim);color:var(--accent);}
.fdd-btn svg{width:13px;height:13px;color:var(--text-dim);transition:transform .15s;}
.fdd-btn.open svg{transform:rotate(180deg);}
.fdd-list{position:absolute;top:calc(100% + 4px);left:0;min-width:230px;background:#fff;border:1px solid var(--border);border-radius:var(--radius);box-shadow:0 8px 28px rgba(0,0,0,.1);z-index:50;display:none;max-height:320px;overflow-y:auto;}
.fdd-list.show{display:block;}
.fdd-item{padding:9px 14px;font-size:13px;cursor:pointer;color:var(--text-sub);display:flex;align-items:center;justify-content:space-between;transition:.12s;border-left:3px solid transparent;}
.fdd-item:hover{background:var(--accent-dim);color:var(--text);border-left-color:var(--accent);}
.fdd-item.on{color:var(--accent);font-weight:600;background:var(--accent-dim);border-left-color:var(--accent);}
.fdd-cnt{font-size:11px;color:var(--text-dim);background:var(--bg-surface);padding:1px 7px;border-radius:10px;min-width:24px;text-align:center;}
.fdd-item.on .fdd-cnt{color:var(--accent);background:rgba(106,171,255,0.18);}
.fdd-divider{height:1px;background:var(--border);margin:2px 0;}

/* === TABLE === */
.tw{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;}
table.dt{width:100%;border-collapse:collapse;}
.dt thead{background:var(--bg-elevated);}
.dt th{padding:8px 14px;text-align:left;font-size:11px;font-weight:600;color:var(--text-sub);border-bottom:1px solid var(--border);cursor:pointer;user-select:none;white-space:nowrap;}
.dt th:hover{color:var(--text);}
.dt th .si{margin-left:3px;font-size:9px;opacity:.3;}.dt th.sorted .si{opacity:1;color:var(--accent);}
.dt td{padding:9px 14px;border-bottom:1px solid var(--border);font-size:13px;color:var(--text-sub);white-space:nowrap;}
.dt tbody tr{cursor:pointer;transition:.08s;}
.dt tbody tr:hover{background:var(--bg-hover);}
.dt tbody tr:hover td{color:var(--text);}
.cn{font-weight:600;color:var(--text);display:flex;align-items:center;gap:9px;}
.av{width:28px;height:28px;border-radius:50%;background:#4a5568;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:600;color:#fff;flex-shrink:0;overflow:hidden;}
.av img{width:100%;height:100%;object-fit:cover;}
.cp{display:inline-block;padding:2px 7px;border-radius:4px;font-size:11px;font-weight:600;}
.cp-e{background:var(--amber-dim);color:var(--amber);}
.cp-l{background:var(--accent-dim);color:var(--accent);}
.cp-m{background:var(--bg-hover);color:var(--text-sub);}
.tg{display:flex;gap:3px;flex-wrap:nowrap;overflow:hidden;}
.tg span{padding:2px 7px;border-radius:4px;font-size:11px;background:var(--bg-hover);color:var(--text-sub);white-space:nowrap;}
.tg-match{display:inline-block;padding:2px 7px;border-radius:4px;font-size:11px;background:var(--green-dim);color:var(--green);font-weight:600;margin-left:4px;white-space:nowrap;}

/* search-type badges */
.match-type{font-size:11px;padding:2px 8px;border-radius:4px;font-weight:600;margin-left:6px;}
.match-primary{background:var(--green-dim);color:var(--green);}
.match-secondary{background:var(--amber-dim);color:var(--amber);}

/* === DETAIL SLIDE === */
.dov{position:fixed;top:0;right:0;bottom:0;left:0;background:rgba(0,0,0,.12);z-index:200;opacity:0;visibility:hidden;transition:opacity .2s;}
.dov.open{opacity:1;visibility:visible;}
.dpn{position:fixed;top:0;right:-480px;bottom:0;width:480px;background:var(--bg-surface);border-left:1px solid var(--border);z-index:201;transition:right .2s ease;overflow-y:auto;display:flex;flex-direction:column;box-shadow:-4px 0 20px rgba(0,0,0,.05);}
.dpn.open{right:0;}
.dph{display:flex;align-items:center;justify-content:space-between;padding:14px 20px;border-bottom:1px solid var(--border);flex-shrink:0;}
.dph h3{font-size:12px;font-weight:600;color:var(--text-sub);}
.dcl{width:28px;height:28px;border-radius:var(--radius);border:1px solid var(--border);background:var(--bg-surface);cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--text-sub);font-size:14px;transition:.12s;}
.dcl:hover{background:var(--bg-hover);color:var(--text);}
.dbd{padding:24px 20px;flex:1;}
.dfoto{width:100px;height:120px;border-radius:6px;margin:0 auto 14px;background:#f5f5f5;display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:700;color:#bbb;overflow:hidden;border:2px dashed #d5d5d5;position:relative;flex-direction:column;gap:4px;}
.dfoto.has-photo{border:1.5px solid var(--border);background:#fff;}
.dfoto:not(.has-photo)::after{content:'PHOTO';font-size:9px;font-weight:600;color:#ccc;letter-spacing:2px;}
.dfoto img{width:100%;height:100%;object-fit:cover;}
.dnm{text-align:center;font-size:20px;font-weight:800;margin-bottom:2px;letter-spacing:-.3px;}
.dsub{text-align:center;color:var(--text-sub);font-size:12px;margin-bottom:24px;}
.dgrid{display:grid;grid-template-columns:72px 1fr;gap:0;font-size:13px;}
.dlbl{padding:8px 0;color:var(--text-dim);font-weight:500;border-bottom:1px solid var(--border);}
.dval{padding:8px 0;color:var(--text);border-bottom:1px solid var(--border);font-weight:400;}
.dsec{font-size:11px;font-weight:700;color:var(--text);margin-top:18px;margin-bottom:6px;padding-bottom:4px;border-bottom:1px solid var(--border);}
.dtasks{display:flex;flex-direction:column;gap:0;margin-top:3px;}
.dt-p,.dt-s{padding:8px 10px;font-size:12px;font-weight:400;color:var(--text);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:8px;}
.dt-p::before{content:'';width:6px;height:6px;border-radius:50%;background:var(--green);flex-shrink:0;}
.dt-s::before{content:'';width:6px;height:6px;border-radius:50%;background:var(--amber);flex-shrink:0;}
.dt-p:last-child,.dt-s:last-child{border-bottom:none;}
.dact{padding:14px 20px;border-top:1px solid var(--border);display:flex;gap:7px;flex-shrink:0;}

/* === ORG CHART === */
.org-wrap{overflow-x:auto;overflow-y:auto;padding:20px 0;background:transparent;border-radius:var(--radius-lg);border:1px solid var(--border);}
.org-print-area{display:flex;flex-direction:column;align-items:center;min-width:fit-content;padding:20px 10px;}

/* Í≥µÌÜµ Ïó∞Í≤∞ÏÑ† */
.vl{width:2px;height:18px;background:#b4b4b4;margin:0 auto;}
.hl{height:2px;background:#b4b4b4;}

/* CEO Î∞ïÏä§ */
.o-ceo{background:#1a1a1a;border-radius:10px;padding:12px 32px;text-align:center;cursor:pointer;display:inline-block;box-shadow:0 2px 8px rgba(0,0,0,.12);}
.o-ceo .o-star{color:#f59e0b;font-size:13px;}
.o-ceo .o-nm{font-size:15px;font-weight:700;color:#fff;margin:0 4px;}
.o-ceo .o-pos{font-size:11px;color:#999;font-weight:500;}

/* Í∑∏Î£π(Ïö©Ïù∏ÏÇ¨ÏóÖÏû•/Î≥∏ÏÇ¨) */
.o-grp{background:#1a1a1a;border-radius:22px;padding:6px 22px;color:#fff;font-size:13px;font-weight:600;display:inline-block;}

/* Î∂ÄÎ¨∏ Ìó§Îìú (Î∂ÄÏÇ¨Ïû•/ÏÉÅÎ¨¥Ïù¥ÏÇ¨/Ïù¥ÏÇ¨) - ÎÖπÏÉâ */
.o-head{background:var(--green-dim);border:1.5px solid var(--green);border-radius:8px;padding:6px 14px;text-align:center;cursor:pointer;display:inline-block;white-space:nowrap;}
.o-head .o-star{color:#f59e0b;font-size:12px;vertical-align:middle;}
.o-head .o-nm{font-size:12px;font-weight:700;color:var(--green);margin:0 3px;}
.o-head .o-pos{font-size:9px;color:var(--green);font-weight:500;opacity:.7;}

/* Î∂ÄÎ¨∏ Î∞ïÏä§ */
.o-div{background:#1a1a1a;border-radius:8px;padding:6px 16px;text-align:center;cursor:pointer;display:inline-block;}
.o-div .o-nm{font-size:11px;font-weight:700;color:#fff;white-space:nowrap;}
.o-dh{font-size:8px;color:#999;font-weight:500;margin-top:1px;white-space:nowrap;}

/* ÏÑúÎ∏åÎ∂ÄÎ¨∏ (Ïö©Ïù∏ÏÇ¨ÏóÖÏû• ÌïòÏúÑ) */
.o-subdiv{background:#1a1a1a;border-radius:8px;padding:6px 10px;text-align:center;cursor:pointer;display:inline-block;min-width:110px;}
.o-subdiv .o-nm{font-size:9px;font-weight:700;color:#fff;white-space:nowrap;}
.o-subdiv .o-dh{font-size:7.5px;color:#999;font-weight:500;margin-top:1px;white-space:nowrap;}

/* Î∂ÄÎ¨∏ ÏòÅÏó≠ (ÎØ∏ÏÇ¨Ïö©) */

/* ÌåÄ Î∞ïÏä§ - Í∑†Ïùº ÌÅ¨Í∏∞ */
.o-tm{background:#fff;border:1.5px solid var(--border);border-radius:var(--radius);padding:5px 4px;text-align:center;cursor:pointer;width:110px;box-sizing:border-box;}
.o-tm:hover{border-color:var(--accent);background:var(--accent-dim);}
.o-tm .o-nm{font-size:10px;font-weight:700;color:var(--text);white-space:nowrap;}
.o-tm .o-ld{font-size:8px;color:var(--accent);font-weight:600;margin-top:1px;white-space:nowrap;}

/* Î©§Î≤Ñ Ïπ¥Îìú - ÌåÄÎ∞ïÏä§ÏôÄ ÎèôÏùº ÌÅ¨Í∏∞ */
.o-mem{background:#fff;border:1px solid var(--border);border-radius:var(--radius);padding:3px 4px;text-align:center;cursor:pointer;width:110px;box-sizing:border-box;transition:.1s;}
.o-mem:hover{border-color:var(--accent);background:var(--accent-dim);}
.o-mem .o-nm{font-size:9px;font-weight:600;color:var(--text);}
.o-mem .o-pos{font-size:7.5px;color:var(--text-sub);font-weight:400;}
.o-mem.is-ld{border-left:3px solid #f59e0b;background:#fffde7;}
.o-mem.is-ld .o-star{color:#f59e0b;font-size:8px;}
.o-mem.is-ld .o-nm{color:#1565c0;font-weight:700;}

/* Î©§Î≤Ñ Î¶¨Ïä§Ìä∏ */
.o-mems{display:flex;flex-direction:column;align-items:center;gap:2px;margin-top:3px;}

/* ÏàòÌèâ/ÏàòÏßÅ Í∑∏Î£π */
.o-row{display:flex;justify-content:center;gap:0;align-items:flex-start;}
.o-col{display:flex;flex-direction:column;align-items:center;padding:0 4px;}

/* === SEAT MAP === */
.seat-header{display:flex;align-items:center;gap:12px;margin-bottom:16px;flex-wrap:wrap;}
.seat-tabs{display:flex;gap:6px;}
.seat-tab{padding:8px 18px;border-radius:var(--radius);border:1px solid var(--border);background:var(--bg-surface);color:var(--text-sub);cursor:pointer;font-size:13px;font-weight:500;transition:.15s;}
.seat-tab:hover{border-color:var(--accent);color:var(--text);}
.seat-tab.on{background:var(--accent);border-color:var(--accent);color:#fff;}
.seat-search{flex:1;min-width:200px;max-width:320px;position:relative;}
.seat-search svg{position:absolute;left:10px;top:50%;transform:translateY(-50%);color:var(--text-dim);width:14px;height:14px;}
.seat-search input{width:100%;padding:8px 10px 8px 32px;background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);color:var(--text);font-size:13px;outline:none;transition:.15s;}
.seat-search input:focus{border-color:var(--accent);}
.seat-search input::placeholder{color:var(--text-sub);opacity:.7;}
#seatResult{font-size:12px;color:var(--text-sub);padding:4px 10px;border-radius:var(--radius);transition:.2s;white-space:nowrap;}
#seatResult.ok{background:var(--green-dim);color:var(--green);}
#seatResult.no{background:var(--red-dim);color:var(--red);}
.seat-floor{display:none;background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);overflow-x:auto;overflow-y:auto;}
.seat-floor.on{display:block;}
.seat-bp{position:relative;background:#fff;margin:20px;border:1.5px solid var(--border);border-radius:var(--radius);}
.seat-bp .sk{
    position:absolute;display:flex;flex-direction:column;align-items:center;justify-content:center;
    font-size:11px;font-weight:600;border:1.5px solid rgba(0,0,0,.12);border-radius:6px;
    cursor:pointer;transition:all .2s;text-align:center;line-height:1.2;z-index:3;color:#fff;gap:1px;
}
.seat-bp .sk .sk-pos{font-size:8px;font-weight:400;opacity:.85;}
.seat-bp .sk:hover{transform:scale(1.06);z-index:60;box-shadow:0 2px 10px rgba(0,0,0,.15);}
.seat-bp .sk.hl{
    background:#ff1744!important;color:#fff!important;border:2px solid #ff5252!important;
    transform:scale(1.25);z-index:100;
    box-shadow:0 0 0 4px rgba(255,23,68,.25),0 0 20px rgba(255,23,68,.5);
    animation:seatglow 1s infinite;
}
.seat-bp .sk.dm{opacity:.1;pointer-events:none;}
.seat-bp .sk.empty{background:#f5f7fa!important;border:1px dashed #d8dde3!important;color:transparent!important;font-size:0!important;min-height:0;opacity:.4;}
.seat-bp .sk.empty .sk-pos{display:none;}

/* Î∞∞ÏπòÎèÑ ÏßÅÏõê ÌÅ¥Î¶≠ ÌåùÏóÖ */
.seat-popup{position:fixed;z-index:250;background:#fff;border:1px solid var(--border);border-radius:var(--radius-lg);box-shadow:0 12px 40px rgba(0,0,0,.18);padding:18px;min-width:260px;max-width:320px;opacity:0;transform:translateY(6px);transition:.2s;pointer-events:none;}
.seat-popup.show{opacity:1;transform:translateY(0);pointer-events:auto;}
.seat-popup-close{position:absolute;top:8px;right:10px;cursor:pointer;font-size:16px;color:var(--text-dim);border:none;background:none;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:4px;}
.seat-popup-close:hover{background:var(--bg-hover);color:var(--text);}
.seat-popup-nm{font-size:15px;font-weight:700;margin-bottom:2px;}
.seat-popup-sub{font-size:11px;color:var(--text-sub);margin-bottom:10px;}
.seat-popup-grid{display:grid;grid-template-columns:60px 1fr;gap:0;font-size:12px;}
.seat-popup-grid .sp-l{padding:4px 0;color:var(--text-sub);font-weight:500;border-bottom:1px solid rgba(0,0,0,.04);}
.seat-popup-grid .sp-v{padding:4px 0;color:var(--text);border-bottom:1px solid rgba(0,0,0,.04);}
.seat-popup-tasks{margin-top:6px;display:flex;flex-wrap:wrap;gap:3px;}
.seat-popup-tasks span{padding:2px 6px;border-radius:3px;font-size:10px;background:var(--accent-dim);color:var(--accent);}
@keyframes seatglow{
    0%,100%{box-shadow:0 0 0 4px rgba(255,23,68,.25),0 0 20px rgba(255,23,68,.5);}
    50%{box-shadow:0 0 0 6px rgba(255,23,68,.4),0 0 30px rgba(255,23,68,.8);}
}
.seat-bp .stl{position:absolute;font-size:9px;font-weight:700;padding:2px 7px;border-radius:3px;color:#fff;z-index:4;white-space:nowrap;}
.seat-bp .sdg{position:absolute;border:1px dashed rgba(0,0,0,.08);border-radius:4px;z-index:0;background:rgba(0,0,0,.02);}
.seat-bp .sw{position:absolute;background:#94a3b8;z-index:2;}
.seat-lgd{position:absolute;background:var(--bg-surface);border:1px solid var(--border);border-radius:4px;padding:6px 8px;font-size:9px;z-index:5;line-height:1.7;}
.seat-lgd-i{display:flex;align-items:center;gap:4px;}
.seat-lgd-c{width:12px;height:8px;border-radius:2px;flex-shrink:0;}

/* === ADMIN === */
.adm-lock{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;}
.adm-lock-icon{width:56px;height:56px;border-radius:50%;background:var(--bg-surface);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;margin-bottom:16px;}
.adm-lock-icon svg{width:24px;height:24px;color:var(--text-dim);}
.adm-lock h3{font-size:15px;margin-bottom:6px;}
.adm-lock p{font-size:12px;color:var(--text-sub);margin-bottom:16px;}
.adm-form{display:flex;gap:7px;align-items:center;}
.adm-form input{padding:8px 12px;background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);color:var(--text);font-size:13px;width:180px;outline:none;}
.adm-form input:focus{border-color:var(--accent);}
.adm-c{display:none;}.adm-c.unlocked{display:block;}
.adm-sec{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:22px;margin-bottom:16px;}
.adm-sec-t{font-size:14px;font-weight:600;margin-bottom:14px;padding-bottom:10px;border-bottom:1px solid var(--border);color:var(--text);}
.fg{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:12px;}
.fgi{display:flex;flex-direction:column;gap:4px;}
.fgi label{font-size:11px;font-weight:600;color:var(--text);}
.fgi input,.fgi select,.fgi textarea{padding:8px 11px;background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);color:var(--text);font-size:13px;outline:none;font-family:inherit;transition:.15s;}
.fgi input:focus,.fgi select:focus,.fgi textarea:focus{border-color:var(--accent);}
.fgi textarea{resize:vertical;min-height:50px;}
.fgi.full{grid-column:1/-1;}
.task-rows{display:flex;flex-direction:column;gap:6px;}
.task-input{padding:8px 11px;background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);color:var(--text);font-size:13px;outline:none;font-family:inherit;transition:.15s;width:100%;}
.task-input:focus{border-color:var(--accent);}
.btn-task-add{margin-top:4px;padding:4px 12px;background:none;border:1px dashed var(--border);border-radius:var(--radius);color:var(--text-sub);font-size:12px;cursor:pointer;transition:.15s;}
.btn-task-add:hover{border-color:var(--accent);color:var(--accent);background:var(--accent-dim);}
.photo-upload{display:flex;align-items:center;gap:14px;margin-bottom:8px;}
.photo-preview{width:64px;height:64px;border-radius:50%;background:var(--bg-elevated);border:2px dashed var(--border);display:flex;align-items:center;justify-content:center;overflow:hidden;flex-shrink:0;cursor:pointer;transition:.15s;}
.photo-preview:hover{border-color:var(--accent);}
.photo-preview img{width:100%;height:100%;object-fit:cover;}
.photo-preview svg{width:24px;height:24px;color:var(--text-dim);}
.photo-actions{display:flex;flex-direction:column;gap:4px;}
.photo-actions .btn{font-size:11px;padding:4px 10px;}
.fa{display:flex;gap:7px;margin-top:14px;}

/* excel */
.xdrop{border:2px dashed var(--border);border-radius:var(--radius-lg);padding:30px 20px;text-align:center;cursor:pointer;transition:.15s;}
.xdrop:hover{border-color:var(--accent);background:var(--accent-dim);}
.xdrop.over{border-color:var(--accent);background:rgba(91,157,255,.08);}
.xdrop .xt{font-weight:600;font-size:13px;color:var(--text);}
.xdrop p{color:var(--text-sub);font-size:12px;margin-top:6px;}
.xprev{margin-top:14px;overflow-x:auto;}
.xprev table{width:100%;border-collapse:collapse;font-size:11px;}
.xprev th{background:var(--bg-elevated);padding:5px 8px;text-align:left;color:var(--text-sub);border:1px solid var(--border);}
.xprev td{padding:5px 8px;border:1px solid var(--border);color:var(--text-sub);}
.dacts{display:flex;gap:7px;flex-wrap:wrap;}

/* toast */
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(20px);background:#1a1a1a;color:#fff;padding:10px 24px;border-radius:var(--radius-lg);font-size:13px;font-weight:500;z-index:300;opacity:0;transition:.25s;pointer-events:none;border:none;}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
.toast.ok{background:var(--green);}
.toast.err{background:var(--red);}

.empty{text-align:center;padding:50px 20px;color:var(--text-dim);font-size:13px;}

/* === ORG TREE VIEW === */
.orgtree-layout{display:flex;gap:0;min-height:400px;border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;background:var(--bg-surface);}
.orgtree-nav{width:240px;flex-shrink:0;background:var(--bg-elevated);border-right:1px solid var(--border);overflow-y:auto;}
.orgtree-nav-title{font-size:10px;font-weight:700;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;padding:14px 16px 8px;user-select:none;}
.orgtree-div{border-bottom:1px solid var(--border);}
.orgtree-div:last-child{border-bottom:none;}
.orgtree-div-hd{display:flex;align-items:center;gap:6px;padding:9px 14px;cursor:pointer;font-size:13px;font-weight:700;color:var(--text);transition:.12s;user-select:none;position:relative;}
.orgtree-div-hd:hover{background:var(--bg-hover);}
.orgtree-div-hd .ot-arrow{width:14px;height:14px;color:var(--text-dim);transition:transform .2s;flex-shrink:0;}
.orgtree-div-hd.collapsed .ot-arrow{transform:rotate(-90deg);}
.orgtree-div-hd .ot-cnt{font-size:10px;font-weight:500;color:var(--text-dim);margin-left:auto;}
.orgtree-div-body{}
.orgtree-div-body.collapsed{display:none;}
.orgtree-tm{display:flex;align-items:center;gap:6px;padding:7px 14px 7px 28px;cursor:pointer;font-size:12px;font-weight:500;color:var(--text-sub);transition:.12s;user-select:none;position:relative;}
.orgtree-tm:hover{background:var(--bg-hover);color:var(--text);}
.orgtree-tm.on{background:var(--accent-dim);color:var(--accent);font-weight:600;}
.orgtree-tm .ot-dot{width:6px;height:6px;border-radius:50%;flex-shrink:0;}
.orgtree-tm .ot-tm-cnt{font-size:10px;color:var(--text-dim);margin-left:auto;}
.orgtree-tm.on .ot-tm-cnt{color:var(--accent);}
.orgtree-content{flex:1;overflow-y:auto;padding:0;}
.orgtree-empty{display:flex;align-items:center;justify-content:center;height:100%;color:var(--text-dim);font-size:13px;flex-direction:column;gap:8px;padding:40px;}
.orgtree-empty svg{width:40px;height:40px;color:var(--text-dim);opacity:.4;}
.orgtree-team-hd{padding:16px 20px 12px;border-bottom:1px solid var(--border);background:var(--bg-elevated);}
.orgtree-team-nm{font-size:16px;font-weight:800;color:var(--text);display:flex;align-items:center;gap:8px;}
.orgtree-team-nm .ot-color{width:10px;height:10px;border-radius:3px;flex-shrink:0;}
.orgtree-team-cnt{font-size:12px;color:var(--text-sub);margin-top:3px;}
.orgtree-members{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px;padding:20px;}
.orgtree-mem{display:flex;flex-direction:column;align-items:center;gap:10px;padding:20px 16px;border:1px solid var(--border);border-radius:var(--radius-lg);cursor:pointer;transition:.12s;background:var(--bg-surface);text-align:center;}
.orgtree-mem:hover{border-color:var(--accent);box-shadow:0 2px 10px rgba(0,0,0,.06);}
.orgtree-mem .av{width:68px;height:68px;font-size:22px;}
.orgtree-mem-info{display:flex;flex-direction:column;align-items:center;gap:3px;min-width:0;width:100%;}
.orgtree-mem-top{display:flex;align-items:center;gap:6px;justify-content:center;flex-wrap:wrap;}
.orgtree-mem-nm{font-size:14px;font-weight:700;color:var(--text);}
.orgtree-mem-pos{font-size:10px;font-weight:600;padding:1px 7px;border-radius:4px;}
.orgtree-mem-tasks{font-size:11px;color:var(--text-sub);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%;}
.orgtree-mem-right{display:flex;flex-direction:column;align-items:center;gap:1px;}
.orgtree-mem-phone{font-size:12px;color:var(--text);font-weight:600;letter-spacing:.2px;}
.orgtree-mem-email{font-size:11px;color:var(--text-sub);overflow:hidden;text-overflow:ellipsis;max-width:100%;}

/* === SIDEBAR HOTLINE === */
.sb-hotline{padding:8px 10px;border-top:1px solid rgba(255,255,255,.08);}
.sb-hotline-title{font-size:8px;font-weight:700;color:var(--sidebar-dim);text-transform:uppercase;letter-spacing:.8px;margin-bottom:4px;padding:0 2px;}
.sb-hotline-item{display:flex;align-items:center;justify-content:space-between;padding:3px 6px;border-radius:4px;font-size:11px;color:var(--sidebar-dim);text-decoration:none;transition:.1s;cursor:pointer;}
.sb-hotline-item:hover{background:var(--sidebar-hover);}
.sb-hl-label{font-weight:600;color:var(--sidebar-text);font-size:10px;}
.sb-hl-num{font-weight:700;color:#a3bffa;font-size:11px;letter-spacing:.3px;}

/* === CONTACTS === */
.ct-cat{font-size:10px;font-weight:700;padding:2px 8px;border-radius:10px;white-space:nowrap;display:inline-block;}
.ct-cat-Í±∞ÎûòÏ≤ò{background:#dbeafe;color:#1d4ed8;}
.ct-cat-ÌòëÎ†•ÏóÖÏ≤¥{background:#d1fae5;color:#065f46;}
.ct-cat-Î∞∞ÏÜ°Î¨ºÎ•ò,.ct-cat-Î∞∞ÏÜ°\/Î¨ºÎ•ò{background:#fef3c7;color:#92400e;}
.ct-cat-Í∏àÏúµÎ≥¥Ìóò,.ct-cat-Í∏àÏúµ\/Î≥¥Ìóò{background:#fce7f3;color:#9d174d;}
.ct-cat-Í¥ÄÍ≥µÏÑú{background:#e0e7ff;color:#3730a3;}
.ct-cat-ITÏãúÏä§ÌÖú,.ct-cat-IT\/ÏãúÏä§ÌÖú{background:#f3e8ff;color:#7c3aed;}
.ct-cat-ÌöåÏÇ¨Î≤ïÏù∏Ìè∞{background:#fef3c7;color:#b45309;}
.ct-cat-Í∏∞ÌÉÄ{background:var(--bg-hover);color:var(--text-sub);}

/* Î∂ÑÎ•ò Í∑∏Î£π (ÏïÑÏΩîÎîîÏñ∏) */
.ct-group{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);margin-bottom:12px;overflow:hidden;}
.ct-group-hd{display:flex;align-items:center;justify-content:space-between;padding:10px 16px;cursor:pointer;background:var(--bg-elevated);transition:.12s;user-select:none;}
.ct-group-hd:hover{background:#e4e6ea;}
.ct-group-left{display:flex;align-items:center;gap:8px;}
.ct-group-cnt{font-size:11px;color:var(--text-dim);font-weight:400;}
.ct-group-arrow{width:16px;height:16px;color:var(--text-dim);transition:transform .2s;flex-shrink:0;}
.ct-group-hd.collapsed .ct-group-arrow{transform:rotate(-90deg);}
.ct-group-body{border-top:1px solid var(--border);}
.ct-group-body.collapsed{display:none;}

/* ÌÖåÏù¥Î∏îÌòï Ìñâ */
table.ct-tbl{width:100%;border-collapse:collapse;}
.ct-tbl th{padding:7px 14px;text-align:left;font-size:11px;font-weight:600;color:var(--text-sub);background:var(--bg-elevated);border-bottom:1px solid var(--border);white-space:nowrap;}
.ct-tbl td{padding:8px 14px;font-size:13px;color:var(--text-sub);border-bottom:1px solid var(--border);white-space:nowrap;}
.ct-tbl tbody tr{transition:.08s;}
.ct-tbl tbody tr:hover{background:var(--bg-hover);}
.ct-tbl tbody tr:hover td{color:var(--text);}
.ct-tbl tbody tr:last-child td{border-bottom:none;}
.ct-tbl .ct-company{font-size:13px;font-weight:600;color:var(--text);}
.ct-tbl a{color:var(--accent);font-weight:500;text-decoration:none;}
.ct-tbl a:hover{text-decoration:underline;}
.ct-tbl .ct-memo-cell{font-size:11px;color:var(--text-dim);max-width:200px;overflow:hidden;text-overflow:ellipsis;}
.ct-tbl .ct-edit-btn{font-size:11px;color:var(--text-dim);cursor:pointer;padding:3px 8px;border-radius:4px;border:1px solid var(--border);background:none;transition:.1s;white-space:nowrap;}
.ct-tbl .ct-edit-btn:hover{background:var(--accent-dim);color:var(--accent);border-color:var(--accent);}

/* contact modal */
.ct-modal-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.2);z-index:300;align-items:center;justify-content:center;}
.ct-modal-overlay.show{display:flex;}
.ct-modal{background:var(--bg-surface);border-radius:12px;width:500px;max-width:92vw;box-shadow:0 16px 48px rgba(0,0,0,.12);animation:modalIn .15s ease;}
.ct-modal-hd{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--border);}
.ct-modal-hd h3{font-size:14px;font-weight:700;}
.ct-modal-bd{padding:20px;}

@media(max-width:768px){.sidebar{display:none;}.main-area{margin-left:0;}.hd{display:flex;}.wrap{padding:14px;}.dpn{width:100%;}.stats{flex-wrap:wrap;gap:12px;}}

/* === PRINT === */
@media print{
    body{background:#fff!important;color:#1a1a2e!important;-webkit-print-color-adjust:exact;print-color-adjust:exact;}
    .hd,.nav,.sidebar,.sbar,.stats,.dov,.dpn,.toast,.org-toolbar{display:none!important;}
    .main-area{margin-left:0!important;}
    .wrap{padding:0!important;max-width:100%!important;}
    .panel{display:none!important;}
    .panel.print-target{display:block!important;}
    .panel.print-target .seat-header{display:none!important;}
    .panel.print-target .seat-floor{display:block!important;overflow:visible!important;}
    .panel.print-target .seat-floor:not(.on){display:none!important;}
    .tw{border:none!important;box-shadow:none!important;}
    .dt th{background:#e8edf5!important;color:#333!important;border-color:#ccc!important;}
    .dt td{color:#333!important;border-color:#ddd!important;}
    .org-print-area{transform-origin:top left;}
    .seat-bp .sk{-webkit-print-color-adjust:exact;print-color-adjust:exact;}
    .o-ceo,.o-grp,.o-div,.o-subdiv,.o-head,.o-tm,.o-mem{-webkit-print-color-adjust:exact;print-color-adjust:exact;}
}
</style>
</head>
<body>

<!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
<aside class="sidebar">
    <div class="sb-logo">
        <div class="sb-logo-icon">N</div>
        <div>
            <div class="sb-logo-text">NETFORM R&D</div>
            <div class="sb-logo-sub">ÏßÅÏõê Ï†ïÎ≥¥ ÏãúÏä§ÌÖú</div>
        </div>
    </div>
    <div class="sb-section">
        <div class="sb-section-title">Î©îÎâ¥</div>
        <button class="sb-item on" data-p="directory"><span class="icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></span>ÏßÅÏõê Î™©Î°ù</button>
        <button class="sb-item" data-p="orgchart"><span class="icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="8.5" y="14" width="7" height="7" rx="1"/><line x1="6.5" y1="10" x2="6.5" y2="14"/><line x1="17.5" y1="10" x2="17.5" y2="14"/><line x1="6.5" y1="14" x2="17.5" y2="14"/><line x1="12" y1="14" x2="12" y2="14"/></svg></span>Ï°∞ÏßÅÎèÑ</button>
        <button class="sb-item" data-p="seatmap"><span class="icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="3" y1="15" x2="21" y2="15"/><line x1="9" y1="3" x2="9" y2="21"/><line x1="15" y1="3" x2="15" y2="21"/></svg></span>ÏûêÎ¶¨Î∞∞ÏπòÎèÑ</button>
        <button class="sb-item" data-p="contacts"><span class="icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.79 19.79 0 0 1 2.12 4.18 2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.362 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.338 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg></span>ÏóÖÎ¨¥ Ïó∞ÎùΩÏ≤ò</button>
    </div>
    <div class="sb-section">
        <div class="sb-section-title">Í¥ÄÎ¶¨</div>
        <button class="sb-item" data-p="admin"><span class="icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></span>ÏßÅÏõê Í¥ÄÎ¶¨</button>
    </div>
    <div class="sb-export">
        <button class="btn" onclick="exportJSON()" style="width:100%;justify-content:center;">üì§ Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
    </div>
    <div class="sb-hotline">
        <div class="sb-hotline-title">ÎåÄÌëúÎ≤àÌò∏</div>
        <a href="tel:1899-2734" class="sb-hotline-item"><span class="sb-hl-label">ÎÑ∑Ìèº</span><span class="sb-hl-num">1899-2734</span></a>
        <a href="tel:1800-8203" class="sb-hotline-item"><span class="sb-hl-label">POURÏä§ÌÜ†Ïñ¥</span><span class="sb-hl-num">1800-8203</span></a>
    </div>
    <div class="sb-hotline" style="border-top:1px dashed rgba(255,255,255,.08);">
        <div class="sb-hotline-title">üì† Ï∏µÎ≥Ñ Ìå©Ïä§Î≤àÌò∏</div>
        <div class="sb-hotline-item"><span class="sb-hl-label">2Ï∏µ</span><span class="sb-hl-num">031-373-6045</span></div>
        <div class="sb-hotline-item"><span class="sb-hl-label">3Ï∏µ</span><span class="sb-hl-num">031-373-2734</span></div>
    </div>
    <div class="sb-footer">¬© 2026 NETFORM R&D</div>
</aside>

<!-- Í∏∞Ï°¥ nav (Ïà®ÍπÄÏ≤òÎ¶¨, JSÌò∏ÌôòÏö©) -->
<nav class="nav" style="display:none">
    <button class="nav-btn on" data-p="directory">ÏßÅÏõê Î™©Î°ù</button>
    <button class="nav-btn" data-p="orgchart">Ï°∞ÏßÅÎèÑ</button>
    <button class="nav-btn" data-p="seatmap">ÏûêÎ¶¨Î∞∞ÏπòÎèÑ</button>
    <button class="nav-btn" data-p="contacts">ÏóÖÎ¨¥ Ïó∞ÎùΩÏ≤ò</button>
    <button class="nav-btn" data-p="admin">Í¥ÄÎ¶¨</button>
</nav>

<div class="main-area">
<header class="hd">
    <div class="hd-logo">NETFORM R&D / <b id="breadcrumbTitle">ÏßÅÏõê Î™©Î°ù</b></div>
</header>

<div class="wrap">

<!-- ===== ÏßÅÏõê Î™©Î°ù (ÌÜµÌï© Í≤ÄÏÉâ) ===== -->
<div id="p-directory" class="panel on">
    <div class="stats" id="statsBar"></div>
    <div class="sbar">
        <div class="sbox">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            <input type="text" id="mainSearch" placeholder="Ïù¥Î¶Ñ, ÌåÄÎ™Ö, ÏóÖÎ¨¥ ÌÇ§ÏõåÎìúÎ°ú ÌÜµÌï© Í≤ÄÏÉâ">
        </div>
        <div style="display:flex;gap:4px;align-items:center;">
            <button class="btn" id="viewOrgTree" onclick="setView('orgtree')" title="Ï°∞ÏßÅÌä∏Î¶¨ Î≥¥Í∏∞"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;"><circle cx="12" cy="5" r="2"/><circle cx="6" cy="13" r="2"/><circle cx="18" cy="13" r="2"/><line x1="12" y1="7" x2="12" y2="10"/><line x1="12" y1="10" x2="6" y2="11"/><line x1="12" y1="10" x2="18" y2="11"/><line x1="6" y1="15" x2="6" y2="18"/><line x1="18" y1="15" x2="18" y2="18"/></svg></button>
            <button class="btn" id="viewAcc" onclick="setView('acc')" style="background:var(--accent);color:#fff;border-color:var(--accent);" title="ÏïÑÏΩîÎîîÏñ∏ Î≥¥Í∏∞"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;"><rect x="3" y="3" width="18" height="4" rx="1"/><rect x="3" y="10" width="18" height="4" rx="1"/><rect x="3" y="17" width="18" height="4" rx="1"/></svg></button>
            <button class="btn btn-p" onclick="downloadDirectoryPDF()" title="PDF Îã§Ïö¥Î°úÎìú"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> PDF</button>
        </div>
        <div class="fdd" id="ddDiv">
            <div class="fdd-btn" onclick="togDD('ddDiv')"><span id="lblDiv">Ï†ÑÏ≤¥ Î∂ÄÎ¨∏</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg></div>
            <div class="fdd-list" id="lstDiv"></div>
        </div>
        <div class="fdd" id="ddTeam">
            <div class="fdd-btn" onclick="togDD('ddTeam')"><span id="lblTeam">Ï†ÑÏ≤¥ ÌåÄ</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg></div>
            <div class="fdd-list" id="lstTeam"></div>
        </div>
        <div class="fdd" id="ddPos">
            <div class="fdd-btn" onclick="togDD('ddPos')"><span id="lblPos">Ï†ÑÏ≤¥ ÏßÅÏúÑ</span><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg></div>
            <div class="fdd-list" id="lstPos"></div>
        </div>
        <button class="btn" id="btnReset" style="display:none" onclick="resetFilters()">Ï¥àÍ∏∞Ìôî</button>
    </div>
    <!-- ÌÖåÏù¥Î∏î Î∑∞ (ÎÇ¥Î∂ÄÏö© - Ïà®ÍπÄ) -->
    <div id="viewTableWrap" style="display:none;">
    <div class="tw"><table class="dt" id="tbl"><thead><tr>
        <th data-s="name" style="min-width:130px">ÏÑ±Î™Ö <span class="si">&#9650;</span></th>
        <th data-s="division">Î∂ÄÎ¨∏ <span class="si">&#9650;</span></th>
        <th data-s="team">ÌåÄÎ™Ö <span class="si">&#9650;</span></th>
        <th data-s="position">ÏßÅÏúÑ <span class="si">&#9650;</span></th>
        <th data-s="phone">Ïó∞ÎùΩÏ≤ò <span class="si">&#9650;</span></th>
        <th>Îã¥ÎãπÏóÖÎ¨¥</th>
    </tr></thead><tbody id="tbody"></tbody></table></div>
    </div>
    <!-- Ï°∞ÏßÅÌä∏Î¶¨ Î∑∞ (Í∏∞Î≥∏) -->
    <div id="viewOrgTreeWrap" style="display:none;">
        <div class="orgtree-layout">
            <div class="orgtree-nav" id="orgTreeNav"></div>
            <div class="orgtree-content" id="orgTreeContent">
                <div class="orgtree-empty">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    <span>ÏôºÏ™Ω Ï°∞ÏßÅÎèÑÏóêÏÑú ÌåÄÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</span>
                </div>
            </div>
        </div>
    </div>
    <!-- ÏïÑÏΩîÎîîÏñ∏ Î∑∞ -->
    <div id="viewAccWrap">
        <div id="accArea" class="acc-wrap"></div>
    </div>
    <div id="tbEmpty" class="empty" style="display:none"><p>Îì±Î°ùÎêú ÏßÅÏõêÏù¥ ÏóÜÏäµÎãàÎã§.</p><p style="margin-top:10px"><button class="btn btn-p" onclick="loadSample()">Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ Î≥µÏõê</button></p></div>
</div>

<!-- ===== Ï°∞ÏßÅÎèÑ ===== -->
<div id="p-orgchart" class="panel">
    <div class="sbar org-toolbar" style="justify-content:flex-end">
        <button class="btn" onclick="printOrg()">Ïù∏ÏáÑ</button>
        <button class="btn btn-p" onclick="downloadPDF()">PDF Îã§Ïö¥Î°úÎìú</button>
    </div>
    <div class="org-wrap"><div id="orgArea" class="org-print-area"></div></div>
</div>

<!-- ===== ÏûêÎ¶¨Î∞∞ÏπòÎèÑ ===== -->
<div id="p-seatmap" class="panel">
    <div class="seat-header">
        <div class="seat-tabs">
            <div class="seat-tab on" data-sf="sf2">2Ï∏µ</div>
            <div class="seat-tab" data-sf="sf3">3Ï∏µ</div>
        </div>
        <div class="seat-search">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            <input type="text" id="seatSI" placeholder="Ïù¥Î¶Ñ Í≤ÄÏÉâ (Ïòà: ÍπÄÏú†Î¶º)">
        </div>
        <div id="seatResult"></div>
        <div style="margin-left:auto;display:flex;gap:6px;">
            <button class="btn" onclick="printSeat()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;"><path d="M6 9V2h12v7"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg> Ï∂úÎ†•</button>
            <button class="btn btn-p" onclick="downloadSeatPDF()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> PDF</button>
        </div>
    </div>

    <!-- 2Ï∏µ ÎèÑÎ©¥ -->
    <div class="seat-floor on" id="sf2">
        <div class="seat-bp" style="width:1000px;height:680px;">
            <!-- Ïô∏Î≤Ω -->
            <div class="sw" style="left:0;top:0;width:1000px;height:2px;"></div>
            <div class="sw" style="left:0;top:0;width:2px;height:680px;"></div>
            <div class="sw" style="left:998px;top:0;width:2px;height:680px;"></div>
            <div class="sw" style="left:0;top:678px;width:1000px;height:2px;"></div>

            <!-- Î≤îÎ°Ä -->
            <div class="seat-lgd" style="right:14px;bottom:14px;">
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#4F6DB5"></div>Í≤ΩÏòÅÍ¥ÄÎ¶¨ÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#3182CE"></div>ÏÑúÎπÑÏä§Ïö¥ÏòÅ1ÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#805AD5"></div>ÏÑúÎπÑÏä§Ïö¥ÏòÅ2ÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#0891B2"></div>ÏÑúÎπÑÏä§Ïö¥ÏòÅ3ÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#D97706"></div>ÏÑ§Í≥Ñ/Ï†ÅÏÇ∞ÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#16A34A"></div>ÏòÅÏóÖÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#0E7490"></div>ÏÜåÏû¨ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#2563EB"></div>Í±¥ÏÑ§ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå</div>
            </div>

            <!-- ====== Ìô©Ïú§ÏÑ† ÎèÖÎ¶ΩÏã§ (Ï¢åÏ∏° ÏÉÅÎã®) ====== -->
            <div class="sdg" style="left:16px;top:16px;width:140px;height:180px;"></div>
            <div class="sk" data-name="Ìô©Ïú§ÏÑ†" style="left:30px;top:70px;width:110px;height:48px;background:#3182CE;">Ìô©Ïú§ÏÑ†<span class="sk-pos">ÏÉÅÎ¨¥Ïù¥ÏÇ¨</span></div>

            <!-- ====== ÏÉÅÎã® Îç∞Ïä§ÌÅ¨ (4√ó2) ====== -->
            <div class="sdg" style="left:180px;top:16px;width:400px;height:120px;"></div>
            <div class="sk" data-name="ÏµúÏòÅÏò•" style="left:188px;top:24px;width:90px;height:44px;background:#4F6DB5;">ÏµúÏòÅÏò•<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ïã†ÎÇòÏòÅ" style="left:286px;top:24px;width:90px;height:44px;background:#4F6DB5;">Ïã†ÎÇòÏòÅ<span class="sk-pos">Î¶¨Îìú Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ï£ºÏú†ÏßÑ" style="left:384px;top:24px;width:90px;height:44px;background:#4F6DB5;">Ï£ºÏú†ÏßÑ<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="ÍπÄÏú†Î¶º" style="left:482px;top:24px;width:90px;height:44px;background:#4F6DB5;">ÍπÄÏú†Î¶º<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk empty" style="left:188px;top:76px;width:90px;height:20px;"></div>
            <div class="sk" data-name="ÍπÄÏàòÏßÑ" style="left:286px;top:76px;width:90px;height:44px;background:#805AD5;">ÍπÄÏàòÏßÑ<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Í∂åÏ†ïÏïÑ" style="left:384px;top:76px;width:90px;height:44px;background:#805AD5;">Í∂åÏ†ïÏïÑ<span class="sk-pos">Î¶¨Îìú Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ïù¥ÏßÄÏó∞" style="left:482px;top:76px;width:90px;height:44px;background:#805AD5;">Ïù¥ÏßÄÏó∞<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>

            <!-- ====== ÌôîÏû•Ïã§ ====== -->
            <div class="sdg" style="left:850px;top:200px;width:130px;height:76px;">
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:12px;color:#90a4ae;font-weight:600;">ÌôîÏû•Ïã§(ÎÇ®)</div>
            </div>
            <div class="sdg" style="left:850px;top:294px;width:130px;height:76px;">
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:12px;color:#90a4ae;font-weight:600;">ÌôîÏû•Ïã§(Ïó¨)</div>
            </div>

            <!-- ====== Ï§ëÏïô Îç∞Ïä§ÌÅ¨1 (3+2) ====== -->
            <div class="sdg" style="left:180px;top:160px;width:300px;height:120px;"></div>
            <div class="sk" data-name="ÍπÄÍ≤ΩÎØ∏" style="left:188px;top:168px;width:90px;height:44px;background:#3182CE;">ÍπÄÍ≤ΩÎØ∏<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="ÏÜ°Î≥¥Îûå" style="left:286px;top:168px;width:90px;height:44px;background:#0891B2;">ÏÜ°Î≥¥Îûå<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ï£ºÌòÑÏßÑ" style="left:384px;top:168px;width:90px;height:44px;background:#0891B2;">Ï£ºÌòÑÏßÑ<span class="sk-pos">Î¶¨Îìú Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ï°∞ÌòÑÏãù" style="left:188px;top:220px;width:90px;height:44px;background:#9CA3AF;">Ï°∞ÌòÑÏãù</div>
            <div class="sk" data-name="ÌïúÏù∏Í∑ú" style="left:286px;top:220px;width:90px;height:44px;background:#D97706;">ÌïúÏù∏Í∑ú<span class="sk-pos">Î¶¨Îìú Îß§ÎãàÏ†Ä</span></div>

            <!-- ====== ÌöåÏùòÏã§ (Ï¢åÏ∏° Ï§ëÍ∞Ñ) ====== -->
            <div class="sdg" style="left:16px;top:220px;width:140px;height:180px;">
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:13px;color:#90a4ae;font-weight:600;">ÌöåÏùòÏã§</div>
            </div>

            <!-- ====== Ï§ëÏïô Îç∞Ïä§ÌÅ¨2 (3√ó2) ====== -->
            <div class="sdg" style="left:180px;top:290px;width:300px;height:120px;"></div>
            <div class="sk" data-name="Ï†ïÌÉúÏú§" style="left:188px;top:298px;width:90px;height:44px;background:#D97706;">Ï†ïÌÉúÏú§<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ïã†ÏàòÏßÑ" style="left:286px;top:298px;width:90px;height:44px;background:#9CA3AF;">Ïã†ÏàòÏßÑ</div>
            <div class="sk" data-name="ÍπÄÏòÅÏÑ±" style="left:384px;top:298px;width:90px;height:44px;background:#9CA3AF;">ÍπÄÏòÅÏÑ±</div>
            <div class="sk" data-name="ÌïúÏ§ÄÏóΩ" style="left:188px;top:350px;width:90px;height:44px;background:#3182CE;">ÌïúÏ§ÄÏóΩ<span class="sk-pos">Î¶¨Îìú Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="ÍπÄÏÑ±ÎØº" style="left:286px;top:350px;width:90px;height:44px;background:#3182CE;">ÍπÄÏÑ±ÎØº<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ïù¥ÌïÑÏÑ†" style="left:384px;top:350px;width:90px;height:44px;background:#16A34A;">Ïù¥ÌïÑÏÑ†<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>

            <!-- ====== Ï°∞Ïû¨Ïó∞/Ï†ïÏ†ïÌõà ÎèÖÎ¶Ω (3√ó1) ====== -->
            <div class="sdg" style="left:180px;top:434px;width:300px;height:56px;"></div>
            <div class="sk" data-name="Ï°∞Ïû¨Ïó∞" style="left:188px;top:440px;width:90px;height:44px;background:#3182CE;">Ï°∞Ïû¨Ïó∞<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ï†ïÏ†ïÌõà" style="left:286px;top:440px;width:90px;height:44px;background:#3182CE;">Ï†ïÏ†ïÌõà<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk empty" style="left:384px;top:440px;width:90px;height:20px;"></div>

            <!-- ====== Ïó∞Íµ¨ÏÜå (Ï¢åÏ∏° ÌïòÎã®) ====== -->
            <div class="sdg" style="left:16px;top:510px;width:230px;height:148px;">
                <div style="position:absolute;top:4px;left:10px;font-size:11px;color:#0097a7;font-weight:700;">Ïó∞Íµ¨ÏÜå</div>
            </div>
            <div class="sk" data-name="Ïù¥Ï†ïÌõà" style="left:24px;top:540px;width:100px;height:44px;background:#2563EB;">Ïù¥Ï†ïÌõà<span class="sk-pos">Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•</span></div>
            <div class="sk" data-name="Ïã†Î™ÖÌù¨" style="left:134px;top:540px;width:100px;height:44px;background:#0E7490;">Ïã†Î™ÖÌù¨<span class="sk-pos">ÏÑ†ÏûÑÏó∞Íµ¨Ïõê</span></div>
            <div class="sk" data-name="Ïã¨ÌòúÏßÑ" style="left:24px;top:594px;width:100px;height:44px;background:#2563EB;">Ïã¨ÌòúÏßÑ<span class="sk-pos">Ïó∞Íµ¨Ïõê</span></div>
            <div class="sk" data-name="ÍπÄÏÜåÏ†ï" style="left:134px;top:594px;width:100px;height:44px;background:#2563EB;">ÍπÄÏÜåÏ†ï<span class="sk-pos">Ïó∞Íµ¨Ïõê</span></div>

            <!-- ====== Î∞±Ï†ïÏÑù ====== -->
            <div class="sdg" style="left:290px;top:520px;width:110px;height:100px;"></div>
            <div class="sk" data-name="Î∞±Ï†ïÏÑù" style="left:295px;top:544px;width:100px;height:48px;background:#4F6DB5;font-size:12px;">Î∞±Ï†ïÏÑù<span class="sk-pos">Ïù¥ÏÇ¨</span></div>

            <!-- ====== ÌöåÏùòÏã§ (ÌïòÎã®) ====== -->
            <div class="sdg" style="left:440px;top:520px;width:150px;height:100px;">
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:13px;color:#90a4ae;font-weight:600;">ÌöåÏùòÏã§</div>
            </div>

            <!-- ====== ÌÉïÎπÑÏã§ ====== -->
            <div class="sdg" style="left:850px;top:388px;width:130px;height:90px;">
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:13px;color:#90a4ae;font-weight:600;">ÌÉïÎπÑÏã§</div>
            </div>
        </div>
    </div>

    <!-- 3Ï∏µ ÎèÑÎ©¥ -->
    <div class="seat-floor" id="sf3">
        <div class="seat-bp" style="width:1000px;height:680px;">
            <!-- Ïô∏Î≤Ω -->
            <div class="sw" style="left:0;top:0;width:1000px;height:2px;"></div>
            <div class="sw" style="left:0;top:0;width:2px;height:680px;"></div>
            <div class="sw" style="left:998px;top:0;width:2px;height:680px;"></div>
            <div class="sw" style="left:0;top:678px;width:1000px;height:2px;"></div>

            <!-- Î≤îÎ°Ä -->
            <div class="seat-lgd" style="right:14px;bottom:14px;">
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#6D28D9"></div>Î∏åÎûúÎìúÏª§Î®∏Ïä§ÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#0D9488"></div>ÎØ∏ÎîîÏñ¥Ïª§Î®∏Ïä§ÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#EA580C"></div>Ìï¥Ïô∏ÏÇ¨ÏóÖÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#DC2626"></div>Î™®Ïó¨ÎùºÎîúÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#CA8A04"></div>Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#DB2777"></div>Í∑∏Î°úÏä§ÌåÄ</div>
                <div class="seat-lgd-i"><div class="seat-lgd-c" style="background:#475569"></div>ÎåÄÌëúÏù¥ÏÇ¨</div>
            </div>

            <!-- ====== Ïù¥ÏäπÏö∞ ÎåÄÌëúÏù¥ÏÇ¨Ïã§ (Ï¢åÏ∏° ÏÉÅÎã®) ====== -->
            <div class="sdg" style="left:16px;top:16px;width:140px;height:180px;"></div>
            <div class="sk" data-name="Ïù¥ÏäπÏö∞" style="left:30px;top:70px;width:110px;height:48px;background:#475569;font-size:12px;">Ïù¥ÏäπÏö∞<span class="sk-pos">ÎåÄÌëúÏù¥ÏÇ¨</span></div>

            <!-- ====== ÏÉÅÎã® Îç∞Ïä§ÌÅ¨ (4√ó2) ====== -->
            <div class="sdg" style="left:180px;top:16px;width:400px;height:120px;"></div>
            <div class="sk" data-name="ÌóàÏßÄÏùÄ" style="left:188px;top:24px;width:90px;height:44px;background:#0D9488;">ÌóàÏßÄÏùÄ<span class="sk-pos">Î¶¨ÎìúÎß§ÎãàÏ†Ä</span></div>
            <div class="sk empty" style="left:286px;top:24px;width:90px;height:20px;"></div>
            <div class="sk" data-name="ÍπÄÏÜåÏó∞" style="left:384px;top:24px;width:90px;height:44px;background:#0D9488;">ÍπÄÏÜåÏó∞<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="ÎÇ®Ïú§Ï†ï" style="left:482px;top:24px;width:90px;height:44px;background:#0D9488;">ÎÇ®Ïú§Ï†ï<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ïù¥ÎûÄ" style="left:188px;top:76px;width:90px;height:44px;background:#6D28D9;">Ïù¥ÎûÄ<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ï©êÌã∞Î¶¨" style="left:286px;top:76px;width:90px;height:44px;background:#EA580C;">Ï©êÌã∞Î¶¨<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="ÍπÄÏ±ÑÏõê" style="left:384px;top:76px;width:90px;height:44px;background:#EA580C;">ÍπÄÏ±ÑÏõê<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk empty" style="left:482px;top:76px;width:90px;height:20px;"></div>

            <!-- ====== ÌôîÏû•Ïã§ ====== -->
            <div class="sdg" style="left:850px;top:120px;width:130px;height:76px;">
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:12px;color:#90a4ae;font-weight:600;">ÌôîÏû•Ïã§(ÎÇ®)</div>
            </div>
            <div class="sdg" style="left:850px;top:214px;width:130px;height:76px;">
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:12px;color:#90a4ae;font-weight:600;">ÌôîÏû•Ïã§(Ïó¨)</div>
            </div>

            <!-- ====== Ï§ëÏïô Îç∞Ïä§ÌÅ¨ (3√ó2) ====== -->
            <div class="sdg" style="left:180px;top:160px;width:300px;height:120px;"></div>
            <div class="sk" data-name="ÍπÄÎØºÏßÄ" style="left:188px;top:168px;width:90px;height:44px;background:#6D28D9;">ÍπÄÎØºÏßÄ<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="ÍπÄÏÜ°Ìù¨" style="left:286px;top:168px;width:90px;height:44px;background:#DC2626;">ÍπÄÏÜ°Ìù¨<span class="sk-pos">Î¶¨Îìú Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ïù¥Ï±ÑÏùÄ" style="left:384px;top:168px;width:90px;height:44px;background:#DC2626;">Ïù¥Ï±ÑÏùÄ<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Í∂åÌòúÏòÅ" style="left:188px;top:220px;width:90px;height:44px;background:#CA8A04;">Í∂åÌòúÏòÅ<span class="sk-pos">Î¶¨Îìú Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="ÏÜêÏòàÏßÑ" style="left:286px;top:220px;width:90px;height:44px;background:#CA8A04;">ÏÜêÏòàÏßÑ<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Î•òÎèôÌôò" style="left:384px;top:220px;width:90px;height:44px;background:#9CA3AF;">Î•òÎèôÌôò</div>

            <!-- ====== ÌöåÏùòÏã§ (Ï¢åÏ∏° Ï§ëÍ∞Ñ) ====== -->
            <div class="sdg" style="left:16px;top:220px;width:140px;height:180px;">
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:13px;color:#90a4ae;font-weight:600;">ÌöåÏùòÏã§</div>
            </div>

            <!-- ====== ÌïòÎã® Îç∞Ïä§ÌÅ¨ (3√ó2) ====== -->
            <div class="sdg" style="left:180px;top:340px;width:300px;height:120px;"></div>
            <div class="sk" data-name="Ìï®ÏßÄÎØº" style="left:188px;top:348px;width:90px;height:44px;background:#CA8A04;">Ìï®ÏßÄÎØº<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="ÍπÄÏÜåÎùº" style="left:286px;top:348px;width:90px;height:44px;background:#CA8A04;">ÍπÄÏÜåÎùº<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="ÏµúÍ≤ΩÏÑ†" style="left:384px;top:348px;width:90px;height:44px;background:#CA8A04;">ÏµúÍ≤ΩÏÑ†<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="Ïù¥Ïû¨Ìõà" style="left:188px;top:400px;width:90px;height:44px;background:#DB2777;">Ïù¥Ïû¨Ìõà<span class="sk-pos">Î¶¨Îìú Îß§ÎãàÏ†Ä</span></div>
            <div class="sk" data-name="ÍπÄÎ≤îÏÑù" style="left:286px;top:400px;width:90px;height:44px;background:#DB2777;">ÍπÄÎ≤îÏÑù<span class="sk-pos">Îß§ÎãàÏ†Ä</span></div>
            <div class="sk empty" style="left:384px;top:400px;width:90px;height:20px;"></div>

            <!-- ====== ÌÉïÎπÑÏã§ ====== -->
            <div class="sdg" style="left:600px;top:160px;width:130px;height:90px;">
                <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:13px;color:#90a4ae;font-weight:600;">ÌÉïÎπÑÏã§</div>
            </div>
        </div>
    </div>
</div>

<!-- ===== ÏóÖÎ¨¥ Ïó∞ÎùΩÏ≤ò ===== -->
<div id="p-contacts" class="panel">
    <div class="sbar" style="justify-content:space-between">
        <div class="sbox" style="max-width:360px">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            <input type="text" id="ctSearch" placeholder="Ïù¥Î¶Ñ, ÏóÖÏ≤¥, Î≤àÌò∏Î°ú Í≤ÄÏÉâ..." oninput="renderContacts()">
        </div>
        <button class="btn btn-p" id="ctAddBtn" style="display:none" onclick="openCtForm()">+ Ïó∞ÎùΩÏ≤ò Ï∂îÍ∞Ä</button>
    </div>
    <div id="ctList"></div>
    <div id="ctEmpty" class="empty" style="display:none">
        <p>Îì±Î°ùÎêú ÏóÖÎ¨¥ Ïó∞ÎùΩÏ≤òÍ∞Ä ÏóÜÏäµÎãàÎã§.</p>
        <p style="margin-top:8px;font-size:12px;color:var(--text-sub)">Í¥ÄÎ¶¨Ïûê Î°úÍ∑∏Ïù∏ ÌõÑ Ïó∞ÎùΩÏ≤òÎ•º Ï∂îÍ∞ÄÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
    </div>
</div>

<!-- Ïó∞ÎùΩÏ≤ò Îì±Î°ù/ÏàòÏ†ï Î™®Îã¨ -->
<div class="ct-modal-overlay" id="ctModal">
    <div class="ct-modal">
        <div class="ct-modal-hd">
            <h3 id="ctFormTitle">Ïó∞ÎùΩÏ≤ò Ï∂îÍ∞Ä</h3>
            <button class="dcl" onclick="closeCtForm()">&times;</button>
        </div>
        <div class="ct-modal-bd">
            <div class="fg" style="gap:10px">
                <div class="fgi"><label>Î∂ÑÎ•ò *</label><select id="ctCat"><option value="">ÏÑ†ÌÉù</option><option>ÌöåÏÇ¨Î≤ïÏù∏Ìè∞</option><option>Í±∞ÎûòÏ≤ò</option><option>ÌòëÎ†•ÏóÖÏ≤¥</option><option>Î∞∞ÏÜ°/Î¨ºÎ•ò</option><option>Í∏àÏúµ/Î≥¥Ìóò</option><option>Í¥ÄÍ≥µÏÑú</option><option>IT/ÏãúÏä§ÌÖú</option><option>Í∏∞ÌÉÄ</option></select></div>
                <div class="fgi"><label>ÏóÖÏ≤¥/Í∏∞Í¥ÄÎ™Ö *</label><input id="ctCompany" placeholder="Ïòà: OOÎ¨ºÎ•ò ÎòêÎäî ÏÇ¨Ïö©ÏûêÎ™Ö"></div>
                <div class="fgi"><label>Îã¥ÎãπÏûêÎ™Ö</label><input id="ctName" placeholder="Ïòà: ÌôçÍ∏∏Îèô"></div>
                <div class="fgi"><label>Ïó∞ÎùΩÏ≤ò *</label><input id="ctPhone" placeholder="Ïòà: 02-1234-5678"></div>
                <div class="fgi"><label>Î≤ïÏù∏Ìè∞ Î≤àÌò∏</label><input id="ctCorpPhone" placeholder="Ïòà: 010-1234-5678 (Î≤ïÏù∏Ìè∞Ïù∏ Í≤ΩÏö∞)"></div>
                <div class="fgi"><label>Ïù¥Î©îÏùº</label><input id="ctEmail" placeholder="Ïòà: hong@company.com"></div>
                <div class="fgi full"><label>Î©îÎ™®</label><textarea id="ctMemo" placeholder="ÏóÖÎ¨¥ Í¥ÄÎ†® Ï∞∏Í≥†ÏÇ¨Ìï≠"></textarea></div>
            </div>
            <input type="hidden" id="ctEditId" value="">
            <div class="fa" style="margin-top:14px">
                <button class="btn btn-p" onclick="saveCt()">Ï†ÄÏû•</button>
                <button class="btn" onclick="closeCtForm()">Ï∑®ÏÜå</button>
                <button class="btn btn-d" id="ctDelBtn" style="display:none" onclick="delCt()">ÏÇ≠Ï†ú</button>
            </div>
        </div>
    </div>
</div>

<!-- ===== Í¥ÄÎ¶¨ ===== -->
<div id="p-admin" class="panel">
    <div id="admLock" class="adm-lock">
        <div class="adm-lock-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg></div>
        <h3>Í¥ÄÎ¶¨Ïûê Ïù∏Ï¶ù ÌïÑÏöî</h3>
        <p>ÏßÅÏõê Ï†ïÎ≥¥ ÏàòÏ†ï Î∞è Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨Îäî Í¥ÄÎ¶¨ÏûêÎßå Ï†ëÍ∑ºÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
        <div class="adm-form"><input type="password" id="admPw" placeholder="Í¥ÄÎ¶¨Ïûê ÎπÑÎ∞ÄÎ≤àÌò∏" onkeydown="if(event.key==='Enter')admLogin()"><button class="btn btn-p" onclick="admLogin()">Î°úÍ∑∏Ïù∏</button></div>
        <p style="margin-top:10px;font-size:11px;color:var(--text-dim)">Ï¥àÍ∏∞ ÎπÑÎ∞ÄÎ≤àÌò∏: admin</p>
    </div>
    <div id="admC" class="adm-c">
        <!-- ÏßÅÏõê Î™©Î°ù (ÏàòÏ†ïÏö©) -->
        <div class="adm-sec">
            <div class="adm-sec-t">ÏßÅÏõê Î™©Î°ù ¬∑ ÏàòÏ†ï</div>
            <input type="text" class="adm-emp-search" id="admEmpSearch" placeholder="Ïù¥Î¶Ñ ÎòêÎäî ÌåÄÏúºÎ°ú Í≤ÄÏÉâ..." oninput="renderAdmEmpList()">
            <div class="adm-emp-list" id="admEmpList"></div>
        </div>
        <!-- Í∞úÎ≥Ñ Îì±Î°ù -->
        <div class="adm-sec">
            <div class="adm-sec-t" id="fTitle">Ïã†Í∑ú ÏßÅÏõê Îì±Î°ù</div>
            <div class="photo-upload">
                <div class="photo-preview" id="fPhotoPreview" onclick="document.getElementById('fPhotoFile').click()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
                </div>
                <div class="photo-actions">
                    <button type="button" class="btn" onclick="document.getElementById('fPhotoFile').click()">ÏÇ¨ÏßÑ ÏÑ†ÌÉù</button>
                    <button type="button" class="btn" id="fPhotoDelBtn" style="display:none" onclick="clearPhoto()">ÏÇ¨ÏßÑ ÏÇ≠Ï†ú</button>
                </div>
                <input type="file" id="fPhotoFile" accept="image/*" style="display:none" onchange="handlePhoto(event)">
                <input type="hidden" id="fPhoto" value="">
            </div>
            <div class="fg">
                <div class="fgi"><label>ÏÑ±Î™Ö *</label><input id="fN"></div>
                <div class="fgi"><label>Î∂ÄÎ¨∏ *</label><select id="fD"><option value="">ÏÑ†ÌÉù</option><option>Í≤ΩÏòÅÏ¥ùÍ¥Ñ</option><option>Ïö©Ïù∏ÏÇ¨ÏóÖÏû•</option><option>ÏòÅÏóÖÎ≥∏Î∂Ä</option><option>Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä</option><option>Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä</option><option>Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ</option></select></div>
                <div class="fgi"><label>ÌåÄÎ™Ö</label><input id="fT" placeholder="Î≥∏Î∂Ä Ï¥ùÍ¥ÑÏûêÎäî ÎπÑÏõåÎëêÏÑ∏Ïöî"></div>
                <div class="fgi"><label>ÏßÅÏúÑ *</label><select id="fP"><option value="">ÏÑ†ÌÉù</option><option>ÎåÄÌëúÏù¥ÏÇ¨</option><option>Î∂ÄÏÇ¨Ïû•</option><option>ÏÉÅÎ¨¥Ïù¥ÏÇ¨</option><option>Ïù¥ÏÇ¨</option><option>Í≥µÏû•Ïû•</option><option>Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•</option><option>Î¶¨Îìú Îß§ÎãàÏ†Ä</option><option>ÏÑ†ÏûÑÏó∞Íµ¨Ïõê</option><option>Îß§ÎãàÏ†Ä</option><option>Ïó∞Íµ¨Ïõê</option></select></div>
                <div class="fgi"><label>Ïó∞ÎùΩÏ≤ò</label><input id="fPh" placeholder="010-0000-0000"></div>
                <div class="fgi"><label>Ïù¥Î©îÏùº</label><input id="fEm"></div>
                <div class="fgi"><label>ÎÇ¥ÏÑ†Î≤àÌò∏</label><input id="fEx"></div>
                <div class="fgi full"><label>Ï£ºÏöî ÏóÖÎ¨¥ (2Í∞ú)</label><div id="fPrWrap"><div class="task-rows" id="fPrRows"><input class="task-input" placeholder="Ï£ºÏóÖÎ¨¥ 1"><input class="task-input" placeholder="Ï£ºÏóÖÎ¨¥ 2"></div></div></div>
                <div class="fgi full"><label>Í∏∞ÌÉÄ ÏóÖÎ¨¥</label><div id="fScWrap"><div class="task-rows" id="fScRows"><input class="task-input" placeholder="Í∏∞ÌÉÄ ÏóÖÎ¨¥ 1"></div><button type="button" class="btn-task-add" onclick="addTaskRow('fScRows')">+ ÏóÖÎ¨¥ Ï∂îÍ∞Ä</button></div></div>
                <div class="fgi full"><label>Î©îÎ™®</label><textarea id="fMe"></textarea></div>
            </div>
            <div class="fa"><button class="btn btn-p" onclick="saveEmp()">Ï†ÄÏû•</button><button class="btn" onclick="resetF()">Ï¥àÍ∏∞Ìôî</button><button class="btn btn-d" id="delBtn" style="display:none" onclick="delEmp()">ÏÇ≠Ï†ú</button></div>
            <input type="hidden" id="editId" value="">
        </div>
        <!-- ÏóëÏÖÄ ÏùºÍ¥ÑÎì±Î°ù -->
        <div class="adm-sec">
            <div class="adm-sec-t">ÏóëÏÖÄ ÏùºÍ¥Ñ Îì±Î°ù</div>
            <p style="font-size:11px;color:var(--text-sub);margin-bottom:10px">ÏóëÏÖÄ ÌååÏùº(.xlsx)ÏùÑ ÏóÖÎ°úÎìúÌïòÎ©¥ Ïª¨ÎüºÏùÑ ÏûêÎèô Îß§ÌïëÌïòÏó¨ Îì±Î°ùÌï©ÎãàÎã§. ÌïÑÏàò: ÏÑ±Î™Ö, Î∂ÄÎ¨∏, ÌåÄÎ™Ö, ÏßÅÏúÑ(ÏßÅÏõå)</p>
            <div class="xdrop" id="xDrop" onclick="document.getElementById('xFile').click()"><div class="xt">ÏóëÏÖÄ ÌååÏùºÏùÑ ÎÅåÏñ¥Îã§ ÎÜìÍ±∞ÎÇò ÌÅ¥Î¶≠ÌïòÏó¨ ÏÑ†ÌÉù</div><p>.xlsx ÌòïÏãù ÏßÄÏõê</p><input type="file" id="xFile" accept=".xlsx,.xls" style="display:none" onchange="handleXL(event)"></div>
            <div id="xPrev"></div>
        </div>
        <!-- Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨ -->
        <div class="adm-sec">
            <div class="adm-sec-t">Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨</div>
            <p style="font-size:11px;color:var(--text-sub);margin-bottom:10px">Îç∞Ïù¥ÌÑ∞Îäî Î∏åÎùºÏö∞Ï†Ä LocalStorageÏóê Ï†ÄÏû•Îê©ÎãàÎã§.</p>
            <div class="dacts"><button class="btn" onclick="exportJSON()">JSON ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button><button class="btn" onclick="document.getElementById('impF').click()">JSON Í∞ÄÏ†∏Ïò§Í∏∞ (Ï†ÑÏ≤¥)</button><input type="file" id="impF" accept=".json" style="display:none" onchange="impJSON(event)"><button class="btn btn-p" onclick="pullSubmitData()">üì• Ï†úÏ∂ú Îç∞Ïù¥ÌÑ∞ Ï∑®Ìï©</button><button class="btn" onclick="document.getElementById('mergeF').click()">üìÅ JSON ÌååÏùº Î≥ëÌï©</button><input type="file" id="mergeF" accept=".json" style="display:none" onchange="mergeJSON(event)" multiple><button class="btn" style="background:#7c3aed;color:#fff;border-color:#7c3aed;" onclick="document.getElementById('photoImpF').click()">üì∑ ÏÇ¨ÏßÑ ÏùºÍ¥Ñ Îì±Î°ù</button><input type="file" id="photoImpF" accept=".json" style="display:none" onchange="importPhotoBatch(event)"><button class="btn" onclick="loadSample()">Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ Î≥µÏõê</button><button class="btn btn-d" onclick="clearAll()">Ï†ÑÏ≤¥ ÏÇ≠Ï†ú</button></div>
            <p style="font-size:11px;color:var(--text-dim);margin-top:6px">üí° <b>Ï†úÏ∂ú Îç∞Ïù¥ÌÑ∞ Ï∑®Ìï©</b>: ÏßÅÏõêÏ†ïÎ≥¥Ï†úÏ∂ú.htmlÏóêÏÑú Ï†ÄÏû•Îêú Îã¥ÎãπÏóÖÎ¨¥¬∑ÏÇ¨ÏßÑ Îç∞Ïù¥ÌÑ∞Î•º ÏûêÎèôÏúºÎ°ú Í∞ÄÏ†∏ÏôÄ Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞Ïóê Î≥ëÌï©Ìï©ÎãàÎã§.</p>
            <p style="font-size:11px;color:#7c3aed;margin-top:4px">üì∑ <b>ÏÇ¨ÏßÑ ÏùºÍ¥Ñ Îì±Î°ù</b>: photos_import.json ÌååÏùºÏùÑ ÏÑ†ÌÉùÌïòÎ©¥ Ïù¥Î¶Ñ+ÌåÄÏúºÎ°ú ÏûêÎèô Îß§Ïπ≠ÌïòÏó¨ ÏÇ¨ÏßÑÏùÑ ÏùºÍ¥Ñ Îì±Î°ùÌï©ÎãàÎã§.</p>
            <div id="mergeResult" style="margin-top:8px"></div>
        </div>
        <!-- ÎπÑÎ∞ÄÎ≤àÌò∏ -->
        <div class="adm-sec">
            <div class="adm-sec-t">Í¥ÄÎ¶¨Ïûê ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω</div>
            <div style="display:flex;gap:7px;align-items:flex-end"><div class="fgi"><label>ÏÉà ÎπÑÎ∞ÄÎ≤àÌò∏</label><input type="password" id="nPw"></div><button class="btn btn-p" onclick="chgPw()">Î≥ÄÍ≤Ω</button></div>
        </div>
    </div>
</div>

</div>
</div><!-- /main-area -->

<!-- Detail slide -->
<div class="dov" id="dOv" onclick="closeD()"></div>
<div class="dpn" id="dPn"><div class="dph"><h3>ÏßÅÏõê ÏÉÅÏÑ∏ Ï†ïÎ≥¥</h3><button class="dcl" onclick="closeD()">&times;</button></div><div class="dbd" id="dBd"></div><div class="dact" id="dAct"></div></div>

<div class="seat-popup" id="seatPopup"><button class="seat-popup-close" onclick="closeSeatPopup()">&times;</button><div id="seatPopupBody"></div></div>
<div class="toast" id="toast"></div>

<script>
const SK='nf_emp_v3',PK='nf_apw';
const gid=()=>'e'+Date.now().toString(36)+Math.random().toString(36).substr(2,5);
const DEFAULT_EMP=[
{id:'d001',name:'Ïù¥ÏäπÏö∞',division:'Í≤ΩÏòÅÏ¥ùÍ¥Ñ',team:'Í≤ΩÏòÅÏ¥ùÍ¥Ñ',position:'ÎåÄÌëúÏù¥ÏÇ¨',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Í≤ΩÏòÅÏ¥ùÍ¥Ñ','Ï†ÑÎûµÍ∏∞Ìöç'],secondaryTasks:[],memo:'',photo:'',sortOrder:0},
{id:'d002',name:'Ï†ïÏòÅÏû¨',division:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',team:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',position:'Î∂ÄÏÇ¨Ïû•',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Í≥µÏû•Ïö¥ÏòÅÏ¥ùÍ¥Ñ','Í∏∞Ïà†Ïó∞Íµ¨Ï¥ùÍ¥Ñ'],secondaryTasks:[],memo:'Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû• Í≤∏ÏûÑ',photo:'',sortOrder:1},
{id:'d003',name:'ÍπÄÏÑ±Ï§Ä',division:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',team:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',position:'Í≥µÏû•Ïû•',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÉùÏÇ∞Í¥ÄÎ¶¨','Í≥µÏû•Ïö¥ÏòÅ'],secondaryTasks:['ÌíàÏßàÍ¥ÄÎ¶¨'],memo:'',photo:'',sortOrder:2},
{id:'d004',name:'Ïù¥ÎÇòÎùº',division:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',team:'Í¥ÄÎ¶¨ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Í≥µÏû•Í¥ÄÎ¶¨','Ï¥ùÎ¨¥'],secondaryTasks:[],memo:'',photo:'',sortOrder:3},
{id:'d005',name:'Ïù¥Ïû¨ÎØº',division:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',team:'ÏÉùÏÇ∞/ÌíàÏßàÍ¥ÄÎ¶¨ÌåÄ',position:'Î¶¨Îìú Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÉùÏÇ∞Í¥ÄÎ¶¨','ÌíàÏßàÍ¥ÄÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:4},
{id:'d006',name:'ÍπÄÏú†ÏßÑ',division:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',team:'ÏÉùÏÇ∞/ÌíàÏßàÍ¥ÄÎ¶¨ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÌíàÏßàÍ≤ÄÏÇ¨','ÏÉùÏÇ∞Î≥¥Ï°∞'],secondaryTasks:[],memo:'',photo:'',sortOrder:5},
{id:'d007',name:'Ïã†Î™ÖÌù¨',division:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',team:'ÏÜåÏû¨ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå',position:'ÏÑ†ÏûÑÏó∞Íµ¨Ïõê',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÜåÏû¨Ïó∞Íµ¨','Ïã†ÏÜåÏû¨Í∞úÎ∞ú'],secondaryTasks:[],memo:'',photo:'',sortOrder:6},
{id:'d008',name:'Ïã¨ÌòúÏßÑ',division:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',team:'Í±¥ÏÑ§ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå',position:'Ïó∞Íµ¨Ïõê',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Í±¥ÏÑ§Í∏∞Ïà†Ïó∞Íµ¨','Ïã§Ìóò'],secondaryTasks:[],memo:'',photo:'',sortOrder:7},
{id:'d009',name:'ÍπÄÏÜåÏ†ï',division:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',team:'Í±¥ÏÑ§ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå',position:'Ïó∞Íµ¨Ïõê',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Í±¥ÏÑ§Í∏∞Ïà†Ïó∞Íµ¨','Îç∞Ïù¥ÌÑ∞Î∂ÑÏÑù'],secondaryTasks:[],memo:'',photo:'',sortOrder:8},
{id:'d010',name:'Ïù¥Ï†ïÌõà',division:'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',team:'Í±¥ÏÑ§ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå',position:'Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Í±¥ÏÑ§Í∏∞Ïà†Ïó∞Íµ¨','Í≥µÎ≤ïÍ∞úÎ∞ú'],secondaryTasks:[],memo:'',photo:'',sortOrder:9},
{id:'d011',name:'Ìô©Ïú§ÏÑ†',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏòÅÏóÖÎ≥∏Î∂Ä',position:'ÏÉÅÎ¨¥Ïù¥ÏÇ¨',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏòÅÏóÖÏ¥ùÍ¥Ñ','Í≥†Í∞ùÍ¥ÄÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:10},
{id:'d012',name:'ÌïúÏ§ÄÏóΩ',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑúÎπÑÏä§Ïö¥ÏòÅ1ÌåÄ',position:'Î¶¨Îìú Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑúÎπÑÏä§Ïö¥ÏòÅ','ÌåÄÍ¥ÄÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:11},
{id:'d013',name:'Ï°∞Ïû¨Ïó∞',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑúÎπÑÏä§Ïö¥ÏòÅ1ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑúÎπÑÏä§Ïö¥ÏòÅ'],secondaryTasks:[],memo:'',photo:'',sortOrder:12},
{id:'d014',name:'Ï†ïÏ†ïÌõà',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑúÎπÑÏä§Ïö¥ÏòÅ1ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑúÎπÑÏä§Ïö¥ÏòÅ','ÌòÑÏû•Í¥ÄÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:13},
{id:'d015',name:'ÍπÄÏÑ±ÎØº',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑúÎπÑÏä§Ïö¥ÏòÅ1ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑúÎπÑÏä§Ïö¥ÏòÅ'],secondaryTasks:[],memo:'',photo:'',sortOrder:14},
{id:'d016',name:'ÍπÄÍ≤ΩÎØ∏',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑúÎπÑÏä§Ïö¥ÏòÅ1ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑúÎπÑÏä§Ïö¥ÏòÅ'],secondaryTasks:[],memo:'',photo:'',sortOrder:15},
{id:'d017',name:'Í∂åÏ†ïÏïÑ',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑúÎπÑÏä§Ïö¥ÏòÅ2ÌåÄ',position:'Î¶¨Îìú Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑúÎπÑÏä§Ïö¥ÏòÅ','ÌåÄÍ¥ÄÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:17},
{id:'d018',name:'ÍπÄÏàòÏßÑ',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑúÎπÑÏä§Ïö¥ÏòÅ2ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑúÎπÑÏä§Ïö¥ÏòÅ'],secondaryTasks:[],memo:'',photo:'',sortOrder:18},
{id:'d019',name:'Ïù¥ÏßÄÏó∞',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑúÎπÑÏä§Ïö¥ÏòÅ2ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑúÎπÑÏä§Ïö¥ÏòÅ'],secondaryTasks:[],memo:'',photo:'',sortOrder:19},
{id:'d020',name:'Ï£ºÌòÑÏßÑ',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑúÎπÑÏä§Ïö¥ÏòÅ3ÌåÄ',position:'Î¶¨Îìú Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑúÎπÑÏä§Ïö¥ÏòÅ','ÌåÄÍ¥ÄÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:20},
{id:'d021',name:'ÏÜ°Î≥¥Îûå',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑúÎπÑÏä§Ïö¥ÏòÅ3ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑúÎπÑÏä§Ïö¥ÏòÅ'],secondaryTasks:[],memo:'',photo:'',sortOrder:21},
{id:'d022',name:'ÌïúÏù∏Í∑ú',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑ§Í≥Ñ/Ï†ÅÏÇ∞ÌåÄ',position:'Î¶¨Îìú Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑ§Í≥Ñ','Ï†ÅÏÇ∞'],secondaryTasks:['Í≤¨Ï†ÅÍ¥ÄÎ¶¨'],memo:'',photo:'',sortOrder:22},
{id:'d023',name:'Ï†ïÌÉúÏú§',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏÑ§Í≥Ñ/Ï†ÅÏÇ∞ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÏÑ§Í≥ÑÎ≥¥Ï°∞','Ï†ÅÏÇ∞'],secondaryTasks:[],memo:'',photo:'',sortOrder:23},
{id:'d024',name:'Ïù¥ÌïÑÏÑ†',division:'ÏòÅÏóÖÎ≥∏Î∂Ä',team:'ÏòÅÏóÖÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:[],secondaryTasks:[],memo:'',photo:'',sortOrder:24},
{id:'d025',name:'Î∞±Ï†ïÏÑù',division:'Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä',team:'Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä',position:'Ïù¥ÏÇ¨',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Í≤ΩÏòÅÍ¥ÄÎ¶¨Ï¥ùÍ¥Ñ','Ïû¨Î¨¥Í¥ÄÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:24},
{id:'d026',name:'Ïã†ÎÇòÏòÅ',division:'Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä',team:'Í≤ΩÏòÅÍ¥ÄÎ¶¨ÌåÄ',position:'Î¶¨Îìú Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Í≤ΩÏòÅÍ¥ÄÎ¶¨','Ïù∏ÏÇ¨Í¥ÄÎ¶¨'],secondaryTasks:['Í∏âÏó¨Í¥ÄÎ¶¨'],memo:'',photo:'',sortOrder:25},
{id:'d027',name:'Ï£ºÏú†ÏßÑ',division:'Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä',team:'Í≤ΩÏòÅÍ¥ÄÎ¶¨ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÌöåÍ≥Ñ','Í≤ΩÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:26},
{id:'d028',name:'ÍπÄÏú†Î¶º',division:'Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä',team:'Í≤ΩÏòÅÍ¥ÄÎ¶¨ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Ï¥ùÎ¨¥','Ïù∏ÏÇ¨ÏßÄÏõê'],secondaryTasks:[],memo:'',photo:'',sortOrder:27},
{id:'d029',name:'ÏµúÏòÅÏò•',division:'Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä',team:'Í≤ΩÏòÅÍ¥ÄÎ¶¨ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:[],secondaryTasks:[],memo:'',photo:'',sortOrder:28},
{id:'d030',name:'Ïù¥Ïû¨Ìõà',division:'Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä',team:'Í∑∏Î°úÏä§ÌåÄ',position:'Î¶¨Îìú Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Í∑∏Î°úÏä§Ï†ÑÎûµ','Îç∞Ïù¥ÌÑ∞Î∂ÑÏÑù'],secondaryTasks:[],memo:'',photo:'',sortOrder:28},
{id:'d031',name:'ÍπÄÎ≤îÏÑù',division:'Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä',team:'Í∑∏Î°úÏä§ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Í∑∏Î°úÏä§Ìï¥ÌÇπ','ÏÑ±Í≥ºÎ∂ÑÏÑù'],secondaryTasks:[],memo:'',photo:'',sortOrder:29},
{id:'d032',name:'Ïù¥ÎûÄ',division:'Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä',team:'Î∏åÎûúÎìúÏª§Î®∏Ïä§ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:[],secondaryTasks:[],memo:'',photo:'',sortOrder:30},
{id:'d033',name:'ÍπÄÎØºÏßÄ',division:'Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä',team:'Î∏åÎûúÎìúÏª§Î®∏Ïä§ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:[],secondaryTasks:[],memo:'',photo:'',sortOrder:31},
{id:'d034',name:'ÍπÄÏÜåÏó∞',division:'Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä',team:'ÎØ∏ÎîîÏñ¥Ïª§Î®∏Ïä§ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:[],secondaryTasks:[],memo:'',photo:'',sortOrder:32},
{id:'d035',name:'ÎÇ®Ïú§Ï†ï',division:'Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä',team:'ÎØ∏ÎîîÏñ¥Ïª§Î®∏Ïä§ÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:[],secondaryTasks:[],memo:'',photo:'',sortOrder:33},
{id:'d036',name:'ÍπÄÏ±ÑÏõê',division:'Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä',team:'Ìï¥Ïô∏ÏÇ¨ÏóÖÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:[],secondaryTasks:[],memo:'',photo:'',sortOrder:34},
{id:'d037',name:'Ï©êÌã∞Î¶¨',division:'Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä',team:'Ìï¥Ïô∏ÏÇ¨ÏóÖÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Ìï¥Ïô∏ÏòÅÏóÖ','Ìï¥Ïô∏Í±∞ÎûòÏ≤òÍ¥ÄÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:36},
{id:'d038',name:'ÍπÄÏÜ°Ìù¨',division:'Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä',team:'Î™®Ïó¨ÎùºÎîúÌåÄ',position:'Î¶¨Îìú Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Î™®Ïó¨ÎùºÎîúÏö¥ÏòÅ','ÌåÄÍ¥ÄÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:37},
{id:'d039',name:'Ïù¥Ï±ÑÏùÄ',division:'Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä',team:'Î™®Ïó¨ÎùºÎîúÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Î™®Ïó¨ÎùºÎîúÏö¥ÏòÅ'],secondaryTasks:[],memo:'',photo:'',sortOrder:38},
{id:'d040',name:'Í∂åÌòúÏòÅ',division:'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ',team:'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ',position:'Î¶¨Îìú Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['Î∏åÎûúÎìúÎßàÏºÄÌåÖ','ÌåÄÍ¥ÄÎ¶¨'],secondaryTasks:[],memo:'',photo:'',sortOrder:39},
{id:'d041',name:'Ìï®ÏßÄÎØº',division:'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ',team:'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÎßàÏºÄÌåÖÍ∏∞Ìöç','ÏΩòÌÖêÏ∏†Ï†úÏûë'],secondaryTasks:[],memo:'',photo:'',sortOrder:40},
{id:'d042',name:'ÍπÄÏÜåÎùº',division:'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ',team:'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÎßàÏºÄÌåÖ','SNSÏö¥ÏòÅ'],secondaryTasks:[],memo:'',photo:'',sortOrder:41},
{id:'d043',name:'ÏÜêÏòàÏßÑ',division:'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ',team:'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÎßàÏºÄÌåÖ','ÎîîÏûêÏù∏'],secondaryTasks:[],memo:'',photo:'',sortOrder:42},
{id:'d044',name:'ÏµúÍ≤ΩÏÑ†',division:'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ',team:'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ',position:'Îß§ÎãàÏ†Ä',phone:'',email:'',joinDate:'',extension:'',primaryTasks:['ÎßàÏºÄÌåÖ'],secondaryTasks:[],memo:'',photo:'',sortOrder:43}
];
const G=()=>{try{const d=JSON.parse(localStorage.getItem(SK));if(d&&d.length)return d;localStorage.setItem(SK,JSON.stringify(DEFAULT_EMP));return DEFAULT_EMP.map(e=>({...e}));}catch(e){localStorage.setItem(SK,JSON.stringify(DEFAULT_EMP));return DEFAULT_EMP.map(e=>({...e}));}};
const S=d=>localStorage.setItem(SK,JSON.stringify(d));
const gPw=()=>localStorage.getItem(PK)||'admin';

// Tab (nav-btn + sidebar)
const BREADCRUMB_MAP={directory:'ÏßÅÏõê Î™©Î°ù',orgchart:'Ï°∞ÏßÅÎèÑ',seatmap:'ÏûêÎ¶¨Î∞∞ÏπòÎèÑ',contacts:'ÏóÖÎ¨¥ Ïó∞ÎùΩÏ≤ò',admin:'ÏßÅÏõê Í¥ÄÎ¶¨'};
function switchPanel(p){
    document.querySelectorAll('.nav-btn').forEach(x=>x.classList.remove('on'));
    document.querySelectorAll('.sb-item').forEach(x=>x.classList.remove('on'));
    document.querySelectorAll('.panel').forEach(x=>x.classList.remove('on'));
    // activate nav-btn
    const nb=document.querySelector('.nav-btn[data-p="'+p+'"]');if(nb)nb.classList.add('on');
    // activate sidebar
    const sb=document.querySelector('.sb-item[data-p="'+p+'"]');if(sb)sb.classList.add('on');
    document.getElementById('p-'+p).classList.add('on');
    // breadcrumb
    const bc=document.getElementById('breadcrumbTitle');if(bc)bc.textContent=BREADCRUMB_MAP[p]||p;
    if(p==='orgchart')renderOrg();
    if(p==='directory')refresh();
    if(p==='contacts')renderContacts();
}
document.querySelectorAll('.nav-btn').forEach(b=>b.addEventListener('click',()=>switchPanel(b.dataset.p)));
document.querySelectorAll('.sb-item[data-p]').forEach(b=>b.addEventListener('click',()=>switchPanel(b.dataset.p)));

// Filters
let F={div:'',team:'',pos:'',q:''},SS={k:'sortOrder',a:true};

function togDD(id){
    const d=document.getElementById(id),l=d.querySelector('.fdd-list'),b=d.querySelector('.fdd-btn'),o=l.classList.contains('show');
    closeDD(); if(!o){l.classList.add('show');b.classList.add('open');}
}
function closeDD(){document.querySelectorAll('.fdd-list').forEach(l=>l.classList.remove('show'));document.querySelectorAll('.fdd-btn').forEach(b=>b.classList.remove('open'));}
document.addEventListener('click',e=>{if(!e.target.closest('.fdd'))closeDD();});

function buildDD(){
    const e=G(),divs=[...new Set(e.map(x=>x.division))].filter(Boolean).sort(),
    // teams: if division selected, show only teams in that division
    filteredForTeam=F.div?e.filter(x=>x.division===F.div):e,
    teams=[...new Set(filteredForTeam.map(x=>x.team))].filter(Boolean).sort(),
    po=['ÎåÄÌëúÏù¥ÏÇ¨','Î∂ÄÏÇ¨Ïû•','ÏÉÅÎ¨¥Ïù¥ÏÇ¨','Ïù¥ÏÇ¨','Í≥µÏû•Ïû•','Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•','Î¶¨Îìú Îß§ÎãàÏ†Ä','ÏÑ†ÏûÑÏó∞Íµ¨Ïõê','Îß§ÎãàÏ†Ä','Ïó∞Íµ¨Ïõê'],
    poss=[...new Set(e.map(x=>x.position))].filter(Boolean).sort((a,b)=>(po.indexOf(a)<0?99:po.indexOf(a))-(po.indexOf(b)<0?99:po.indexOf(b)));
    const cnt=(arr,k)=>{const m={};arr.forEach(x=>m[x[k]]=(m[x[k]]||0)+1);return m;};
    const cd=cnt(e,'division'),ct=cnt(filteredForTeam,'team'),cp=cnt(e,'position');

    // Build division dropdown
    let dh=`<div class="fdd-item${!F.div?' on':''}" data-v="">Ï†ÑÏ≤¥ Î∂ÄÎ¨∏ <span class="fdd-cnt">${e.length}</span></div><div class="fdd-divider"></div>`;
    divs.forEach(d=>{dh+=`<div class="fdd-item${F.div===d?' on':''}" data-v="${d}">${d} <span class="fdd-cnt">${cd[d]||0}</span></div>`;});
    document.getElementById('lstDiv').innerHTML=dh;

    // Build team dropdown (filtered by division)
    let th=`<div class="fdd-item${!F.team?' on':''}" data-v="">Ï†ÑÏ≤¥ ÌåÄ <span class="fdd-cnt">${filteredForTeam.length}</span></div><div class="fdd-divider"></div>`;
    teams.forEach(t=>{th+=`<div class="fdd-item${F.team===t?' on':''}" data-v="${t}">${t} <span class="fdd-cnt">${ct[t]||0}</span></div>`;});
    document.getElementById('lstTeam').innerHTML=th;

    // Build position dropdown
    let ph=`<div class="fdd-item${!F.pos?' on':''}" data-v="">Ï†ÑÏ≤¥ ÏßÅÏúÑ <span class="fdd-cnt">${e.length}</span></div><div class="fdd-divider"></div>`;
    poss.forEach(p=>{ph+=`<div class="fdd-item${F.pos===p?' on':''}" data-v="${p}">${p} <span class="fdd-cnt">${cp[p]||0}</span></div>`;});
    document.getElementById('lstPos').innerHTML=ph;

    // Event: division
    document.getElementById('lstDiv').querySelectorAll('.fdd-item').forEach(el=>el.onclick=()=>{
        F.div=el.dataset.v;
        F.team=''; // reset team when division changes
        document.getElementById('lblDiv').textContent=el.dataset.v||'Ï†ÑÏ≤¥ Î∂ÄÎ¨∏';
        document.getElementById('lblTeam').textContent='Ï†ÑÏ≤¥ ÌåÄ';
        // update button style
        document.querySelector('#ddDiv .fdd-btn').classList.toggle('filtered',!!el.dataset.v);
        document.querySelector('#ddTeam .fdd-btn').classList.remove('filtered');
        closeDD();refresh();
    });
    // Event: team
    document.getElementById('lstTeam').querySelectorAll('.fdd-item').forEach(el=>el.onclick=()=>{
        F.team=el.dataset.v;
        document.getElementById('lblTeam').textContent=el.dataset.v||'Ï†ÑÏ≤¥ ÌåÄ';
        document.querySelector('#ddTeam .fdd-btn').classList.toggle('filtered',!!el.dataset.v);
        closeDD();refresh();
    });
    // Event: position
    document.getElementById('lstPos').querySelectorAll('.fdd-item').forEach(el=>el.onclick=()=>{
        F.pos=el.dataset.v;
        document.getElementById('lblPos').textContent=el.dataset.v||'Ï†ÑÏ≤¥ ÏßÅÏúÑ';
        document.querySelector('#ddPos .fdd-btn').classList.toggle('filtered',!!el.dataset.v);
        closeDD();refresh();
    });

    // Sync button filtered state
    document.querySelector('#ddDiv .fdd-btn').classList.toggle('filtered',!!F.div);
    document.querySelector('#ddTeam .fdd-btn').classList.toggle('filtered',!!F.team);
    document.querySelector('#ddPos .fdd-btn').classList.toggle('filtered',!!F.pos);
}

// Main search + directory
document.getElementById('mainSearch').addEventListener('input',e=>{F.q=e.target.value.trim().toLowerCase();refresh();});
function resetFilters(){F.div='';F.team='';F.pos='';F.q='';document.getElementById('mainSearch').value='';document.getElementById('lblDiv').textContent='Ï†ÑÏ≤¥ Î∂ÄÎ¨∏';document.getElementById('lblTeam').textContent='Ï†ÑÏ≤¥ ÌåÄ';document.getElementById('lblPos').textContent='Ï†ÑÏ≤¥ ÏßÅÏúÑ';document.querySelectorAll('.fdd-btn').forEach(b=>b.classList.remove('filtered'));refresh();}

// Í∏∞Î≥∏Ï†ïÎ†¨: Ï°∞ÏßÅÎèÑ(TEAM_MEM_ORDER) ÏàòÎèô ÏàúÏÑúÏôÄ ÎèôÏùº
const PO=['ÎåÄÌëúÏù¥ÏÇ¨','Î∂ÄÏÇ¨Ïû•','ÏÉÅÎ¨¥Ïù¥ÏÇ¨','Ïù¥ÏÇ¨','Í≥µÏû•Ïû•','Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•','Î¶¨Îìú Îß§ÎãàÏ†Ä','ÏÑ†ÏûÑÏó∞Íµ¨Ïõê','Îß§ÎãàÏ†Ä','Ïó∞Íµ¨Ïõê'];
const DO=['Í≤ΩÏòÅÏ¥ùÍ¥Ñ','Ïö©Ïù∏ÏÇ¨ÏóÖÏû•','ÏòÅÏóÖÎ≥∏Î∂Ä','Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä','Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä','Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ'];
const TO=['Í≤ΩÏòÅÏ¥ùÍ¥Ñ','Ïö©Ïù∏ÏÇ¨ÏóÖÏû•','Í¥ÄÎ¶¨ÌåÄ','ÏÉùÏÇ∞/ÌíàÏßàÍ¥ÄÎ¶¨ÌåÄ','ÏÜåÏû¨ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå','Í±¥ÏÑ§ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå','ÏòÅÏóÖÎ≥∏Î∂Ä','ÏÑúÎπÑÏä§Ïö¥ÏòÅ1ÌåÄ','ÏÑúÎπÑÏä§Ïö¥ÏòÅ2ÌåÄ','ÏÑúÎπÑÏä§Ïö¥ÏòÅ3ÌåÄ','ÏÑ§Í≥Ñ/Ï†ÅÏÇ∞ÌåÄ','ÏòÅÏóÖÌåÄ','Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä','Í≤ΩÏòÅÍ¥ÄÎ¶¨ÌåÄ','Í∑∏Î°úÏä§ÌåÄ','Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä','Î∏åÎûúÎìúÏª§Î®∏Ïä§ÌåÄ','ÎØ∏ÎîîÏñ¥Ïª§Î®∏Ïä§ÌåÄ','Ìï¥Ïô∏ÏÇ¨ÏóÖÌåÄ','Î™®Ïó¨ÎùºÎîúÌåÄ','Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ'];
// ÌåÄ ÎÇ¥ Î©§Î≤Ñ ÏàòÎèô Ï†ïÎ†¨ Îßµ (Ï°∞ÏßÅÎèÑÏôÄ ÎèôÏùº)
const TEAM_MEM_ORDER={
    'Í≤ΩÏòÅÏ¥ùÍ¥Ñ':['Ïù¥ÏäπÏö∞'],
    'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•':['Ï†ïÏòÅÏû¨','ÍπÄÏÑ±Ï§Ä'],
    'Í¥ÄÎ¶¨ÌåÄ':['Ïù¥ÎÇòÎùº'],
    'ÏÉùÏÇ∞/ÌíàÏßàÍ¥ÄÎ¶¨ÌåÄ':['Ïù¥Ïû¨ÎØº','ÍπÄÏú†ÏßÑ'],
    'ÏÜåÏû¨ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå':['Ïã†Î™ÖÌù¨'],
    'Í±¥ÏÑ§ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå':['Ïù¥Ï†ïÌõà','Ïã¨ÌòúÏßÑ','ÍπÄÏÜåÏ†ï'],
    'ÏòÅÏóÖÎ≥∏Î∂Ä':['Ìô©Ïú§ÏÑ†'],
    'ÏÑúÎπÑÏä§Ïö¥ÏòÅ1ÌåÄ':['ÌïúÏ§ÄÏóΩ','Ï°∞Ïû¨Ïó∞','Ï†ïÏ†ïÌõà','ÍπÄÏÑ±ÎØº','ÍπÄÍ≤ΩÎØ∏'],
    'ÏÑúÎπÑÏä§Ïö¥ÏòÅ2ÌåÄ':['Í∂åÏ†ïÏïÑ','ÍπÄÏàòÏßÑ','Ïù¥ÏßÄÏó∞'],
    'ÏÑúÎπÑÏä§Ïö¥ÏòÅ3ÌåÄ':['Ï£ºÌòÑÏßÑ','ÏÜ°Î≥¥Îûå'],
    'ÏÑ§Í≥Ñ/Ï†ÅÏÇ∞ÌåÄ':['ÌïúÏù∏Í∑ú','Ï†ïÌÉúÏú§'],
    'ÏòÅÏóÖÌåÄ':['Ïù¥ÌïÑÏÑ†'],
    'Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä':['Î∞±Ï†ïÏÑù'],
    'Í≤ΩÏòÅÍ¥ÄÎ¶¨ÌåÄ':['Ïã†ÎÇòÏòÅ','Ï£ºÏú†ÏßÑ','ÏµúÏòÅÏò•','ÍπÄÏú†Î¶º'],
    'Í∑∏Î°úÏä§ÌåÄ':['Ïù¥Ïû¨Ìõà','ÍπÄÎ≤îÏÑù'],
    'Î∏åÎûúÎìúÏª§Î®∏Ïä§ÌåÄ':['Ïù¥ÎûÄ','ÍπÄÎØºÏßÄ'],
    'ÎØ∏ÎîîÏñ¥Ïª§Î®∏Ïä§ÌåÄ':['ÌóàÏßÄÏùÄ','ÍπÄÏÜåÏó∞','ÎÇ®Ïú§Ï†ï'],
    'Ìï¥Ïô∏ÏÇ¨ÏóÖÌåÄ':['ÍπÄÏ±ÑÏõê','Ï©êÌã∞Î¶¨'],
    'Î™®Ïó¨ÎùºÎîúÌåÄ':['ÍπÄÏÜ°Ìù¨','Ïù¥Ï±ÑÏùÄ'],
    'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ':['Í∂åÌòúÏòÅ','Ìï®ÏßÄÎØº','ÍπÄÏÜåÎùº','ÏÜêÏòàÏßÑ','ÏµúÍ≤ΩÏÑ†']
};
function teamMemOrder(name,team){
    const mo=TEAM_MEM_ORDER[team];
    if(mo){const idx=mo.indexOf(name);return idx<0?999:idx;}
    return 999;
}
// Î≥∏Î∂Ä Ï¥ùÍ¥Ñ ÏßÅÏúÑ (Î∂ÄÎ¨∏ Îß® ÏúÑÏóê Í≥†Ï†ï)
const HEAD_POS=['Î∂ÄÏÇ¨Ïû•','ÏÉÅÎ¨¥Ïù¥ÏÇ¨','Ïù¥ÏÇ¨','Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•'];
function isHeadOf(e){return (HEAD_POS.includes(e.position)||(e.position||'').includes('Ïó∞Íµ¨ÏÜåÏû•'))&&(e.team===e.division||!e.team);}
function defaultSort(a,b){
    if(a.position==='ÎåÄÌëúÏù¥ÏÇ¨'&&b.position!=='ÎåÄÌëúÏù¥ÏÇ¨')return -1;
    if(b.position==='ÎåÄÌëúÏù¥ÏÇ¨'&&a.position!=='ÎåÄÌëúÏù¥ÏÇ¨')return 1;
    const da=DO.indexOf(a.division)<0?99:DO.indexOf(a.division);
    const db=DO.indexOf(b.division)<0?99:DO.indexOf(b.division);
    if(da!==db)return da-db;
    // Í∞ôÏùÄ Î∂ÄÎ¨∏ ÎÇ¥: Î≥∏Î∂Ä Ï¥ùÍ¥Ñ(ÏÉÅÎ¨¥Ïù¥ÏÇ¨ Îì±)ÏùÑ Îß® ÏúÑÎ°ú
    const ha=isHeadOf(a)?0:1, hb=isHeadOf(b)?0:1;
    if(ha!==hb)return ha-hb;
    // Ï¥ùÍ¥ÑÎÅºÎ¶¨Îäî ÏßÅÏúÑÏàú
    if(ha===0&&hb===0){
        const ai=PO.indexOf(a.position),bi=PO.indexOf(b.position);
        const pa=ai<0?99:ai,pb=bi<0?99:bi;
        if(pa!==pb)return pa-pb;
        return (a.name||'').localeCompare(b.name||'','ko');
    }
    // ÏùºÎ∞ò ÏßÅÏõê: ÌåÄ ÏàúÏÑú
    const ta=TO.indexOf(a.team)<0?99:TO.indexOf(a.team);
    const tb=TO.indexOf(b.team)<0?99:TO.indexOf(b.team);
    if(ta!==tb)return ta-tb;
    // Ï°∞ÏßÅÎèÑ ÏàòÎèô ÏàúÏÑú Ï†ÅÏö©
    const ma=teamMemOrder(a.name,a.team);
    const mb=teamMemOrder(b.name,b.team);
    if(ma!==999||mb!==999) return ma-mb;
    // ÏàòÎèô ÏàúÏÑúÏóê ÏóÜÏúºÎ©¥ ÏßÅÏúÑÏàú ‚Üí Í∞ÄÎÇòÎã§Ïàú Ìè¥Î∞±
    const ai=PO.indexOf(a.position),bi=PO.indexOf(b.position);
    const pa=ai<0?99:ai, pb=bi<0?99:bi;
    if(pa!==pb)return pa-pb;
    return (a.name||'').localeCompare(b.name||'','ko');
}

function refresh(){
    const all=G(); buildDD();
    let list=all.filter(e=>{
        if(F.div&&e.division!==F.div)return false;
        if(F.team&&e.team!==F.team)return false;
        if(F.pos&&e.position!==F.pos)return false;
        if(F.q){const s=[e.name,e.position,...(e.primaryTasks||[]),...(e.secondaryTasks||[])].join(' ').toLowerCase();if(!s.includes(F.q))return false;}
        return true;
    });
    // Sort
    if(SS.k==='sortOrder'){
        list.sort(defaultSort);
    }else{
        list.sort((a,b)=>{let va=a[SS.k]||'',vb=b[SS.k]||'';if(SS.k==='position'){va=PO.indexOf(va)<0?99:PO.indexOf(va);vb=PO.indexOf(vb)<0?99:PO.indexOf(vb);}if(typeof va==='string'){va=va.toLowerCase();vb=(vb||'').toLowerCase();}return va<vb?SS.a?-1:1:va>vb?SS.a?1:-1:0;});
    }

    // Stats - Ï†úÍ±∞Îê®
    const hasFilter=F.div||F.team||F.pos||F.q;
    document.getElementById('statsBar').innerHTML='';
    document.getElementById('btnReset').style.display=hasFilter?'inline-flex':'none';

    // check if query is task-related
    const isTaskSearch=F.q&&all.some(e=>[...(e.primaryTasks||[]),...(e.secondaryTasks||[])].some(t=>t.toLowerCase().includes(F.q)));

    // ÏïÑÏΩîÎîîÏñ∏ Î∑∞ Î†åÎçî
    renderAccView(list);
    // Ï°∞ÏßÅÌä∏Î¶¨ Î∑∞ Î†åÎçî
    renderOrgTreeNav(list);

    const tb=document.getElementById('tbody'),em=document.getElementById('tbEmpty');
    if(!list.length){tb.innerHTML='';em.style.display='block';em.querySelector('p').textContent=all.length?'Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.':'Îì±Î°ùÎêú ÏßÅÏõêÏù¥ ÏóÜÏäµÎãàÎã§.';return;}
    em.style.display='none';
    tb.innerHTML=list.map(e=>{
        const pc=['ÎåÄÌëúÏù¥ÏÇ¨','Î∂ÄÏÇ¨Ïû•','ÏÉÅÎ¨¥Ïù¥ÏÇ¨','Ïù¥ÏÇ¨'].includes(e.position)||(e.position||'').includes('Ïó∞Íµ¨ÏÜåÏû•')?'cp-e':['Î¶¨Îìú Îß§ÎãàÏ†Ä','Í≥µÏû•Ïû•','ÏÑ†ÏûÑÏó∞Íµ¨Ïõê'].includes(e.position)?'cp-l':'cp-m';
        const ini=e.name?e.name[0]:'?';
        const priTasks=(e.primaryTasks||[]).filter(Boolean).slice(0,2);
        // match badge + matched tasks for search
        let matchBadge='',taskHtml='';
        if(isTaskSearch&&F.q){
            const allTasks=[...(e.primaryTasks||[]),...(e.secondaryTasks||[])].filter(Boolean);
            const matchedTasks=allTasks.filter(t=>t.toLowerCase().includes(F.q));
            matchBadge=matchedTasks.map(t=>`<span class="tg-match">${t}</span>`).join('');
        }
        taskHtml=priTasks.map(t=>`<span>${t}</span>`).join('');
        return `<tr data-id="${e.id}"><td><div class="cn"><div class="av">${e.photo?`<img src="${e.photo}">`:ini}</div>${e.name}${matchBadge}</div></td><td>${e.division||'-'}</td><td>${e.team||'-'}</td><td><span class="cp ${pc}">${e.position||'-'}</span></td><td>${e.phone||'-'}</td><td><div class="tg">${taskHtml}</div></td></tr>`;
    }).join('');
    tb.querySelectorAll('tr').forEach(tr=>tr.onclick=()=>showD(tr.dataset.id));
}

let _orgTreeData=[];
let _orgTreeSelected=null;
function renderOrgTreeNav(list){
    _orgTreeData=list;
    const nav=document.getElementById('orgTreeNav');if(!nav)return;
    // Î∂ÄÎ¨∏Î≥Ñ ‚Üí ÌåÄÎ≥Ñ Íµ¨Ï°∞
    const divMap={};
    list.forEach(e=>{
        const d=e.division||'Í∏∞ÌÉÄ';
        if(!divMap[d])divMap[d]=[];
        divMap[d].push(e);
    });
    const divKeys=Object.keys(divMap).sort((a,b)=>{
        const ai=DIV_ORDER.indexOf(a),bi=DIV_ORDER.indexOf(b);
        return(ai<0?99:ai)-(bi<0?99:bi);
    });
    let h='<div class="orgtree-nav-title">Ï°∞ÏßÅÎèÑ</div>';
    divKeys.forEach(div=>{
        const members=divMap[div];
        const tmMap={};
        members.forEach(m=>{
            const t=(HEAD_POS.includes(m.position)&&(m.team===div||!m.team))?div:(m.team||div);
            if(!tmMap[t])tmMap[t]=[];tmMap[t].push(m);
        });
        const tmKeys=Object.keys(tmMap).sort((a,b)=>{
            if(a===div&&b!==div)return -1;if(b===div&&a!==div)return 1;
            const ai=TO.indexOf(a),bi=TO.indexOf(b);return(ai<0?99:ai)-(bi<0?99:bi);
        });
        h+=`<div class="orgtree-div">`;
        h+=`<div class="orgtree-div-hd" onclick="toggleOrgTreeDiv(this)">`;
        h+=`<svg class="ot-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>`;
        h+=`${div} <span class="ot-cnt">${members.length}</span>`;
        h+=`</div>`;
        h+=`<div class="orgtree-div-body">`;
        tmKeys.forEach(tm=>{
            if(tm===div && tmKeys.length>1){
                // Î≥∏Î∂Ä Ï¥ùÍ¥Ñ - Î≥ÑÎèÑ Ìï≠Î™©
                const cnt=tmMap[tm].length;
                if(cnt>0){
                    h+=`<div class="orgtree-tm${_orgTreeSelected===div+'__'+tm?' on':''}" onclick="selectOrgTreeTeam('${div}','${tm}')" data-otkey="${div}__${tm}">`;
                    h+=`<span class="ot-dot" style="background:${getTC(tm)}"></span>Ï¥ùÍ¥Ñ <span class="ot-tm-cnt">${cnt}</span>`;
                    h+=`</div>`;
                }
            } else {
                const cnt=tmMap[tm].length;
                h+=`<div class="orgtree-tm${_orgTreeSelected===div+'__'+tm?' on':''}" onclick="selectOrgTreeTeam('${div}','${tm}')" data-otkey="${div}__${tm}">`;
                h+=`<span class="ot-dot" style="background:${getTC(tm)}"></span>${tm} <span class="ot-tm-cnt">${cnt}</span>`;
                h+=`</div>`;
            }
        });
        h+=`</div></div>`;
    });
    nav.innerHTML=h;
    // Í≤ÄÏÉâ Ï§ëÏù¥Î©¥ Ï†ÑÏ≤¥ Í≤ÄÏÉâ Í≤∞Í≥ºÎ•º Ïò§Î•∏Ï™ΩÏóê ÌëúÏãú
    if(F.q){
        _orgTreeSelected=null;
        nav.querySelectorAll('.orgtree-tm').forEach(el=>el.classList.remove('on'));
        renderOrgTreeSearchResults(list);
        return;
    }
    // ÏÑ†ÌÉùÎêú ÌåÄÏù¥ ÏûàÏúºÎ©¥ Îã§Ïãú Î†åÎçî
    if(_orgTreeSelected) renderOrgTreeMembers();
    else document.getElementById('orgTreeContent').innerHTML=`<div class="orgtree-empty"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg><span>ÏôºÏ™Ω Ï°∞ÏßÅÎèÑÏóêÏÑú ÌåÄÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</span></div>`;
}
function renderOrgTreeSearchResults(list){
    const content=document.getElementById('orgTreeContent');if(!content)return;
    if(!list.length){
        content.innerHTML=`<div class="orgtree-empty"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg><span>Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§</span></div>`;
        return;
    }
    let h=`<div class="orgtree-team-hd"><div class="orgtree-team-nm"><span class="ot-color" style="background:var(--accent)"></span>Í≤ÄÏÉâ Í≤∞Í≥º</div><div class="orgtree-team-cnt">${list.length}Î™Ö</div></div>`;
    h+=`<div class="orgtree-members">`;
    list.forEach(m=>{
        const ini=m.name?m.name[0]:'?';
        const tc=getTC(m.team);
        const pc=['ÎåÄÌëúÏù¥ÏÇ¨','Î∂ÄÏÇ¨Ïû•','ÏÉÅÎ¨¥Ïù¥ÏÇ¨','Ïù¥ÏÇ¨'].includes(m.position)||(m.position||'').includes('Ïó∞Íµ¨ÏÜåÏû•')?'cp-e':['Î¶¨Îìú Îß§ÎãàÏ†Ä','Í≥µÏû•Ïû•','ÏÑ†ÏûÑÏó∞Íµ¨Ïõê'].includes(m.position)?'cp-l':'cp-m';
        const tasks=(m.primaryTasks||[]).filter(Boolean).slice(0,3).join(', ');
        h+=`<div class="orgtree-mem" style="border-top:3px solid ${tc}" onclick="showD('${m.id}')">`;
        h+=`<div class="av" style="background:${tc}">${m.photo?`<img src="${m.photo}">`:ini}</div>`;
        h+=`<div class="orgtree-mem-info"><div class="orgtree-mem-top"><span class="orgtree-mem-nm">${m.name}</span><span class="orgtree-mem-pos cp ${pc}">${m.position||''}</span></div>`;
        h+=`<div class="orgtree-mem-tasks" style="color:var(--text-dim)">${m.team||''}</div>`;
        if(tasks) h+=`<div class="orgtree-mem-tasks">${tasks}</div>`;
        if(m.phone) h+=`<span class="orgtree-mem-phone">${m.phone}</span>`;
        h+=`</div>`;
        h+=`</div>`;
    });
    h+=`</div>`;
    content.innerHTML=h;
}
function toggleOrgTreeDiv(el){
    el.classList.toggle('collapsed');
    el.nextElementSibling.classList.toggle('collapsed');
}
function selectOrgTreeTeam(div,tm){
    _orgTreeSelected=div+'__'+tm;
    // Î™®Îì† ÌåÄ Î≤ÑÌäº off
    document.querySelectorAll('.orgtree-tm').forEach(el=>el.classList.remove('on'));
    const sel=document.querySelector(`.orgtree-tm[data-otkey="${div}__${tm}"]`);
    if(sel) sel.classList.add('on');
    renderOrgTreeMembers();
}
function renderOrgTreeMembers(){
    const content=document.getElementById('orgTreeContent');if(!content)return;
    if(!_orgTreeSelected){
        content.innerHTML=`<div class="orgtree-empty"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg><span>ÏôºÏ™Ω Ï°∞ÏßÅÎèÑÏóêÏÑú ÌåÄÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</span></div>`;
        return;
    }
    const [div,tm]=_orgTreeSelected.split('__');
    // Ìï¥Îãπ Î∂ÄÎ¨∏+ÌåÄ Î©§Î≤Ñ ÌïÑÌÑ∞
    const members=_orgTreeData.filter(e=>{
        const d=e.division||'Í∏∞ÌÉÄ';
        const t=(HEAD_POS.includes(e.position)&&(e.team===d||!e.team))?d:(e.team||d);
        return d===div && t===tm;
    });
    members.sort((a,b)=>{
        const ma=teamMemOrder(a.name,tm),mb=teamMemOrder(b.name,tm);
        if(ma!==999||mb!==999) return ma-mb;
        const al=PO.indexOf(a.position)<0?99:PO.indexOf(a.position);
        const bl=PO.indexOf(b.position)<0?99:PO.indexOf(b.position);
        return al-bl||(a.name||'').localeCompare(b.name||'','ko');
    });
    const tc=getTC(tm);
    const label=(tm===div&&members.every(m=>HEAD_POS.includes(m.position)))?div+' Ï¥ùÍ¥Ñ':tm;
    let h=`<div class="orgtree-team-hd"><div class="orgtree-team-nm"><span class="ot-color" style="background:${tc}"></span>${label}</div><div class="orgtree-team-cnt">${members.length}Î™Ö</div></div>`;
    h+=`<div class="orgtree-members">`;
    members.forEach(m=>{
        const ini=m.name?m.name[0]:'?';
        const pc=['ÎåÄÌëúÏù¥ÏÇ¨','Î∂ÄÏÇ¨Ïû•','ÏÉÅÎ¨¥Ïù¥ÏÇ¨','Ïù¥ÏÇ¨'].includes(m.position)||(m.position||'').includes('Ïó∞Íµ¨ÏÜåÏû•')?'cp-e':['Î¶¨Îìú Îß§ÎãàÏ†Ä','Í≥µÏû•Ïû•','ÏÑ†ÏûÑÏó∞Íµ¨Ïõê'].includes(m.position)?'cp-l':'cp-m';
        const tasks=(m.primaryTasks||[]).filter(Boolean).slice(0,3).join(', ');
        h+=`<div class="orgtree-mem" style="border-top:3px solid ${tc}" onclick="showD('${m.id}')">`;
        h+=`<div class="av" style="background:${tc}">${m.photo?`<img src="${m.photo}">`:ini}</div>`;
        h+=`<div class="orgtree-mem-info"><div class="orgtree-mem-top"><span class="orgtree-mem-nm">${m.name}</span><span class="orgtree-mem-pos cp ${pc}">${m.position||''}</span></div>`;
        if(tasks) h+=`<div class="orgtree-mem-tasks">${tasks}</div>`;
        if(m.phone) h+=`<span class="orgtree-mem-phone">${m.phone}</span>`;
        if(m.email) h+=`<span class="orgtree-mem-email">${m.email}</span>`;
        h+=`</div>`;
        h+=`</div>`;
    });
    h+=`</div>`;
    content.innerHTML=h;
}

// Sort
document.querySelectorAll('.dt th[data-s]').forEach(th=>th.onclick=()=>{const k=th.dataset.s;if(SS.k===k)SS.a=!SS.a;else{SS.k=k;SS.a=true;}document.querySelectorAll('.dt th').forEach(t=>t.classList.remove('sorted'));th.classList.add('sorted');th.querySelector('.si').innerHTML=SS.a?'&#9650;':'&#9660;';refresh();});

// Detail
function showD(id){
    const e=G().find(x=>x.id===id);if(!e)return;
    const ini=e.name?e.name[0]:'?';
    document.getElementById('dBd').innerHTML=`<div class="dfoto${e.photo?' has-photo':''}">${e.photo?`<img src="${e.photo}">`:ini}</div><div class="dnm">${e.name}</div><div class="dsub">${e.position} ¬∑ ${e.team}</div><div class="dgrid"><div class="dlbl">Î∂ÄÎ¨∏</div><div class="dval">${e.division}</div><div class="dlbl">ÌåÄÎ™Ö</div><div class="dval">${e.team}</div><div class="dlbl">ÏßÅÏúÑ</div><div class="dval">${e.position}</div>${e.phone?`<div class="dlbl">Ïó∞ÎùΩÏ≤ò</div><div class="dval"><a href="tel:${e.phone}">${e.phone}</a></div>`:''} ${e.email?`<div class="dlbl">Ïù¥Î©îÏùº</div><div class="dval"><a href="mailto:${e.email}">${e.email}</a></div>`:''} ${e.extension?`<div class="dlbl">ÎÇ¥ÏÑ†</div><div class="dval">${e.extension}</div>`:''} ${e.memo?`<div class="dlbl">Î©îÎ™®</div><div class="dval">${e.memo}</div>`:''}</div>${(e.primaryTasks&&e.primaryTasks.length)?`<div class="dsec">Ï£ºÏöî ÏóÖÎ¨¥</div><div class="dtasks">${e.primaryTasks.map(t=>`<span class="dt-p">${t}</span>`).join('')}</div>`:''}${(e.secondaryTasks&&e.secondaryTasks.length)?`<div class="dsec">Í∏∞ÌÉÄ ÏóÖÎ¨¥</div><div class="dtasks">${e.secondaryTasks.map(t=>`<span class="dt-s">${t}</span>`).join('')}</div>`:''}`;
    const isAdm=document.getElementById('admC').classList.contains('unlocked');
    document.getElementById('dAct').innerHTML=isAdm?`<button class="btn btn-p" onclick="editD('${e.id}')">ÏàòÏ†ï</button><button class="btn" onclick="closeD()">Îã´Í∏∞</button>`:`<button class="btn" onclick="closeD()">Îã´Í∏∞</button>`;
    document.getElementById('dOv').classList.add('open');document.getElementById('dPn').classList.add('open');
}
function closeD(){document.getElementById('dOv').classList.remove('open');document.getElementById('dPn').classList.remove('open');}
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeD();});
function tenure(d){if(!d)return'';const j=new Date(d),n=new Date(),m=(n.getFullYear()-j.getFullYear())*12+n.getMonth()-j.getMonth();if(m<1)return'';if(m<12)return m+'Í∞úÏõî';const y=Math.floor(m/12),r=m%12;return r?y+'ÎÖÑ '+r+'Í∞úÏõî':y+'ÎÖÑ';}

// Org chart - ÌÜµÏùº Ïä§ÌÉÄÏùº, ÌåÄÎ≥Ñ ÏÉâÏÉÅ, ÏàòÎèô Ï†ïÎ†¨
// ÌåÄÎ≥Ñ ÏÉâÏÉÅÌëú
const TEAM_COLORS={
    'ÏÑúÎπÑÏä§Ïö¥ÏòÅ1ÌåÄ':'#3182CE','ÏÑúÎπÑÏä§Ïö¥ÏòÅ2ÌåÄ':'#805AD5','ÏÑúÎπÑÏä§Ïö¥ÏòÅ3ÌåÄ':'#0891B2',
    'ÏòÅÏóÖÌåÄ':'#16A34A','ÏÑ§Í≥Ñ/Ï†ÅÏÇ∞ÌåÄ':'#D97706',
    'Í≤ΩÏòÅÍ¥ÄÎ¶¨ÌåÄ':'#4F6DB5','Í∑∏Î°úÏä§ÌåÄ':'#DB2777',
    'Î∏åÎûúÎìúÏª§Î®∏Ïä§ÌåÄ':'#6D28D9','ÎØ∏ÎîîÏñ¥Ïª§Î®∏Ïä§ÌåÄ':'#0D9488','Ìï¥Ïô∏ÏÇ¨ÏóÖÌåÄ':'#EA580C','Î™®Ïó¨ÎùºÎîúÌåÄ':'#DC2626',
    'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ':'#CA8A04',
    'Í¥ÄÎ¶¨ÌåÄ':'#6B7280','ÏÉùÏÇ∞/ÌíàÏßàÍ¥ÄÎ¶¨ÌåÄ':'#92400E',
    'ÏÜåÏû¨ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå':'#0E7490','Í±¥ÏÑ§ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå':'#2563EB',
    'Ïö©Ïù∏ÏÇ¨ÏóÖÏû•':'#6B7280'
};
function getTC(tm){return TEAM_COLORS[tm]||'#90a4ae';}

function renderOrg(){
    const e=G();if(!e.length){document.getElementById('orgArea').innerHTML='<div class="empty">ÏßÅÏõê Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</div>';return;}
    const ceo=e.find(x=>x.position==='ÎåÄÌëúÏù¥ÏÇ¨');
    const headPos=['Î∂ÄÏÇ¨Ïû•','ÏÉÅÎ¨¥Ïù¥ÏÇ¨','Ïù¥ÏÇ¨'];
    const ldPos=['Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•','Í≥µÏû•Ïû•','Î¶¨Îìú Îß§ÎãàÏ†Ä','ÏÑ†ÏûÑÏó∞Íµ¨Ïõê'];
    const isLead=p=>p==='Î¶¨Îìú Îß§ÎãàÏ†Ä'||p==='ÏÑ†ÏûÑÏó∞Íµ¨Ïõê'||p==='Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•'||p==='Í≥µÏû•Ïû•';

    function dedup(arr){const s=new Set();return arr.filter(x=>{const k=x.name+'|'+x.position;if(s.has(k))return false;s.add(k);return true;});}

    function sortM(arr,tm){
        const mo=TEAM_MEM_ORDER[tm];
        if(mo){
            return arr.sort((a,b)=>{
                const ai=mo.indexOf(a.name),bi=mo.indexOf(b.name);
                return(ai<0?999:ai)-(bi<0?999:bi)||(a.name||'').localeCompare(b.name||'','ko');
            });
        }
        return arr.sort((a,b)=>{
            const al=isLead(a.position)?0:1, bl=isLead(b.position)?0:1;
            if(al!==bl) return al-bl;
            const ai=PO.indexOf(a.position),bi=PO.indexOf(b.position);
            return(ai<0?99:ai)-(bi<0?99:bi)||(a.name||'').localeCompare(b.name||'','ko');
        });
    }

    // Î©§Î≤Ñ Ïπ¥Îìú: Î¶¨Îìú = ‚òÖ + ÎÖ∏ÎûÄ Î∞∞Í≤Ω
    function memCard(m){
        const ld=isLead(m.position);
        return `<div class="o-mem${ld?' is-ld':''}" onclick="showD('${m.id}')">
            ${ld?'<span class="o-star">‚òÖ</span> ':''}<span class="o-nm">${m.name}</span> <span class="o-pos">${m.position}</span>
        </div>`;
    }

    // Ìó§Îìú Ïπ¥Îìú (‚òÖ Î≥ÑÌëú + ÎÖπÏÉâ Î∞∞Í≤Ω)
    function headCard(person){
        if(!person)return '';
        return `<div class="o-head"${person.id?` onclick="showD('${person.id}')"`:''}>
            <span class="o-star">‚òÖ</span> <span class="o-nm">${person.name}</span> <span class="o-pos">${person.position}</span>
        </div>`;
    }

    // ÌåÄ Î∏îÎ°ù (ÌåÄÎ™ÖÎßå, Î¶¨Îìú Ïù¥Î¶Ñ Ïïà ÎÑ£Ïùå)
    function tmBlock(tm,members){
        let mm=dedup(members).filter(x=>!headPos.includes(x.position));
        const tc=getTC(tm);
        const ld=mm.find(x=>isLead(x.position));
        const rest=sortM(mm.filter(x=>x!==ld),tm);
        let s=`<div class="o-col"><div class="vl"></div>`;
        s+=`<div class="o-tm" style="border-left:4px solid ${tc}" onclick="filterTeam('${tm}')"><div class="o-nm">${tm}</div></div>`;
        if(mm.length){
            s+='<div class="vl"></div><div class="o-mems">';
            if(ld) s+=memCard(ld);
            rest.forEach(m=>{s+=memCard(m);});
            s+='</div>';
        }
        s+='</div>';
        return s;
    }

    // ÏÑúÎ∏åÎ∂ÄÎ¨∏ Î∏îÎ°ù (Ïö©Ïù∏ÏÇ¨ÏóÖÏû•Ïö©) - headPersonÏùÄ ÏïÑÎûò Î≥ÑÎèÑ Ïπ¥Îìú
    function subDivBlock(title,headPerson,teams,members){
        let s=`<div class="o-col" style="padding:0 4px">`;
        s+=`<div class="vl"></div>`;
        s+=`<div class="o-subdiv"><div class="o-nm">${title}</div></div>`;
        // Ìó§Îìú(Ïó∞Íµ¨ÏÜåÏû•) Î≥ÑÎèÑ Ïπ¥Îìú
        if(headPerson){
            s+=`<div class="vl"></div>`;
            s+=headCard(headPerson);
        }
        if(teams&&teams.length){
            // ÌåÄÏóê ÏÜçÌïòÏßÄ ÏïäÎäî Î©§Î≤Ñ(Í≥µÏû•Ïû• Îì±)Îäî Î¶¨ÎìúÍ∏âÏúºÎ°ú ÌëúÏãú
            const looseMems=dedup(members).filter(x=>!headPos.includes(x.position)&&(!teams.includes(x.team))&&!(headPerson&&x.name===headPerson.name));
            if(looseMems.length){
                s+=`<div class="vl"></div><div class="o-mems">`;
                sortM(looseMems,title).forEach(m=>{s+=memCard(m);});
                s+=`</div>`;
            }
            s+=`<div class="vl"></div>`;
            if(teams.length>1) s+=`<div style="display:flex;justify-content:center"><div class="hl" style="width:0"></div></div>`;
            s+=`<div class="o-row">`;
            teams.forEach(tm=>{s+=tmBlock(tm,members.filter(x=>x.team===tm));});
            s+=`</div>`;
        } else {
            const hpName=headPerson?headPerson.name:null;
            let mm=dedup(members).filter(x=>!headPos.includes(x.position)&&!(hpName&&x.name===hpName&&['Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•','Ïó∞Íµ¨ÏÜåÏû•'].includes(x.position)));
            mm=sortM(mm,title);
            if(mm.length){
                s+=`<div class="vl"></div><div class="o-mems">`;
                mm.forEach(m=>{s+=memCard(m);});
                s+=`</div>`;
            }
        }
        s+=`</div>`;
        return s;
    }

    let h='';

    // === CEO ===
    if(ceo) h+=`<div class="o-ceo" onclick="showD('${ceo.id}')"><span class="o-star">‚òÖ</span> <span class="o-nm">${ceo.name}</span> <span class="o-pos">${ceo.position}</span></div><div class="vl"></div>`;

    // === 2ÎåÄ Í∑∏Î£π ===
    h+=`<div style="display:flex;justify-content:center"><div class="hl" style="width:0"></div></div>`;
    h+=`<div class="o-row">`;

    // ---- Ïö©Ïù∏ÏÇ¨ÏóÖÏû• Í∑∏Î£π ----
    const yong=e.filter(x=>x.division==='Ïö©Ïù∏ÏÇ¨ÏóÖÏû•'&&x.position!=='ÎåÄÌëúÏù¥ÏÇ¨');
    const yHead=yong.find(x=>x.position==='Î∂ÄÏÇ¨Ïû•');

    h+=`<div class="o-col" style="padding:0 10px">`;
    h+=`<div class="vl"></div><div class="o-grp">Ïö©Ïù∏ÏÇ¨ÏóÖÏû•</div><div class="vl"></div>`;
    if(yHead) h+=headCard(yHead)+`<div class="vl"></div>`;
    h+=`<div style="display:flex;justify-content:center"><div class="hl" style="width:0"></div></div>`;
    h+=`<div class="o-row">`;

    // Ïö©Ïù∏ÏÇ¨ÏóÖÏû• ÏÜåÏÜç (Í≥µÏû•Ïû•ÏùÄ Î¶¨Îìú Îß§ÎãàÏ†ÄÍ∏â - ÌåÄ Î©§Î≤ÑÎ°ú ÌëúÏãú)
    const yFactory=yong.filter(x=>['Ïö©Ïù∏ÏÇ¨ÏóÖÏû•','Í¥ÄÎ¶¨ÌåÄ','ÏÉùÏÇ∞/ÌíàÏßàÍ¥ÄÎ¶¨ÌåÄ'].includes(x.team)||x.position==='Í≥µÏû•Ïû•');
    h+=subDivBlock('Ïö©Ïù∏ÏÇ¨ÏóÖÏû•',null,['Í¥ÄÎ¶¨ÌåÄ','ÏÉùÏÇ∞/ÌíàÏßàÍ¥ÄÎ¶¨ÌåÄ'],yFactory);

    const yMat=yong.filter(x=>x.team==='ÏÜåÏû¨ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå');
    // ÏÜåÏû¨ Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•ÏùÄ Ï†ïÏòÅÏû¨ Î∂ÄÏÇ¨Ïû•Ïù¥ Í≤∏ÏûÑ
    let yMatHead=yMat.find(x=>x.position==='Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•');
    if(!yMatHead&&yHead) yMatHead={...yHead,position:'Ïó∞Íµ¨ÏÜåÏû•(Í≤∏ÏûÑ)'};
    h+=subDivBlock('ÏÜåÏû¨ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå',yMatHead,null,yMat);

    const yConst=yong.filter(x=>x.team==='Í±¥ÏÑ§ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå');
    const yConstHead=yConst.find(x=>['Í∏∞Ïà†Ïó∞Íµ¨ÏÜåÏû•','Ïó∞Íµ¨ÏÜåÏû•'].includes(x.position));
    h+=subDivBlock('Í±¥ÏÑ§ Í∏∞Ïà†Ïó∞Íµ¨ÏÜå',yConstHead,null,yConst);

    h+=`</div></div>`;

    // ---- Î≥∏ÏÇ¨ Í∑∏Î£π ----
    // Î∂ÄÎ¨∏(Î≥∏Î∂Ä) 3Í∞ú + ÎèÖÎ¶ΩÌåÄ(Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ)
    const bonsaDivs=['ÏòÅÏóÖÎ≥∏Î∂Ä','Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä','Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä'];
    const activeBonsa=bonsaDivs.filter(d=>e.some(x=>x.division===d));
    const bmTeam=e.filter(x=>x.division==='Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ');
    const hasBM=bmTeam.length>0;
    // Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄÏùÄ Ìï≠ÏÉÅ ÌëúÏãú (ÎèÖÎ¶ΩÌåÄ)
    const totalCols=activeBonsa.length+1;
    const salesTmOrder=['ÏÑúÎπÑÏä§Ïö¥ÏòÅ1ÌåÄ','ÏÑúÎπÑÏä§Ïö¥ÏòÅ2ÌåÄ','ÏÑúÎπÑÏä§Ïö¥ÏòÅ3ÌåÄ','ÏòÅÏóÖÌåÄ','ÏÑ§Í≥Ñ/Ï†ÅÏÇ∞ÌåÄ'];

    // Î≥∏ÏÇ¨ Í∞Å Î∂ÄÎ¨∏ Îç∞Ïù¥ÌÑ∞ ÎØ∏Î¶¨ ÏàòÏßë
    const bonsaData=activeBonsa.map(div=>{
        const de=e.filter(x=>x.division===div&&x.position!=='ÎåÄÌëúÏù¥ÏÇ¨');
        const dh=de.find(x=>headPos.includes(x.position));
        let tms=[...new Set(de.map(x=>x.team))].filter(t=>t&&t!==div);
        if(div==='ÏòÅÏóÖÎ≥∏Î∂Ä') tms.sort((a,b)=>{const ai=salesTmOrder.indexOf(a),bi=salesTmOrder.indexOf(b);return(ai<0?99:ai)-(bi<0?99:bi);});
        return {div,de,dh,tms};
    });

    h+=`<div class="o-col" style="padding:0 10px">`;
    h+=`<div class="vl"></div><div class="o-grp">Î≥∏ÏÇ¨</div><div class="vl"></div>`;
    if(totalCols>1) h+=`<div style="display:flex;justify-content:center"><div class="hl" id="hlBonsa" style="width:0"></div></div>`;

    // CSS Grid 3Ìñâ: ‚ë† Î∂ÄÎ¨∏Î™Ö ‚ë° Îã¥ÎãπÏûê(ÏûàÏúºÎ©¥) ‚ë¢ ÌåÄrow
    h+=`<div id="rowBonsa" style="display:grid;grid-template-columns:repeat(${totalCols},auto);grid-template-rows:auto auto auto;justify-content:center;gap:0 8px;">`;

    // --- ROW 1: Î∂ÄÎ¨∏ Î∞ïÏä§ ---
    bonsaData.forEach(bd=>{
        h+=`<div style="display:flex;flex-direction:column;align-items:center;">`;
        h+=`<div class="vl"></div>`;
        h+=`<div class="o-div"><div class="o-nm">${bd.div}</div></div>`;
        h+=`</div>`;
    });
    // Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄÏùÄ Î∂ÄÎ¨∏Ïù¥ ÏïÑÎãå ÎèÖÎ¶ΩÌåÄ - 1ÌñâÏóêÏÑú vl ÎùºÏù∏ÏúºÎ°ú Ïó∞Í≤∞
    h+=`<div style="display:flex;flex-direction:column;align-items:center;">`;
    h+=`<div class="vl" style="flex:1;height:auto;min-height:18px;"></div>`;
    h+=`</div>`;

    // --- ROW 2: Îã¥ÎãπÏûê (head) ---
    bonsaData.forEach(bd=>{
        h+=`<div style="display:flex;flex-direction:column;align-items:center;">`;
        if(bd.dh){
            h+=`<div class="vl"></div>`;
            h+=headCard(bd.dh);
        } else {
            // Îã¥ÎãπÏûê ÏóÜÎäî Î∂ÄÎ¨∏: vl ÎùºÏù∏ÏúºÎ°ú Ïó∞Í≤∞
            h+=`<div class="vl" style="flex:1;height:auto;min-height:36px;"></div>`;
        }
        h+=`</div>`;
    });
    // Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄÏùÄ 2ÌñâÏóêÏÑú vl ÎùºÏù∏ÏúºÎ°ú Ïó∞Í≤∞ (Î∂ÄÎ¨∏ Îã¥ÎãπÏûê ÏóÜÏùå)
    h+=`<div style="display:flex;flex-direction:column;align-items:center;">`;
    h+=`<div class="vl" style="flex:1;height:auto;min-height:36px;"></div>`;
    h+=`</div>`;

    // --- ROW 3: ÌåÄ ÎÇòÏó¥ (Î™®Îëê Í∞ôÏùÄ ÎÜíÏù¥!) ---
    bonsaData.forEach(bd=>{
        h+=`<div style="display:flex;flex-direction:column;align-items:center;">`;
        if(bd.tms.length){
            h+=`<div class="vl"></div>`;
            if(bd.tms.length>1) h+=`<div style="display:flex;justify-content:center"><div class="hl" style="width:0"></div></div>`;
            h+=`<div class="o-row">`;
            bd.tms.forEach(tm=>{h+=tmBlock(tm,bd.de.filter(x=>x.team===tm));});
            h+=`</div>`;
        }
        h+=`</div>`;
    });
    // Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ (ÎèÖÎ¶Ω ÌåÄ - 3ÌñâÏóêÏÑú ÌåÄÎ∞ïÏä§+Î©§Î≤Ñ)
    // Îã§Î•∏ Î∂ÄÎ¨∏Ïùò ÌåÄÏù¥ hl+vl Í±∞Ï≥êÏÑú ÎÇòÏò§ÎØÄÎ°ú, Í∞ôÏùÄ ÎÜíÏù¥ ÎßûÏ∂îÍ∏∞ ÏúÑÌï¥ ÎèôÏùºÌïú Íµ¨Ï°∞ ÏÇ¨Ïö©
    {
        const bmMembers=hasBM?dedup(bmTeam).filter(x=>!headPos.includes(x.position)):[];
        const bmLd=bmMembers.find(x=>isLead(x.position));
        const bmRest=hasBM?sortM(bmMembers.filter(x=>x!==bmLd),'Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ'):[];
        const tc=getTC('Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ');
        // Îã§Î•∏ Ïª¨ÎüºÏùò row3 Íµ¨Ï°∞: vl ‚Üí (hl) ‚Üí o-row ‚Üí o-col ‚Üí vl ‚Üí o-tm
        // Ïù¥ Ïª¨ÎüºÏùÄ: vl ‚Üí (hl placeholder) ‚Üí vl ‚Üí o-tm  (ÎÜíÏù¥ ÎßûÏ∂§)
        h+=`<div style="display:flex;flex-direction:column;align-items:center;">`;
        h+=`<div class="vl"></div>`;
        h+=`<div style="height:2px;"></div>`; // hl placeholder for height alignment
        h+=`<div class="vl"></div>`;
        h+=`<div class="o-tm" style="border-left:4px solid ${tc}" onclick="filterTeam('Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ')"><div class="o-nm">Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ</div></div>`;
        if(bmMembers.length){
            h+=`<div class="vl"></div><div class="o-mems">`;
            if(bmLd) h+=memCard(bmLd);
            bmRest.forEach(m=>{h+=memCard(m);});
            h+=`</div>`;
        }
        h+=`</div>`;
    }

    h+=`</div></div>`; // /grid, /Î≥∏ÏÇ¨ o-col
    h+=`</div>`; // /ÏµúÏÉÅÏúÑ o-row

    document.getElementById('orgArea').innerHTML=h;

    // ÏàòÌèâÏÑ† ÎÑàÎπÑ ÏûêÎèô ÎßûÏ∂§ (Ï†àÎåÄ Ï¢åÌëú Í∏∞Î∞ò)
    function layoutHLines(){
        // 1Îã®Í≥Ñ: Î™®Îì† hl Î∂ÄÎ™®Î•º stretchÎ°ú Î≥ÄÍ≤Ω
        document.querySelectorAll('#orgArea .hl').forEach(hlEl=>{
            const par=hlEl.parentElement;
            par.style.position='relative';
            par.style.height='2px';
            par.style.alignSelf='stretch';
        });
        document.getElementById('orgArea').offsetHeight; // reflow

        // 2Îã®Í≥Ñ: Ï∏°Ï†ï Î∞è Î∞∞Ïπò
        function autoHL(hlEl, colEls){
            if(!colEls||colEls.length<2){hlEl.style.width='0';return;}
            const rects=colEls.map(c=>c.getBoundingClientRect());
            const cx1=rects[0].left+rects[0].width/2;
            const cx2=rects[rects.length-1].left+rects[rects.length-1].width/2;
            const w=Math.max(0,cx2-cx1);
            const parRect=hlEl.parentElement.getBoundingClientRect();
            hlEl.style.position='absolute';
            hlEl.style.left=(cx1-parRect.left)+'px';
            hlEl.style.width=w+'px';
            hlEl.style.top='0';
        }

        // Î™®Îì† .o-row Ïïû hl Ï≤òÎ¶¨
        document.querySelectorAll('#orgArea .o-row').forEach(row=>{
            const prev=row.previousElementSibling;
            if(!prev)return;
            const hlEl=prev.querySelector?prev.querySelector('.hl'):null;
            if(!hlEl)return;
            const cols=[...row.children].filter(c=>c.classList.contains('o-col'));
            autoHL(hlEl,cols);
        });

        // Î≥∏ÏÇ¨ ÏàòÌèâÏÑ† (grid Í∏∞Î∞ò: row 1Ïùò ÏûêÏãùÎì§ Í∏∞Ï§Ä)
        const hlB=document.getElementById('hlBonsa');
        const rowB=document.getElementById('rowBonsa');
        if(hlB&&rowB){
            const kids=[...rowB.children];
            const ncols=totalCols||kids.length;
            const r1=kids.slice(0,ncols);
            autoHL(hlB,r1);
        }
    }
    requestAnimationFrame(()=>{ layoutHLines(); setTimeout(layoutHLines,100); });
}
function filterTeam(t){F.team=t;document.getElementById('lblTeam').textContent=t;switchPanel('directory');refresh();}

// Print/PDF
function printOrg(){
    document.querySelectorAll('.panel').forEach(p=>{p.classList.remove('print-target');});
    document.getElementById('p-orgchart').classList.add('print-target');
    window.print();
    setTimeout(()=>document.getElementById('p-orgchart').classList.remove('print-target'),500);
}

async function downloadPDF(){
    const el=document.getElementById('orgArea');
    toast('PDF ÏÉùÏÑ± Ï§ë...','');
    try{
        const canvas=await html2canvas(el,{backgroundColor:'#ffffff',scale:2,useCORS:true,logging:false});
        const {jsPDF}=window.jspdf;
        const pdf=new jsPDF({orientation:'landscape',unit:'mm',format:'a4'});
        const pw=pdf.internal.pageSize.getWidth()-20;
        const ph=pdf.internal.pageSize.getHeight()-20;
        const imgW=canvas.width,imgH=canvas.height;
        const ratio=Math.min(pw/imgW,ph/imgH);
        const w=imgW*ratio,h=imgH*ratio;
        const x=(pdf.internal.pageSize.getWidth()-w)/2;
        const y=(pdf.internal.pageSize.getHeight()-h)/2;
        pdf.addImage(canvas.toDataURL('image/png'),'PNG',x,y,w,h);
        pdf.save('Ï°∞ÏßÅÎèÑ_'+new Date().toISOString().slice(0,10)+'.pdf');
        toast('PDF Îã§Ïö¥Î°úÎìú ÏôÑÎ£å','ok');
    }catch(err){toast('PDF ÏÉùÏÑ± Ïã§Ìå®: '+err.message,'err');}
}

// Seat map - tabs
document.querySelectorAll('.seat-tab[data-sf]').forEach(t=>t.addEventListener('click',()=>{
    document.querySelectorAll('.seat-tab[data-sf]').forEach(b=>b.classList.remove('on'));
    document.querySelectorAll('.seat-floor').forEach(f=>f.classList.remove('on'));
    t.classList.add('on');
    document.getElementById(t.dataset.sf).classList.add('on');
}));
// Seat map - search
document.getElementById('seatSI').addEventListener('input',function(){seatSearch(this.value.trim());});
document.querySelectorAll('.seat-bp .sk[data-name]').forEach(s=>{
    s.addEventListener('click',()=>{document.getElementById('seatSI').value=s.dataset.name;seatSearch(s.dataset.name);});
});
function seatSearch(q){
    const r=document.getElementById('seatResult');
    const all=document.querySelectorAll('.seat-bp .sk[data-name]');
    if(!q){all.forEach(s=>s.classList.remove('hl','dm'));r.textContent='';r.className='';return;}
    const hits=[];
    all.forEach(s=>{if(s.dataset.name.includes(q)){hits.push(s);s.classList.add('hl');s.classList.remove('dm');}else{s.classList.add('dm');s.classList.remove('hl');}});
    if(hits.length){
        const fw=hits[0].closest('.seat-floor');
        if(fw&&!fw.classList.contains('on')){
            document.querySelectorAll('.seat-tab[data-sf]').forEach(b=>b.classList.remove('on'));
            document.querySelectorAll('.seat-floor').forEach(f=>f.classList.remove('on'));
            fw.classList.add('on');
            document.querySelector(`.seat-tab[data-sf="${fw.id}"]`).classList.add('on');
        }
        const fl=hits[0].closest('.seat-floor').id==='sf2'?'2Ï∏µ':'3Ï∏µ';
        r.innerHTML=hits.length===1?`<b>${hits[0].dataset.name}</b> ‚Üí ${fl}`:`<b>${hits.length}Î™Ö</b>: ${hits.map(h=>h.dataset.name).join(', ')}`;
        r.className='ok';
        setTimeout(()=>{const h=document.querySelector('.seat-floor.on .sk.hl');if(h)h.scrollIntoView({behavior:'smooth',block:'center'});},120);
    }else{r.textContent=`"${q}" ÏóÜÏùå`;r.className='no';}
}
// ESC for seat search
document.addEventListener('keydown',function(ev){if(ev.key==='Escape'&&document.getElementById('p-seatmap').classList.contains('on')){document.getElementById('seatSI').value='';seatSearch('');}});

// Seat map - Print/PDF
function printSeat(){
    document.querySelectorAll('.panel').forEach(p=>{p.classList.remove('print-target');});
    document.getElementById('p-seatmap').classList.add('print-target');
    window.print();
    setTimeout(()=>document.getElementById('p-seatmap').classList.remove('print-target'),500);
}
async function downloadSeatPDF(){
    const floor=document.querySelector('.seat-floor.on');
    if(!floor){toast('Ï∏µÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.','err');return;}
    const bp=floor.querySelector('.seat-bp');
    const flName=floor.id==='sf2'?'2Ï∏µ':'3Ï∏µ';
    toast('PDF ÏÉùÏÑ± Ï§ë...','');
    try{
        const canvas=await html2canvas(bp,{backgroundColor:'#ffffff',scale:2,useCORS:true,logging:false});
        const {jsPDF}=window.jspdf;
        const pdf=new jsPDF({orientation:'landscape',unit:'mm',format:'a4'});
        const pw=pdf.internal.pageSize.getWidth()-20;
        const ph=pdf.internal.pageSize.getHeight()-20;
        const ratio=Math.min(pw/canvas.width,ph/canvas.height);
        const w=canvas.width*ratio,h=canvas.height*ratio;
        const x=(pdf.internal.pageSize.getWidth()-w)/2;
        const y=(pdf.internal.pageSize.getHeight()-h)/2;
        pdf.addImage(canvas.toDataURL('image/png'),'PNG',x,y,w,h);
        pdf.save(`ÏûêÎ¶¨Î∞∞ÏπòÎèÑ_${flName}_${new Date().toISOString().slice(0,10)}.pdf`);
        toast('PDF Îã§Ïö¥Î°úÎìú ÏôÑÎ£å','ok');
    }catch(err){toast('PDF ÏÉùÏÑ± Ïã§Ìå®: '+err.message,'err');}
}

// Directory PDF
async function downloadDirectoryPDF(){
    const all=G();if(!all.length){toast('ÏßÅÏõê Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.','err');return;}
    let list=all.filter(e=>{
        if(F.div&&e.division!==F.div)return false;
        if(F.team&&e.team!==F.team)return false;
        if(F.pos&&e.position!==F.pos)return false;
        if(F.q){const s=[e.name,e.position,...(e.primaryTasks||[]),...(e.secondaryTasks||[])].join(' ').toLowerCase();if(!s.includes(F.q))return false;}
        return true;
    });
    list.sort(defaultSort);
    if(!list.length){toast('Ï∂úÎ†•Ìï† ÏßÅÏõêÏù¥ ÏóÜÏäµÎãàÎã§.','err');return;}
    toast('PDF ÏÉùÏÑ± Ï§ë...','');
    try{
        const {jsPDF}=window.jspdf;
        const pdf=new jsPDF({orientation:'portrait',unit:'mm',format:'a4'});
        const pw=pdf.internal.pageSize.getWidth();
        const ph=pdf.internal.pageSize.getHeight();
        const ml=14,mr=14,mt=20,mb=15;
        const pageH=ph-mt-mb;
        const blockW=800;
        const baseStyle='position:absolute;left:-9999px;top:0;background:#fff;padding:0;width:'+blockW+'px;font-family:"Pretendard Variable",Pretendard,"Malgun Gothic",sans-serif;';

        // Î∂ÄÎ¨∏/ÌåÄÎ≥Ñ Í∑∏Î£πÌïë
        const divMap={};
        list.forEach(e=>{const d=e.division||'Í∏∞ÌÉÄ';if(!divMap[d])divMap[d]=[];divMap[d].push(e);});
        const divKeys=Object.keys(divMap).sort((a,b)=>{const ai=DIV_ORDER.indexOf(a),bi=DIV_ORDER.indexOf(b);return(ai<0?99:ai)-(bi<0?99:bi);});

        // Ìó§Îçî Î∏îÎ°ù ÏÉùÏÑ± (Ï†úÎ™©+ÎÇ†Ïßú)
        function makeHeader(){
            const w=document.createElement('div');
            w.style.cssText=baseStyle+'padding:0 24px;';
            const t=document.createElement('div');
            t.style.cssText='font-size:20px;font-weight:800;margin-bottom:4px;color:#1a1a1a;';
            t.textContent='NETFORM R&D ÏßÅÏõê Î™©Î°ù';
            w.appendChild(t);
            const d=document.createElement('div');
            d.style.cssText='font-size:11px;color:#787878;margin-bottom:8px;';
            d.textContent=new Date().toLocaleDateString('ko-KR',{year:'numeric',month:'long',day:'numeric'})+(F.div||F.team||F.pos?'  |  ÌïÑÌÑ∞: '+(F.div||'Ï†ÑÏ≤¥')+' / '+(F.team||'Ï†ÑÏ≤¥')+' / '+(F.pos||'Ï†ÑÏ≤¥'):'')+'  |  Ï¥ù '+list.length+'Î™Ö';
            w.appendChild(d);
            return w;
        }

        // Î∂ÄÎ¨∏ Î∏îÎ°ù ÏÉùÏÑ±
        function makeDivBlock(div){
            const members=divMap[div];
            const w=document.createElement('div');
            w.style.cssText=baseStyle+'padding:0 24px;';
            const dh=document.createElement('div');
            dh.style.cssText='font-size:13px;font-weight:700;color:#1a202c;background:#f0f1f4;padding:6px 10px;margin-top:10px;margin-bottom:0;border-radius:4px 4px 0 0;border-bottom:2px solid #4a5568;';
            dh.textContent=div+' ('+members.length+'Î™Ö)';
            w.appendChild(dh);
            const tmMap={};
            members.forEach(m=>{
                const t=(HEAD_POS.includes(m.position)&&(m.team===div||!m.team))?div:(m.team||div);
                if(!tmMap[t])tmMap[t]=[];tmMap[t].push(m);
            });
            const tmKeys=Object.keys(tmMap).sort((a,b)=>{
                if(a===div&&b!==div)return -1;if(b===div&&a!==div)return 1;
                const ai=TO.indexOf(a),bi=TO.indexOf(b);return(ai<0?99:ai)-(bi<0?99:bi);
            });
            tmKeys.forEach(tm=>{
                const tMembers=tmMap[tm];
                tMembers.sort((a,b)=>{
                    const ma=teamMemOrder(a.name,tm),mb=teamMemOrder(b.name,tm);
                    if(ma!==999||mb!==999) return ma-mb;
                    const al=PO.indexOf(a.position)<0?99:PO.indexOf(a.position);
                    const bl=PO.indexOf(b.position)<0?99:PO.indexOf(b.position);
                    return al-bl||(a.name||'').localeCompare(b.name||'','ko');
                });
                if(tmKeys.length>1 && tm!==div){
                    const th=document.createElement('div');
                    th.style.cssText='font-size:11px;font-weight:600;color:#4a5568;padding:4px 10px 2px 18px;background:#f4f5f7;border-bottom:1px solid #dddfe3;';
                    th.textContent=tm+' ('+tMembers.length+'Î™Ö)';
                    w.appendChild(th);
                }
                const tbl=document.createElement('table');
                tbl.style.cssText='width:100%;border-collapse:collapse;font-size:11px;margin-bottom:0;';
                tMembers.forEach((m,i)=>{
                    const tr=document.createElement('tr');
                    tr.style.cssText='border-bottom:1px solid #ebebeb;'+(i%2===1?'background:#fafbfc;':'');
                    const tasks=(m.primaryTasks||[]).slice(0,2).join(', ');
                    tr.innerHTML=
                        `<td style="padding:5px 10px;font-weight:600;color:#1a1a1a;width:70px;${tmKeys.length>1&&tm!==div?'padding-left:18px;':''}">${m.name}</td>`+
                        `<td style="padding:5px 6px;color:#787878;width:80px;">${m.position||'-'}</td>`+
                        `<td style="padding:5px 6px;color:#787878;width:110px;">${m.phone||'-'}</td>`+
                        `<td style="padding:5px 6px;color:#787878;">${tasks||'-'}</td>`;
                    tbl.appendChild(tr);
                });
                w.appendChild(tbl);
            });
            return w;
        }

        // Î∏îÎ°ùÏùÑ Ï∫îÎ≤ÑÏä§Î°ú Î≥ÄÌôò
        async function renderBlock(el){
            document.body.appendChild(el);
            const c=await html2canvas(el,{backgroundColor:'#ffffff',scale:2,useCORS:true,logging:false});
            document.body.removeChild(el);
            return c;
        }

        // Î∏îÎ°ùÎ≥ÑÎ°ú ÌéòÏù¥ÏßÄ Î∞∞Ïπò (Î∂ÄÎ¨∏ Îã®ÏúÑÎ°ú ÎÅäÍπÄ Î∞©ÏßÄ)
        const headerCanvas=await renderBlock(makeHeader());
        const pdfW=pw-ml-mr;
        const hRatio=pdfW/headerCanvas.width;
        const headerH=headerCanvas.height*hRatio;
        let curY=mt;
        let pageNum=0;

        // Ìó§Îçî Ï∂îÍ∞Ä
        pdf.addImage(headerCanvas.toDataURL('image/png'),'PNG',ml,curY,pdfW,headerH);
        curY+=headerH;

        for(let i=0;i<divKeys.length;i++){
            const divCanvas=await renderBlock(makeDivBlock(divKeys[i]));
            const dRatio=pdfW/divCanvas.width;
            const blockH=divCanvas.height*dRatio;

            // ÎÇ®ÏùÄ Í≥µÍ∞ÑÏóê Ïù¥ Î∂ÄÎ¨∏ Î∏îÎ°ùÏù¥ Îì§Ïñ¥Í∞ÄÎäîÏßÄ ÌôïÏù∏
            if(curY+blockH>ph-mb && curY>mt+headerH+1){
                // ÏÉà ÌéòÏù¥ÏßÄ
                pdf.addPage();
                pageNum++;
                curY=mt;
            }

            // Î∏îÎ°ùÏù¥ Ìïú ÌéòÏù¥ÏßÄÎ≥¥Îã§ ÌÅ∞ Í≤ΩÏö∞: Ïä¨ÎùºÏù¥Ïä§ Ï≤òÎ¶¨
            if(blockH>pageH){
                let yOff=0;
                while(yOff<divCanvas.height){
                    if(yOff>0){pdf.addPage();pageNum++;curY=mt;}
                    const remain=((ph-mb)-curY)/dRatio;
                    const sliceH=Math.min(remain,divCanvas.height-yOff);
                    const sc=document.createElement('canvas');
                    sc.width=divCanvas.width;sc.height=sliceH;
                    sc.getContext('2d').drawImage(divCanvas,0,yOff,divCanvas.width,sliceH,0,0,divCanvas.width,sliceH);
                    pdf.addImage(sc.toDataURL('image/png'),'PNG',ml,curY,pdfW,sliceH*dRatio);
                    curY+=sliceH*dRatio;
                    yOff+=sliceH;
                }
            }else{
                pdf.addImage(divCanvas.toDataURL('image/png'),'PNG',ml,curY,pdfW,blockH);
                curY+=blockH;
            }
        }

        pdf.save('ÏßÅÏõêÎ™©Î°ù_'+new Date().toISOString().slice(0,10)+'.pdf');
        toast('PDF Îã§Ïö¥Î°úÎìú ÏôÑÎ£å','ok');
    }catch(err){toast('PDF ÏÉùÏÑ± Ïã§Ìå®: '+err.message,'err');}
}

// Admin
function admLogin(){if(document.getElementById('admPw').value===gPw()){document.getElementById('admLock').style.display='none';document.getElementById('admC').classList.add('unlocked');toast('Í¥ÄÎ¶¨Ïûê Î°úÍ∑∏Ïù∏ ÏôÑÎ£å','ok');renderAdmEmpList();}else toast('ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.','err');}
function chgPw(){const p=document.getElementById('nPw').value.trim();if(!p){toast('ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.','err');return;}localStorage.setItem(PK,p);document.getElementById('nPw').value='';toast('ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤ΩÎê®','ok');}

// Photo helpers
function handlePhoto(e){
    const file=e.target.files[0];if(!file)return;
    const reader=new FileReader();
    reader.onload=function(ev){
        const img=new Image();
        img.onload=function(){
            const max=200,c=document.createElement('canvas');
            let w=img.width,h=img.height;
            if(w>h){if(w>max){h=h*max/w;w=max;}}else{if(h>max){w=w*max/h;h=max;}}
            c.width=w;c.height=h;c.getContext('2d').drawImage(img,0,0,w,h);
            const data=c.toDataURL('image/jpeg',0.7);
            document.getElementById('fPhoto').value=data;
            document.getElementById('fPhotoPreview').innerHTML=`<img src="${data}">`;
            document.getElementById('fPhotoDelBtn').style.display='inline-flex';
        };
        img.src=ev.target.result;
    };
    reader.readAsDataURL(file);
}
function clearPhoto(){
    document.getElementById('fPhoto').value='';
    document.getElementById('fPhotoFile').value='';
    document.getElementById('fPhotoPreview').innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>';
    document.getElementById('fPhotoDelBtn').style.display='none';
}

// Task row helpers
function addTaskRow(rowsId){
    const rows=document.getElementById(rowsId);
    const n=rows.querySelectorAll('.task-input').length+1;
    const inp=document.createElement('input');
    inp.className='task-input';
    inp.placeholder='ÏóÖÎ¨¥ '+n;
    rows.appendChild(inp);
    inp.focus();
}
function getTaskValues(rowsId){
    return [...document.getElementById(rowsId).querySelectorAll('.task-input')].map(i=>i.value.trim()).filter(Boolean);
}
function setTaskRows(rowsId,arr,minRows){
    const rows=document.getElementById(rowsId);
    rows.innerHTML='';
    const isPrimary=(rowsId==='fPrRows');
    const count=Math.max(minRows||1,arr.length);
    for(let i=0;i<count;i++){
        const inp=document.createElement('input');
        inp.className='task-input';
        inp.placeholder=(isPrimary?'Ï£ºÏóÖÎ¨¥ ':'Í∏∞ÌÉÄ ÏóÖÎ¨¥ ')+(i+1);
        inp.value=arr[i]||'';
        rows.appendChild(inp);
    }
}

function saveEmp(){
    const n=document.getElementById('fN').value.trim(),d=document.getElementById('fD').value,t=document.getElementById('fT').value.trim(),p=document.getElementById('fP').value;
    if(!n||!d||!p){toast('ÌïÑÏàò Ìï≠Î™©(ÏÑ±Î™Ö, Î∂ÄÎ¨∏, ÏßÅÏúÑ)ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî.','err');return;}
    const all=G(),eid=document.getElementById('editId').value;
    const photo=document.getElementById('fPhoto').value||((eid&&all.find(x=>x.id===eid))?all.find(x=>x.id===eid).photo:'');
    const data={id:eid||gid(),name:n,division:d,team:t||d,position:p,phone:document.getElementById('fPh').value.trim(),email:document.getElementById('fEm').value.trim(),joinDate:eid?(all.find(x=>x.id===eid)||{}).joinDate||'':'',extension:document.getElementById('fEx').value.trim(),primaryTasks:getTaskValues('fPrRows'),secondaryTasks:getTaskValues('fScRows'),memo:document.getElementById('fMe').value.trim(),photo:photo,sortOrder:eid?(all.find(e=>e.id===eid)||{}).sortOrder||0:all.length};
    if(eid){const i=all.findIndex(e=>e.id===eid);if(i!==-1)all[i]=data;toast(n+' ÏàòÏ†ï ÏôÑÎ£å','ok');}else{all.push(data);toast(n+' Îì±Î°ù ÏôÑÎ£å','ok');}
    S(all);resetF();refresh();renderAdmEmpList();
}
function editD(id){closeD();const e=G().find(x=>x.id===id);if(!e)return;switchPanel('admin');document.getElementById('fTitle').textContent='ÏßÅÏõê Ï†ïÎ≥¥ ÏàòÏ†ï';document.getElementById('editId').value=e.id;document.getElementById('fN').value=e.name;document.getElementById('fD').value=e.division;document.getElementById('fT').value=e.team;document.getElementById('fP').value=e.position;document.getElementById('fPh').value=e.phone||'';document.getElementById('fEm').value=e.email||'';document.getElementById('fEx').value=e.extension||'';setTaskRows('fPrRows',e.primaryTasks||[],2);setTaskRows('fScRows',e.secondaryTasks||[],1);document.getElementById('fMe').value=e.memo||'';if(e.photo){document.getElementById('fPhoto').value=e.photo;document.getElementById('fPhotoPreview').innerHTML=`<img src="${e.photo}">`;document.getElementById('fPhotoDelBtn').style.display='inline-flex';}else{clearPhoto();}document.getElementById('delBtn').style.display='inline-flex';window.scrollTo({top:0,behavior:'smooth'});}
function delEmp(){const eid=document.getElementById('editId').value;if(!eid||!confirm('ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?'))return;S(G().filter(e=>e.id!==eid));toast('ÏÇ≠Ï†ú ÏôÑÎ£å','ok');resetF();refresh();renderAdmEmpList();}
function resetF(){document.getElementById('fTitle').textContent='Ïã†Í∑ú ÏßÅÏõê Îì±Î°ù';document.getElementById('editId').value='';['fN','fT','fPh','fEm','fEx','fMe'].forEach(i=>document.getElementById(i).value='');setTaskRows('fPrRows',[],2);setTaskRows('fScRows',[],1);clearPhoto();document.getElementById('fD').value='';document.getElementById('fP').value='';document.getElementById('delBtn').style.display='none';}

// Excel
const xd=document.getElementById('xDrop');
xd.addEventListener('dragover',e=>{e.preventDefault();xd.classList.add('over');});
xd.addEventListener('dragleave',()=>xd.classList.remove('over'));
xd.addEventListener('drop',e=>{e.preventDefault();xd.classList.remove('over');procXL(e.dataTransfer.files[0]);});
function handleXL(e){if(e.target.files[0])procXL(e.target.files[0]);}
let pendXL=null;
function procXL(file){
    const r=new FileReader();r.onload=function(e){
        try{
            const wb=XLSX.read(e.target.result,{type:'array',cellDates:true}),ws=wb.Sheets[wb.SheetNames[0]],json=XLSX.utils.sheet_to_json(ws,{defval:''});
            if(!json.length){toast('Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå','err');return;}
            const cm={name:['ÏÑ±Î™Ö','Ïù¥Î¶Ñ'],division:['Î∂ÄÎ¨∏','Î∂ÄÏÑú'],team:['ÌåÄÎ™Ö','ÌåÄ'],position:['ÏßÅÏúÑ','ÏßÅÏõå','ÏßÅÍ∏â'],phone:['Ï†ÑÌôîÎ≤àÌò∏','Ïó∞ÎùΩÏ≤ò','Ìú¥ÎåÄÌè∞'],email:['Î©îÏùºÏ£ºÏÜå','Ïù¥Î©îÏùº'],joinDate:['ÏûÖÏÇ¨Ïùº']};
            function fc(row,keys){for(const k of keys)for(const rk of Object.keys(row))if(rk.replace(/\s/g,'').toLowerCase().includes(k.replace(/\s/g,'').toLowerCase()))return rk;return null;}
            const s0=json[0],mp={};for(const[f,ks]of Object.entries(cm))mp[f]=fc(s0,ks);
            const tc=Object.keys(s0).filter(k=>/Îã¥ÎãπÏóÖÎ¨¥/i.test(k));
            const parsed=json.filter(r=>{const nm=mp.name?String(r[mp.name]).trim():'';return nm&&nm!=='None';}).map((r,i)=>{
                const tasks=tc.map(c=>String(r[c]||'').trim()).filter(Boolean);
                let jd=mp.joinDate?r[mp.joinDate]:'';if(jd instanceof Date)jd=jd.toISOString().slice(0,10);else if(typeof jd==='number'){jd=new Date((jd-25569)*86400000).toISOString().slice(0,10);}else jd=String(jd||'');
                return{id:gid(),name:String(r[mp.name]||'').trim(),division:String(r[mp.division]||'').trim(),team:String(r[mp.team]||'').trim(),position:String(r[mp.position]||'').trim(),phone:String(r[mp.phone]||'').trim(),email:String(r[mp.email]||'').trim(),joinDate:jd,extension:'',primaryTasks:tasks,secondaryTasks:[],memo:'',photo:'',sortOrder:i};
            });
            pendXL=parsed;
            document.getElementById('xPrev').innerHTML=`<div style="margin:12px 0 6px;font-size:13px">Ï¥ù <b>${parsed.length}</b>Î™Ö Ïù∏Ïãù (ÏÉÅÏúÑ 10Î™Ö ÎØ∏Î¶¨Î≥¥Í∏∞)</div><div class="xprev"><table><thead><tr><th>ÏÑ±Î™Ö</th><th>Î∂ÄÎ¨∏</th><th>ÌåÄÎ™Ö</th><th>ÏßÅÏúÑ</th><th>Ïó∞ÎùΩÏ≤ò</th><th>ÏûÖÏÇ¨Ïùº</th><th>Îã¥ÎãπÏóÖÎ¨¥</th></tr></thead><tbody>${parsed.slice(0,10).map(p=>`<tr><td>${p.name}</td><td>${p.division}</td><td>${p.team}</td><td>${p.position}</td><td>${p.phone}</td><td>${p.joinDate}</td><td>${(p.primaryTasks||[]).join(', ')}</td></tr>`).join('')}</tbody></table></div><div style="margin-top:10px;display:flex;gap:7px"><button class="btn btn-p" onclick="confirmXL()">Ï†ÑÏ≤¥ ${parsed.length}Î™Ö Îì±Î°ù</button><button class="btn btn-d" onclick="cancelXL()">Ï∑®ÏÜå</button></div>`;
        }catch(err){toast('ÌååÏùº Ïò§Î•ò: '+err.message,'err');}
    };r.readAsArrayBuffer(file);
}
function confirmXL(){if(!pendXL)return;const ex=G();if(ex.length&&!confirm('Í∏∞Ï°¥ '+ex.length+'Î™Ö ÎçÆÏñ¥Ïì∞Í∏∞? (Ï∑®ÏÜå=Ï∂îÍ∞Ä)')){pendXL.forEach((d,i)=>{d.sortOrder=ex.length+i;ex.push(d);});S(ex);}else S(pendXL);toast(pendXL.length+'Î™Ö Îì±Î°ù ÏôÑÎ£å','ok');pendXL=null;document.getElementById('xPrev').innerHTML='';refresh();}
function cancelXL(){pendXL=null;document.getElementById('xPrev').innerHTML='';}

// JSON
function exportJSON(){const d=G();if(!d.length){toast('Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå','err');return;}const b=new Blob([JSON.stringify(d,null,2)],{type:'application/json'}),a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='ÏßÅÏõêÏ†ïÎ≥¥_'+new Date().toISOString().slice(0,10)+'.json';document.body.appendChild(a);a.click();document.body.removeChild(a);toast('ÎÇ¥Î≥¥ÎÇ¥Í∏∞ ÏôÑÎ£å','ok');}
function impJSON(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=ev=>{try{const d=JSON.parse(ev.target.result);if(!Array.isArray(d))throw 0;S(d);toast(d.length+'Î™Ö Í∞ÄÏ†∏Ïò§Í∏∞ ÏôÑÎ£å','ok');refresh();}catch(e){toast('ÌòïÏãù Ïò§Î•ò','err');}};r.readAsText(f);e.target.value='';}

// Ï†úÏ∂ú Îç∞Ïù¥ÌÑ∞ Ï∑®Ìï© (ÏßÅÏõêÏ†ïÎ≥¥Ï†úÏ∂ú.htmlÏùò localStorageÏóêÏÑú Í∞ÄÏ†∏Ïò§Í∏∞)
function pullSubmitData(){
    const SUB_KEY='nf_submit_v1';
    let sub;
    try{sub=JSON.parse(localStorage.getItem(SUB_KEY));}catch(e){sub=null;}
    if(!sub||!Object.keys(sub).length){toast('Ï†úÏ∂ú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§. ÏßÅÏõêÏ†ïÎ≥¥Ï†úÏ∂ú.htmlÏóêÏÑú Î®ºÏ†Ä Îç∞Ïù¥ÌÑ∞Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.','err');return;}
    const all=G();if(!all.length){toast('Í∏∞Ï°¥ ÏßÅÏõê Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.','err');return;}
    let taskCount=0,photoCount=0,skipCount=0,logs=[];
    for(const[key,val] of Object.entries(sub)){
        if(key.startsWith('task_')){
            const[name,team]=key.replace('task_','').split('|');
            const match=all.find(x=>x.name===name&&x.team===team)||all.find(x=>x.name===name);
            if(match&&Array.isArray(val)&&val.length){match.primaryTasks=val;taskCount++;logs.push(`‚úÖ ${name} ‚Äî ÏóÖÎ¨¥ ÏóÖÎç∞Ïù¥Ìä∏ (${val.length}Í∞ú)`);}
            else{skipCount++;logs.push(`‚ö†Ô∏è ${name} ‚Äî Îß§Ïπ≠ Ïã§Ìå®`);}
        }
        if(key.startsWith('photo_')){
            const[name,team]=key.replace('photo_','').split('|');
            const match=all.find(x=>x.name===name&&x.team===team)||all.find(x=>x.name===name);
            if(match&&val){match.photo=val;photoCount++;logs.push(`‚úÖ ${name} ‚Äî ÏÇ¨ÏßÑ ÏóÖÎç∞Ïù¥Ìä∏`);}
            else{skipCount++;logs.push(`‚ö†Ô∏è ${name} ‚Äî Îß§Ïπ≠ Ïã§Ìå®`);}
        }
    }
    S(all);refresh();renderAdmEmpList();
    const res=document.getElementById('mergeResult');
    res.innerHTML=`<div style="background:var(--bg-elevated);border:1px solid var(--border);border-radius:var(--radius);padding:12px;font-size:12px;">
        <div style="font-weight:700;margin-bottom:6px;">üìä Ï∑®Ìï© Í≤∞Í≥º</div>
        <div style="color:var(--green);font-weight:600;">‚úÖ ÏóÖÎ¨¥ ÏóÖÎç∞Ïù¥Ìä∏: ${taskCount}Î™Ö</div>
        <div style="color:var(--accent);font-weight:600;">üì∑ ÏÇ¨ÏßÑ ÏóÖÎç∞Ïù¥Ìä∏: ${photoCount}Î™Ö</div>
        ${skipCount?`<div style="color:var(--amber);font-weight:600;">‚ö†Ô∏è Îß§Ïπ≠ Ïã§Ìå®: ${skipCount}Í±¥</div>`:''}
        <details style="margin-top:8px;"><summary style="cursor:pointer;color:var(--accent);font-size:11px;">ÏÉÅÏÑ∏ Î°úÍ∑∏ Î≥¥Í∏∞</summary>
        <div style="margin-top:4px;max-height:200px;overflow-y:auto;font-size:11px;line-height:1.6;">${logs.join('<br>')}</div></details>
    </div>`;
    toast(`ÏóÖÎ¨¥ ${taskCount}Î™Ö, ÏÇ¨ÏßÑ ${photoCount}Î™Ö Ï∑®Ìï© ÏôÑÎ£å!`,'ok');
}

// Ï†úÏ∂ú JSON ÌååÏùº Î≥ëÌï© (Ïù¥Î¶Ñ Í∏∞Ï§Ä Îß§Ïπ≠ ‚Üí ÏóÖÎ¨¥/ÏÇ¨ÏßÑ ÏóÖÎç∞Ïù¥Ìä∏)
function mergeJSON(e){
    const files=[...e.target.files];if(!files.length)return;
    const all=G();if(!all.length){toast('Í∏∞Ï°¥ ÏßÅÏõê Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§. Î®ºÏ†Ä ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î•º Î°úÎìúÌïòÏÑ∏Ïöî.','err');e.target.value='';return;}
    let totalRead=0,totalMerged=0,totalSkipped=0,logs=[];
    let processed=0;
    files.forEach(f=>{
        const r=new FileReader();
        r.onload=ev=>{
            try{
                const d=JSON.parse(ev.target.result);
                if(!Array.isArray(d))throw 0;
                d.forEach(sub=>{
                    totalRead++;
                    const match=all.find(x=>x.name===sub.name&&(!sub.team||x.team===sub.team))||all.find(x=>x.name===sub.name);
                    if(!match){totalSkipped++;logs.push(`‚ö†Ô∏è ${sub.name} ‚Äî Îß§Ïπ≠ Ïã§Ìå® (Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞Ïóê ÏóÜÏùå)`);return;}
                    let changed=false;
                    // ÏóÖÎ¨¥ Î≥ëÌï©
                    if(sub.primaryTasks&&sub.primaryTasks.length){match.primaryTasks=sub.primaryTasks;changed=true;}
                    // ÏÇ¨ÏßÑ Î≥ëÌï©
                    if(sub.photo){match.photo=sub.photo;changed=true;}
                    // Í∏∞ÌÉÄ ÌïÑÎìúÎèÑ ÎπÑÏñ¥ÏûàÏßÄ ÏïäÏúºÎ©¥ ÏóÖÎç∞Ïù¥Ìä∏
                    if(sub.secondaryTasks&&sub.secondaryTasks.length){match.secondaryTasks=sub.secondaryTasks;changed=true;}
                    if(sub.phone&&!match.phone){match.phone=sub.phone;changed=true;}
                    if(sub.email&&!match.email){match.email=sub.email;changed=true;}
                    if(sub.memo&&!match.memo){match.memo=sub.memo;changed=true;}
                    if(changed){totalMerged++;logs.push(`‚úÖ ${sub.name} ‚Äî ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å`);}
                    else{logs.push(`‚ûñ ${sub.name} ‚Äî Î≥ÄÍ≤Ω ÏÇ¨Ìï≠ ÏóÜÏùå`);}
                });
            }catch(err){logs.push(`‚ùå ${f.name} ‚Äî ÌååÏùº Ïò§Î•ò`);}
            processed++;
            if(processed===files.length){
                S(all);refresh();renderAdmEmpList();
                const res=document.getElementById('mergeResult');
                res.innerHTML=`<div style="background:var(--bg-elevated);border:1px solid var(--border);border-radius:var(--radius);padding:12px;font-size:12px;">
                    <div style="font-weight:700;margin-bottom:6px;">üìä Î≥ëÌï© Í≤∞Í≥º: ${files.length}Í∞ú ÌååÏùº Ï≤òÎ¶¨</div>
                    <div style="color:var(--green);font-weight:600;">‚úÖ ÏóÖÎç∞Ïù¥Ìä∏: ${totalMerged}Î™Ö</div>
                    <div style="color:var(--text-sub);">‚ûñ Î≥ÄÍ≤ΩÏóÜÏùå: ${totalRead-totalMerged-totalSkipped}Î™Ö</div>
                    ${totalSkipped?`<div style="color:var(--amber);font-weight:600;">‚ö†Ô∏è Îß§Ïπ≠Ïã§Ìå®: ${totalSkipped}Î™Ö</div>`:''}
                    <details style="margin-top:8px;"><summary style="cursor:pointer;color:var(--accent);font-size:11px;">ÏÉÅÏÑ∏ Î°úÍ∑∏ Î≥¥Í∏∞</summary>
                    <div style="margin-top:4px;max-height:200px;overflow-y:auto;font-size:11px;line-height:1.6;">${logs.join('<br>')}</div></details>
                </div>`;
                toast(`${totalMerged}Î™Ö Îç∞Ïù¥ÌÑ∞ Î≥ëÌï© ÏôÑÎ£å!`,'ok');
            }
        };
        r.readAsText(f);
    });
    e.target.value='';
}

// ÏÇ¨ÏßÑ ÏùºÍ¥Ñ Îì±Î°ù (photos_import.json)
function importPhotoBatch(e){
    const f=e.target.files[0];if(!f)return;
    const all=G();
    if(!all.length){toast('Í∏∞Ï°¥ ÏßÅÏõê Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§. Î®ºÏ†Ä ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î•º Î°úÎìúÌïòÏÑ∏Ïöî.','err');e.target.value='';return;}
    const r=new FileReader();
    r.onload=ev=>{
        try{
            const photos=JSON.parse(ev.target.result);
            if(!Array.isArray(photos))throw 0;
            let matched=0,skipped=0,logs=[];
            photos.forEach(p=>{
                if(!p.name||!p.photo)return;
                // Ïù¥Î¶Ñ+ÌåÄÏúºÎ°ú Îß§Ïπ≠ ‚Üí Ïù¥Î¶ÑÎßåÏúºÎ°ú Ìè¥Î∞±
                const match=all.find(x=>x.name===p.name&&(!p.team||x.team===p.team))||all.find(x=>x.name===p.name);
                if(!match){skipped++;logs.push(`‚ö†Ô∏è ${p.name} (${p.team||'ÌåÄ ÎØ∏ÏßÄÏ†ï'}) ‚Äî Îß§Ïπ≠ Ïã§Ìå®`);return;}
                match.photo=p.photo;
                matched++;
                logs.push(`‚úÖ ${p.name} (${match.team}) ‚Äî ÏÇ¨ÏßÑ Îì±Î°ù ÏôÑÎ£å`);
            });
            S(all);refresh();renderAdmEmpList();
            const res=document.getElementById('mergeResult');
            res.innerHTML=`<div style="background:linear-gradient(135deg,rgba(124,58,237,.04),rgba(124,58,237,.08));border:1px solid rgba(124,58,237,.2);border-radius:var(--radius);padding:14px;font-size:12px;">
                <div style="font-weight:700;margin-bottom:8px;color:#7c3aed;">üì∑ ÏÇ¨ÏßÑ ÏùºÍ¥Ñ Îì±Î°ù Í≤∞Í≥º</div>
                <div style="color:var(--green);font-weight:600;font-size:14px;">‚úÖ Îì±Î°ù ÏÑ±Í≥µ: ${matched}Î™Ö</div>
                ${skipped?`<div style="color:var(--amber);font-weight:600;margin-top:2px;">‚ö†Ô∏è Îß§Ïπ≠ Ïã§Ìå®: ${skipped}Î™Ö</div>`:''}
                <div style="color:var(--text-sub);margin-top:2px;">üìÑ Ï¥ù Ï≤òÎ¶¨: ${photos.length}Í±¥</div>
                <details style="margin-top:8px;"><summary style="cursor:pointer;color:#7c3aed;font-size:11px;">ÏÉÅÏÑ∏ Î°úÍ∑∏ Î≥¥Í∏∞</summary>
                <div style="margin-top:4px;max-height:200px;overflow-y:auto;font-size:11px;line-height:1.7;">${logs.join('<br>')}</div></details>
            </div>`;
            toast(`üì∑ ${matched}Î™Ö ÏÇ¨ÏßÑ ÏùºÍ¥Ñ Îì±Î°ù ÏôÑÎ£å!`,'ok');
        }catch(err){toast('JSON ÌååÏùº ÌòïÏãù Ïò§Î•ò','err');}
    };
    r.readAsText(f);
    e.target.value='';
}

function clearAll(){if(!confirm('Ï†ÑÏ≤¥ ÏÇ≠Ï†ú?'))return;localStorage.removeItem(SK);toast('ÏÇ≠Ï†ú ÏôÑÎ£å','ok');resetF();refresh();}

// Sample (Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî)
function loadSample(){
    if(G().length&&!confirm('Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞Î•º Ï¥àÍ∏∞ Îç∞Ïù¥ÌÑ∞Î°ú Î≥µÏõêÌïòÏãúÍ≤†ÏäµÎãàÍπå?'))return;
    S(DEFAULT_EMP.map(e=>({...e,id:gid()})));toast('Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìúÎê®','ok');refresh();
}

function toast(m,t){const el=document.getElementById('toast');el.textContent=m;el.className='toast '+(t==='ok'?'ok':t==='err'?'err':'');setTimeout(()=>el.classList.add('show'),10);setTimeout(()=>el.classList.remove('show'),2500);}

// ===== Î∑∞ Ï†ÑÌôò (Ï°∞ÏßÅÌä∏Î¶¨ / ÏïÑÏΩîÎîîÏñ∏) =====
let curView='acc';
function setView(v){
    curView=v;
    document.getElementById('viewOrgTreeWrap').style.display=v==='orgtree'?'':'none';
    document.getElementById('viewAccWrap').style.display=v==='acc'?'':'none';
    ['viewOrgTree','viewAcc'].forEach(id=>{
        const btn=document.getElementById(id);
        const on=(id==='viewOrgTree'&&v==='orgtree')||(id==='viewAcc'&&v==='acc');
        btn.style.background=on?'var(--accent)':'var(--bg-surface)';
        btn.style.color=on?'#fff':'var(--text)';
        btn.style.borderColor=on?'var(--accent)':'var(--border)';
    });
    refresh();
}

// ===== ÏïÑÏΩîÎîîÏñ∏ Î∑∞ =====
const DIV_ORDER=['Í≤ΩÏòÅÏ¥ùÍ¥Ñ','Ïö©Ïù∏ÏÇ¨ÏóÖÏû•','ÏòÅÏóÖÎ≥∏Î∂Ä','Í≤ΩÏòÅÍ¥ÄÎ¶¨Î≥∏Î∂Ä','Ïª§Î®∏Ïä§ÏÇ¨ÏóÖÎ≥∏Î∂Ä','Î∏åÎûúÎìúÎßàÏºÄÌåÖÌåÄ'];
function renderAccView(list){
    const area=document.getElementById('accArea');if(!area)return;
    if(!list.length){area.innerHTML='';return;}
    // Î∂ÄÎ¨∏Î≥Ñ Í∑∏Î£π
    const divMap={};
    list.forEach(e=>{
        const d=e.division||'Í∏∞ÌÉÄ';
        if(!divMap[d])divMap[d]=[];
        divMap[d].push(e);
    });
    const divKeys=Object.keys(divMap).sort((a,b)=>{
        const ai=DIV_ORDER.indexOf(a),bi=DIV_ORDER.indexOf(b);
        return(ai<0?99:ai)-(bi<0?99:bi);
    });
    let h='';
    divKeys.forEach(div=>{
        const members=divMap[div];
        // ÌåÄÎ≥Ñ Í∑∏Î£π
        const tmMap={};
        // Î∂ÄÎ¨∏ Ï¥ùÍ¥Ñ(team===div ÎòêÎäî team ÏóÜÏùå)ÏùÄ Î∂ÄÎ¨∏Î™Ö Í∑∏Î£πÏóê Í∞ïÏ†ú Î∞∞Ïπò
        members.forEach(m=>{
            const t=(HEAD_POS.includes(m.position)&&(m.team===div||!m.team))?div:(m.team||div);
            if(!tmMap[t])tmMap[t]=[];tmMap[t].push(m);
        });
        const tmKeys=Object.keys(tmMap).sort((a,b)=>{
            // Î∂ÄÎ¨∏Î™ÖÍ≥º Í∞ôÏùÄ ÌÇ§Î•º Ìï≠ÏÉÅ Îß® ÏúÑÎ°ú
            if(a===div&&b!==div)return -1;if(b===div&&a!==div)return 1;
            const ai=TO.indexOf(a),bi=TO.indexOf(b);return(ai<0?99:ai)-(bi<0?99:bi);
        });
        h+=`<div class="acc-div">`;
        h+=`<div class="acc-div-hd open" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('open')">`;
        h+=`<div class="acc-title">${div} <span class="acc-badge">${members.length}Î™Ö</span></div>`;
        h+=`<svg class="acc-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>`;
        h+=`</div>`;
        h+=`<div class="acc-div-body open">`;
        tmKeys.forEach(tm=>{
            const tMembers=tmMap[tm];
            // Ï†ïÎ†¨: Ï°∞ÏßÅÎèÑ ÏàòÎèô ÏàúÏÑú ‚Üí ÏßÅÏúÑÏàú ‚Üí Í∞ÄÎÇòÎã§Ïàú Ìè¥Î∞±
            tMembers.sort((a,b)=>{
                const ma=teamMemOrder(a.name,tm),mb=teamMemOrder(b.name,tm);
                if(ma!==999||mb!==999) return ma-mb;
                const al=PO.indexOf(a.position)<0?99:PO.indexOf(a.position);
                const bl=PO.indexOf(b.position)<0?99:PO.indexOf(b.position);
                return al-bl||(a.name||'').localeCompare(b.name||'','ko');
            });
            if(tmKeys.length>1 && tm!==div){
                h+=`<div class="acc-tm">`;
                h+=`<div class="acc-tm-hd open" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('open')">`;
                h+=`<div class="acc-tm-title">${tm} <span class="acc-tm-badge">${tMembers.length}</span></div>`;
                h+=`<svg class="acc-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>`;
                h+=`</div>`;
                h+=`<div class="acc-tm-body open">`;
            }
            tMembers.forEach(m=>{
                const pc=['ÎåÄÌëúÏù¥ÏÇ¨','Î∂ÄÏÇ¨Ïû•','ÏÉÅÎ¨¥Ïù¥ÏÇ¨','Ïù¥ÏÇ¨'].includes(m.position)||(m.position||'').includes('Ïó∞Íµ¨ÏÜåÏû•')?'cp-e':['Î¶¨Îìú Îß§ÎãàÏ†Ä','Í≥µÏû•Ïû•','ÏÑ†ÏûÑÏó∞Íµ¨Ïõê'].includes(m.position)?'cp-l':'cp-m';
                const ini=m.name?m.name[0]:'?';
                const tasks=(m.primaryTasks||[]).slice(0,2).join(', ');
                h+=`<div class="acc-mem" onclick="showD('${m.id}')">`;
                h+=`<div class="av">${m.photo?`<img src="${m.photo}">`:ini}</div>`;
                h+=`<div class="acc-mem-info"><span class="acc-mem-nm">${m.name}</span><span class="acc-mem-pos cp ${pc}">${m.position||''}</span>`;
                if(tasks) h+=`<span class="acc-mem-task">${tasks}</span>`;
                h+=`</div>`;
                h+=`</div>`;
            });
            if(tmKeys.length>1 && tm!==div){
                h+=`</div></div>`;
            }
        });
        h+=`</div></div>`;
    });
    area.innerHTML=h;
}

// ===== Í¥ÄÎ¶¨Ïûê ÏßÅÏõêÎ™©Î°ù =====
function renderAdmEmpList(){
    const list=G();
    const q=(document.getElementById('admEmpSearch').value||'').trim().toLowerCase();
    const filtered=q?list.filter(e=>(e.name||'').toLowerCase().includes(q)||(e.team||'').toLowerCase().includes(q)||(e.division||'').toLowerCase().includes(q)):list;
    filtered.sort(defaultSort);
    const el=document.getElementById('admEmpList');
    if(!filtered.length){el.innerHTML='<div style="padding:16px;text-align:center;color:var(--text-dim);font-size:13px;">ÏßÅÏõêÏù¥ ÏóÜÏäµÎãàÎã§.</div>';return;}
    el.innerHTML=filtered.map(e=>`<div class="adm-emp-item" onclick="editD('${e.id}')"><span class="adm-emp-nm">${e.name}</span><span class="adm-emp-tm">${e.team||'-'}</span><span class="adm-emp-pos">${e.position||'-'}</span></div>`).join('');
}

// ===== ÏûêÎ¶¨Î∞∞ÏπòÎèÑ ÏßÅÏõê ÌÅ¥Î¶≠ Ïãú ÏÉÅÏÑ∏Ï†ïÎ≥¥ ÌåùÏóÖ =====
function showSeatPopup(name,el){
    const emp=G().find(x=>x.name===name);
    const popup=document.getElementById('seatPopup');
    const body=document.getElementById('seatPopupBody');
    if(!emp){
        body.innerHTML=`<div class="seat-popup-nm">${name}</div><div class="seat-popup-sub" style="margin-top:6px;">Îì±Î°ùÎêú ÏßÅÏõê Ï†ïÎ≥¥Í∞Ä ÏóÜÏäµÎãàÎã§.</div>`;
    }else{
        const tasks=(emp.primaryTasks||[]);
        body.innerHTML=
            `<div class="seat-popup-nm">${emp.name}</div>`+
            `<div class="seat-popup-sub">${emp.position} ¬∑ ${emp.team}</div>`+
            `<div class="seat-popup-grid">`+
            `<div class="sp-l">Î∂ÄÎ¨∏</div><div class="sp-v">${emp.division||'-'}</div>`+
            `<div class="sp-l">ÌåÄ</div><div class="sp-v">${emp.team||'-'}</div>`+
            `<div class="sp-l">ÏßÅÏúÑ</div><div class="sp-v">${emp.position||'-'}</div>`+
            (emp.phone?`<div class="sp-l">Ïó∞ÎùΩÏ≤ò</div><div class="sp-v"><a href="tel:${emp.phone}">${emp.phone}</a></div>`:'')+
            (emp.email?`<div class="sp-l">Ïù¥Î©îÏùº</div><div class="sp-v">${emp.email}</div>`:'')+
            (emp.extension?`<div class="sp-l">ÎÇ¥ÏÑ†</div><div class="sp-v">${emp.extension}</div>`:'')+
            `</div>`+
            (tasks.length?`<div class="seat-popup-tasks">${tasks.map(t=>`<span>${t}</span>`).join('')}</div>`:'');
    }
    // ÏúÑÏπò Í≥ÑÏÇ∞
    const rect=el.getBoundingClientRect();
    let top=rect.bottom+8,left=rect.left;
    if(top+200>window.innerHeight) top=rect.top-210;
    if(left+300>window.innerWidth) left=window.innerWidth-310;
    if(left<10) left=10;
    popup.style.top=top+'px';
    popup.style.left=left+'px';
    popup.classList.add('show');
}
function closeSeatPopup(){document.getElementById('seatPopup').classList.remove('show');document.getElementById('seatSI').value='';seatSearch('');}
document.addEventListener('click',function(ev){
    if(!ev.target.closest('.seat-popup')&&!ev.target.closest('.sk[data-name]')){closeSeatPopup();}
});

// Ï¢åÏÑù ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ Ïû¨Îì±Î°ù (ÌåùÏóÖ Î∞©Ïãù)
document.querySelectorAll('.seat-bp .sk[data-name]').forEach(s=>{
    s.onclick=function(ev){
        ev.stopPropagation();
        document.getElementById('seatSI').value=s.dataset.name;
        seatSearch(s.dataset.name);
        showSeatPopup(s.dataset.name,s);
    };
});

refresh();

// ===== ÏóÖÎ¨¥ Ïó∞ÎùΩÏ≤ò =====
const CT_KEY='nf_contacts_v1';
const CT_COLLAPSE_KEY='nf_ct_collapsed';
const getCt=()=>{try{return JSON.parse(localStorage.getItem(CT_KEY))||[];}catch(e){return[];}};
const setCt=d=>localStorage.setItem(CT_KEY,JSON.stringify(d));
const getCollapsed=()=>{try{return JSON.parse(localStorage.getItem(CT_COLLAPSE_KEY))||{};}catch(e){return{};}};
const setCollapsed=d=>localStorage.setItem(CT_COLLAPSE_KEY,JSON.stringify(d));

function catClass(cat){return 'ct-cat-'+(cat||'Í∏∞ÌÉÄ').replace(/\//g,'');}

function toggleCtGroup(cat){
    const state=getCollapsed();
    state[cat]=!state[cat];
    setCollapsed(state);
    renderContacts();
}

function renderContacts(){
    const all=getCt();
    const q=(document.getElementById('ctSearch').value||'').trim().toLowerCase();
    const isAdm=document.getElementById('admC').classList.contains('unlocked');
    document.getElementById('ctAddBtn').style.display=isAdm?'inline-flex':'none';
    let list=all;
    if(q){
        list=all.filter(c=>[c.company,c.name,c.phone,c.corpPhone,c.email,c.category,c.memo].join(' ').toLowerCase().includes(q));
    }
    if(!list.length){
        document.getElementById('ctList').innerHTML='';
        document.getElementById('ctEmpty').style.display='block';
        return;
    }
    document.getElementById('ctEmpty').style.display='none';
    const cats=[...new Set(list.map(c=>c.category||'Í∏∞ÌÉÄ'))];
    const catOrder=['ÌöåÏÇ¨Î≤ïÏù∏Ìè∞','Í±∞ÎûòÏ≤ò','ÌòëÎ†•ÏóÖÏ≤¥','Î∞∞ÏÜ°/Î¨ºÎ•ò','Í∏àÏúµ/Î≥¥Ìóò','Í¥ÄÍ≥µÏÑú','IT/ÏãúÏä§ÌÖú','Í∏∞ÌÉÄ'];
    cats.sort((a,b)=>(catOrder.indexOf(a)<0?99:catOrder.indexOf(a))-(catOrder.indexOf(b)<0?99:catOrder.indexOf(b)));
    const collapsed=getCollapsed();
    // Î≤ïÏù∏Ìè∞ Ïó¥ ÌëúÏãú Ïó¨Î∂Ä: Ìï¥Îãπ Î∂ÑÎ•òÏóê corpPhone Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûàÎäî ÌñâÏù¥ ÌïòÎÇòÎùºÎèÑ ÏûàÏúºÎ©¥ ÌëúÏãú
    let h='';
    cats.forEach(cat=>{
        const items=list.filter(c=>(c.category||'Í∏∞ÌÉÄ')===cat);
        const isHidden=!!collapsed[cat];
        const hasCorpPhone=items.some(c=>c.corpPhone);
        const arrowSvg=`<svg class="ct-group-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>`;
        h+=`<div class="ct-group">`;
        h+=`<div class="ct-group-hd${isHidden?' collapsed':''}" onclick="toggleCtGroup('${cat}')">`;
        h+=`<div class="ct-group-left"><span class="ct-cat ${catClass(cat)}">${cat}</span><span class="ct-group-cnt">${items.length}Í±¥</span></div>`;
        h+=arrowSvg;
        h+=`</div>`;
        h+=`<div class="ct-group-body${isHidden?' collapsed':''}">`;
        h+=`<table class="ct-tbl"><thead><tr>`;
        h+=`<th>ÏóÖÏ≤¥/Í∏∞Í¥ÄÎ™Ö</th><th>Îã¥ÎãπÏûê</th><th>Ïó∞ÎùΩÏ≤ò</th>`;
        if(hasCorpPhone) h+=`<th>Î≤ïÏù∏Ìè∞</th>`;
        h+=`<th>Ïù¥Î©îÏùº</th><th>Î©îÎ™®</th>`;
        if(isAdm) h+=`<th></th>`;
        h+=`</tr></thead><tbody>`;
        items.forEach(c=>{
            h+=`<tr>`;
            h+=`<td><span class="ct-company">${c.company||'-'}</span></td>`;
            h+=`<td>${c.name||'-'}</td>`;
            h+=`<td>${c.phone?`<a href="tel:${c.phone}">${c.phone}</a>`:'-'}</td>`;
            if(hasCorpPhone) h+=`<td>${c.corpPhone?`<a href="tel:${c.corpPhone}">${c.corpPhone}</a>`:'-'}</td>`;
            h+=`<td>${c.email?`<a href="mailto:${c.email}">${c.email}</a>`:'-'}</td>`;
            h+=`<td><span class="ct-memo-cell">${c.memo||'-'}</span></td>`;
            if(isAdm) h+=`<td><button class="ct-edit-btn" onclick="editCt('${c.id}')">ÏàòÏ†ï</button></td>`;
            h+=`</tr>`;
        });
        h+=`</tbody></table></div></div>`;
    });
    document.getElementById('ctList').innerHTML=h;
}

function openCtForm(id){
    const modal=document.getElementById('ctModal');
    document.getElementById('ctEditId').value='';
    document.getElementById('ctCat').value='';
    document.getElementById('ctCompany').value='';
    document.getElementById('ctName').value='';
    document.getElementById('ctPhone').value='';
    document.getElementById('ctCorpPhone').value='';
    document.getElementById('ctEmail').value='';
    document.getElementById('ctMemo').value='';
    document.getElementById('ctDelBtn').style.display='none';
    document.getElementById('ctFormTitle').textContent='Ïó∞ÎùΩÏ≤ò Ï∂îÍ∞Ä';
    if(id){
        const c=getCt().find(x=>x.id===id);
        if(c){
            document.getElementById('ctEditId').value=c.id;
            document.getElementById('ctCat').value=c.category||'';
            document.getElementById('ctCompany').value=c.company||'';
            document.getElementById('ctName').value=c.name||'';
            document.getElementById('ctPhone').value=c.phone||'';
            document.getElementById('ctCorpPhone').value=c.corpPhone||'';
            document.getElementById('ctEmail').value=c.email||'';
            document.getElementById('ctMemo').value=c.memo||'';
            document.getElementById('ctDelBtn').style.display='inline-flex';
            document.getElementById('ctFormTitle').textContent='Ïó∞ÎùΩÏ≤ò ÏàòÏ†ï';
        }
    }
    modal.classList.add('show');
}
function closeCtForm(){document.getElementById('ctModal').classList.remove('show');}
document.getElementById('ctModal').addEventListener('click',function(e){if(e.target===this)closeCtForm();});

function editCt(id){openCtForm(id);}

function saveCt(){
    const cat=document.getElementById('ctCat').value;
    const company=document.getElementById('ctCompany').value.trim();
    const phone=document.getElementById('ctPhone').value.trim();
    if(!cat||!company||!phone){toast('Î∂ÑÎ•ò, ÏóÖÏ≤¥Î™Ö, Ïó∞ÎùΩÏ≤òÎäî ÌïÑÏàòÏûÖÎãàÎã§.','err');return;}
    const all=getCt();
    const editId=document.getElementById('ctEditId').value;
    const data={
        category:cat,
        company:company,
        name:document.getElementById('ctName').value.trim(),
        phone:phone,
        corpPhone:document.getElementById('ctCorpPhone').value.trim(),
        email:document.getElementById('ctEmail').value.trim(),
        memo:document.getElementById('ctMemo').value.trim()
    };
    if(editId){
        const idx=all.findIndex(x=>x.id===editId);
        if(idx>=0) Object.assign(all[idx],data);
    }else{
        data.id='ct'+Date.now().toString(36)+Math.random().toString(36).substr(2,4);
        all.push(data);
    }
    setCt(all);
    closeCtForm();
    renderContacts();
    toast(editId?'Ïó∞ÎùΩÏ≤ò ÏàòÏ†ï ÏôÑÎ£å':'Ïó∞ÎùΩÏ≤ò Ï∂îÍ∞Ä ÏôÑÎ£å','ok');
}

function delCt(){
    const editId=document.getElementById('ctEditId').value;
    if(!editId||!confirm('Ïù¥ Ïó∞ÎùΩÏ≤òÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?'))return;
    const all=getCt().filter(x=>x.id!==editId);
    setCt(all);
    closeCtForm();
    renderContacts();
    toast('Ïó∞ÎùΩÏ≤ò ÏÇ≠Ï†ú ÏôÑÎ£å','ok');
}
</script>
</body>
</html>